import numpy as np
import matplotlib.pyplot as plt

areas = np.array(
    [
        0.0,
        1.46138646e-5,
        2.92062887e-5,
        4.37784511e-5,
        5.83315159e-5,
        7.28665837e-5,
        8.7384753e-5,
        0.000101887068,
        0.000116374569,
        0.000130848246,
        0.000145309066,
        0.000159758,
        0.000174195899,
        0.000188623759,
        0.000203042364,
        0.000217452631,
        0.000231855331,
        0.000246251322,
        0.000260641362,
        0.000275026192,
        0.000289406598,
        0.000303783338,
        0.00031815705,
        0.000332528463,
        0.000346898247,
        0.000361267099,
        0.00037563566,
        0.000390004541,
        0.000404374383,
        0.000418745767,
        0.000433119305,
        0.000447495579,
        0.000461875083,
        0.000476258458,
        0.000490646285,
        0.000505038945,
        0.00051943725,
        0.000533841376,
        0.000548252079,
        0.000562669651,
        0.00057709479,
        0.000591527845,
        0.000605969399,
        0.000620419742,
        0.000634879572,
        0.000649349065,
        0.000663828861,
        0.000678319368,
        0.000692821,
        0.000707334315,
        0.000721859455,
        0.000736397109,
        0.000750947569,
        0.0007655113,
        0.000780088594,
        0.000794680149,
        0.000809286,
        0.000823906856,
        0.000838542939,
        0.000853194739,
        0.000867862604,
        0.000882546941,
        0.000897248159,
        0.00091196649,
        0.000926702633,
        0.000941456819,
        0.0009562294,
        0.00097102084,
        0.000985831604,
        0.00100066199,
        0.00101551227,
        0.00103038305,
        0.0010452749,
        0.00106018782,
        0.00107512227,
        0.00109007885,
        0.00110505789,
        0.00112005987,
        0.00113508501,
        0.00115013402,
        0.00116520724,
        0.0011803048,
        0.00119542738,
        0.00121057557,
        0.00122574961,
        0.00124095,
        0.00125617709,
        0.00127143157,
        0.00128671364,
        0.001302024,
        0.00131736277,
        0.00133273099,
        0.00134812866,
        0.00136355648,
        0.00137901504,
        0.00139450456,
        0.00141002587,
        0.00142557954,
        0.0014411658,
        0.00145678537,
        0.00147243857,
        0.00148812647,
        0.00150384917,
        0.00151960761,
        0.00153540191,
        0.00155123312,
        0.0015671018,
        0.00158300844,
        0.00159895339,
        0.00161493802,
        0.00163096236,
        0.00164702744,
        0.0016631335,
        0.00167928194,
        0.00169547275,
        0.00171170721,
        0.00172798557,
        0.00174430886,
        0.0017606779,
        0.00177709304,
        0.00179355568,
        0.00181006629,
        0.00182662567,
        0.00184323464,
        0.00185989426,
        0.00187660486,
        0.0018933682,
        0.00191018439,
        0.00192705484,
        0.00194398011,
        0.00196096138,
        0.00197799969,
        0.00199509552,
        0.00201225071,
        0.00202946551,
        0.00204674155,
        0.00206407951,
        0.00208148058,
        0.00209894567,
        0.00211647665,
        0.00213407329,
        0.00215173839,
        0.00216947193,
        0.00218727579,
        0.00220515113,
        0.00222309888,
        0.00224112067,
        0.0022592172,
        0.0022773908,
        0.00229564216,
        0.00231397292,
        0.00233238423,
        0.00235087774,
        0.00236945506,
        0.00238811737,
        0.00240686629,
        0.00242570369,
        0.00244463095,
        0.00246364973,
        0.00248276163,
        0.00250196829,
        0.00252127182,
        0.00254067336,
        0.00256017526,
        0.00257977913,
        0.00259948708,
        0.00261930074,
        0.00263922219,
        0.00265925354,
        0.00267939596,
        0.00269965269,
        0.00272002514,
        0.00274051586,
        0.00276112719,
        0.002781861,
        0.00280271959,
        0.00282370578,
        0.00284482073,
        0.00286606839,
        0.00288745062,
        0.00290896976,
        0.00293062883,
        0.00295243063,
        0.00297437701,
        0.00299647171,
        0.00301871705,
        0.00304111606,
        0.00306367176,
        0.00308638718,
        0.00310926535,
        0.0031323093,
        0.00315552298,
        0.00317890849,
        0.00320247072,
        0.00322621223,
        0.00325013627,
        0.00327424728,
        0.00329854828,
        0.00332304346,
        0.00334773702,
        0.0033726322,
        0.00339773367,
        0.00342304516,
        0.00344857131,
        0.00347431679,
        0.00350028556,
        0.00352648227,
        0.00355291134,
        0.00357957813,
        0.00360648776,
        0.0036336449,
        0.00366105489,
        0.00368872308,
        0.00371665484,
        0.00374485622,
        0.00377333187,
        0.00380208902,
        0.00383113371,
        0.00386047084,
        0.00389010808,
        0.00392005173,
        0.00395030761,
        0.00398088479,
        0.00401178841,
        0.0040430259,
        0.00407460658,
        0.00410653651,
        0.00413882406,
        0.0041714781,
        0.00420450559,
        0.00423791679,
        0.00427172,
        0.00430592475,
        0.00434054,
        0.00437557558,
        0.00441104267,
        0.00444695121,
        0.00448331,
        0.00452013267,
        0.00455742935,
        0.00459521171,
        0.00463349326,
        0.00467228517,
        0.00471160142,
        0.00475145364,
        0.00479185674,
        0.00483282562,
        0.00487437518,
        0.00491652032,
        0.00495927641,
        0.00500265928,
        0.00504668895,
        0.00509137847,
        0.00513675157,
        0.0051828213,
        0.00522961235,
        0.00527714146,
        0.00532543147,
        0.00537450658,
        0.00542438496,
        0.00547509314,
        0.00552665396,
        0.0055790972,
        0.00563244335,
        0.00568672409,
        0.00574196922,
        0.00579820713,
        0.00585547043,
        0.00591378892,
        0.00597320078,
        0.00603374047,
        0.00609544525,
        0.00615835097,
        0.00622250512,
        0.0062879459,
        0.006354718,
        0.00642287126,
        0.00649245409,
        0.00656351773,
        0.00663611386,
        0.00671030255,
        0.00678614574,
        0.00686370581,
        0.00694304705,
        0.00702424115,
        0.00710735889,
        0.00719248503,
        0.0072797006,
        0.00736908847,
        0.00746074459,
        0.00755477371,
        0.00765126897,
        0.00775034819,
        0.00785212312,
        0.00795672741,
        0.00806429,
        0.00817495212,
        0.00828887522,
        0.00840621162,
        0.00852714293,
        0.00865184888,
        0.00878054276,
        0.00891342945,
        0.00905075204,
        0.00919276662,
        0.0093397228,
        0.00949195493,
        0.00964974798,
        0.00981347449,
        0.00998349674,
        0.0101602506,
        0.0103441793,
        0.0105357962,
        0.010735645,
        0.0109443273,
        0.0111625558,
        0.0113910241,
        0.0116305985,
        0.0118822251,
        0.0121469265,
        0.0124259172,
        0.0127205,
        0.0130322482,
        0.0133628659,
        0.0137143685,
        0.0140890917,
        0.0144897308,
        0.0149194878,
        0.01538203,
        0.0158818662,
        0.0164243504,
        0.0170160942,
        0.0176650118,
        0.0183811728,
    ]
)


def model(x):
    # This is a pretty good fit to the curve - it's just a linear term plus a shifted exponential
    # These parameters were just eyeballed in Desmos but it works well. I'm sure they can be refined further
    # (unfortunately this was not DCP compliant with cvxpy)
    a = 0.000015
    b = 13.8
    c = 0.0285
    return np.exp(c * x - b) - np.exp(-b) + a * x


xs = np.arange(len(areas))

plt.plot(xs, areas, label="data")
plt.plot(xs, model(xs), label="model")
plt.ylim(0, 0.02)
plt.legend()
plt.show()
