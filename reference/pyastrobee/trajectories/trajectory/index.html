
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.4">
    
    
      
        <title>Trajectory - pyastrobee</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.80dcb947.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-pyastrobeetrajectoriestrajectory" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="pyastrobee" class="md-header__button md-logo" aria-label="pyastrobee" data-md-component="logo">
      
  <img src="../../../../images/favicon_large.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyastrobee
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Trajectory
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/danielpmorton/pyastrobee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyastrobee
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="pyastrobee" class="md-nav__button md-logo" aria-label="pyastrobee" data-md-component="logo">
      
  <img src="../../../../images/favicon_large.png" alt="logo">

    </a>
    pyastrobee
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/danielpmorton/pyastrobee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyastrobee
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/additional_installs/" class="md-nav__link">
        Additional Installs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/bag_dynamics/" class="md-nav__link">
        Bag Dynamics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/contributing/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/loading_iss_meshes/" class="md-nav__link">
        Loading Iss Meshes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/meshing/" class="md-nav__link">
        Meshing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/nasa_sim/" class="md-nav__link">
        Nasa Sim
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/pybullet_tips/" class="md-nav__link">
        Pybullet Tips
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/retexturing/" class="md-nav__link">
        Retexturing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/tet_meshing/" class="md-nav__link">
        Tet Meshing
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14" type="checkbox" id="__nav_14" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_14">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1" type="checkbox" id="__nav_14_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1">
          Pyastrobee
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pyastrobee" data-md-level="2">
        <label class="md-nav__title" for="__nav_14_1">
          <span class="md-nav__icon md-icon"></span>
          Pyastrobee
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_2" type="checkbox" id="__nav_14_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_2">
          Config
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Config" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_2">
          <span class="md-nav__icon md-icon"></span>
          Config
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_geom/" class="md-nav__link">
        Astrobee Geom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_motion/" class="md-nav__link">
        Astrobee Motion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_transforms/" class="md-nav__link">
        Astrobee Transforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/bag_properties/" class="md-nav__link">
        Bag Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/iss_paths/" class="md-nav__link">
        Iss Paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/iss_safe_boxes/" class="md-nav__link">
        Iss Safe Boxes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_3" type="checkbox" id="__nav_14_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_3">
          Control
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Control" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_3">
          <span class="md-nav__icon md-icon"></span>
          Control
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/attitude_dynamics/" class="md-nav__link">
        Attitude Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/controller/" class="md-nav__link">
        Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/cost_functions/" class="md-nav__link">
        Cost Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/dlqr_test/" class="md-nav__link">
        Dlqr Test
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/force_torque_control/" class="md-nav__link">
        Force Torque Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/keyboard_controller/" class="md-nav__link">
        Keyboard Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/mpc/" class="md-nav__link">
        Mpc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/multi_robot/" class="md-nav__link">
        Multi Robot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/operational_space_control/" class="md-nav__link">
        Operational Space Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/parallel_mpc/" class="md-nav__link">
        Parallel Mpc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/physics_models/" class="md-nav__link">
        Physics Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/pid/" class="md-nav__link">
        Pid
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_4" type="checkbox" id="__nav_14_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_4">
          Core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_4">
          <span class="md-nav__icon md-icon"></span>
          Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/abstract_bag/" class="md-nav__link">
        Abstract Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/astrobee/" class="md-nav__link">
        Astrobee
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/composite_bag/" class="md-nav__link">
        Composite Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/constraint_bag/" class="md-nav__link">
        Constraint Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/deformable_bag/" class="md-nav__link">
        Deformable Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/environments/" class="md-nav__link">
        Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/hybrid_bag/" class="md-nav__link">
        Hybrid Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/iss/" class="md-nav__link">
        Iss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/rigid_bag/" class="md-nav__link">
        Rigid Bag
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_5" type="checkbox" id="__nav_14_1_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_5">
          Trajectories
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Trajectories" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_5">
          <span class="md-nav__icon md-icon"></span>
          Trajectories
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arm_planner/" class="md-nav__link">
        Arm Planner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bezier/" class="md-nav__link">
        Bezier
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bezier_slerp/" class="md-nav__link">
        Bezier Slerp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../box_paths/" class="md-nav__link">
        Box Paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../curve_utils/" class="md-nav__link">
        Curve Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../decasteljau_slerp/" class="md-nav__link">
        Decasteljau Slerp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_forward/" class="md-nav__link">
        Face Forward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_robot_trajs/" class="md-nav__link">
        Multi Robot Trajs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../planner/" class="md-nav__link">
        Planner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../polynomials/" class="md-nav__link">
        Polynomials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quaternion_interpolation/" class="md-nav__link">
        Quaternion Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sampling/" class="md-nav__link">
        Sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simple_trajectories/" class="md-nav__link">
        Simple Trajectories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../splines/" class="md-nav__link">
        Splines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timing/" class="md-nav__link">
        Timing
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Trajectory
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Trajectory
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compare_trajs" class="md-nav__link">
    compare_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate_arm_trajs" class="md-nav__link">
    concatenate_arm_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate_trajs" class="md-nav__link">
    concatenate_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrapolate_arm_traj" class="md-nav__link">
    extrapolate_arm_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrapolate_traj" class="md-nav__link">
    extrapolate_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge_trajs" class="md-nav__link">
    merge_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_traj" class="md-nav__link">
    plot_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_traj_constraints" class="md-nav__link">
    plot_traj_constraints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping_criteria" class="md-nav__link">
    stopping_criteria
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize_traj" class="md-nav__link">
    visualize_traj
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#armtrajectory" class="md-nav__link">
    ArmTrajectory
  </a>
  
    <nav class="md-nav" aria-label="ArmTrajectory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_from_times" class="md-nav__link">
    get_segment_from_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot" class="md-nav__link">
    plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectory" class="md-nav__link">
    Trajectory
  </a>
  
    <nav class="md-nav" aria-label="Trajectory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_1" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_1" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_between_times" class="md-nav__link">
    get_segment_between_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_1" class="md-nav__link">
    plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    visualize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectorylogger" class="md-nav__link">
    TrajectoryLogger
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryLogger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear_log" class="md-nav__link">
    clear_log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_2" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_between_times_1" class="md-nav__link">
    get_segment_between_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_state" class="md-nav__link">
    log_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_2" class="md-nav__link">
    plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize_1" class="md-nav__link">
    visualize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../variable_time_curves/" class="md-nav__link">
        Variable Time Curves
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_6" type="checkbox" id="__nav_14_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_6">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utils" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_6">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/algos/" class="md-nav__link">
        Algos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bag_frame/" class="md-nav__link">
        Bag Frame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/boxes/" class="md-nav__link">
        Boxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bullet_utils/" class="md-nav__link">
        Bullet Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/camera_utils/" class="md-nav__link">
        Camera Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/coordinates/" class="md-nav__link">
        Coordinates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/debug_visualizer/" class="md-nav__link">
        Debug Visualizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/dynamics/" class="md-nav__link">
        Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/errors/" class="md-nav__link">
        Errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math_utils/" class="md-nav__link">
        Math Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/mesh_utils/" class="md-nav__link">
        Mesh Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/plotting/" class="md-nav__link">
        Plotting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/poses/" class="md-nav__link">
        Poses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/process_camera/" class="md-nav__link">
        Process Camera
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/python_utils/" class="md-nav__link">
        Python Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/quaternion_class/" class="md-nav__link">
        Quaternion Class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/quaternion_derivatives/" class="md-nav__link">
        Quaternion Derivatives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/quaternions/" class="md-nav__link">
        Quaternions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/rotations/" class="md-nav__link">
        Rotations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/transformations/" class="md-nav__link">
        Transformations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/video_concatenation/" class="md-nav__link">
        Video Concatenation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_14_1_7" type="checkbox" id="__nav_14_1_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_14_1_7">
          Vision
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Vision" data-md-level="3">
        <label class="md-nav__title" for="__nav_14_1_7">
          <span class="md-nav__icon md-icon"></span>
          Vision
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vision/camera/" class="md-nav__link">
        Camera
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../vision/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compare_trajs" class="md-nav__link">
    compare_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate_arm_trajs" class="md-nav__link">
    concatenate_arm_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concatenate_trajs" class="md-nav__link">
    concatenate_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrapolate_arm_traj" class="md-nav__link">
    extrapolate_arm_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extrapolate_traj" class="md-nav__link">
    extrapolate_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#merge_trajs" class="md-nav__link">
    merge_trajs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_traj" class="md-nav__link">
    plot_traj
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_traj_constraints" class="md-nav__link">
    plot_traj_constraints
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stopping_criteria" class="md-nav__link">
    stopping_criteria
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize_traj" class="md-nav__link">
    visualize_traj
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#armtrajectory" class="md-nav__link">
    ArmTrajectory
  </a>
  
    <nav class="md-nav" aria-label="ArmTrajectory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_from_times" class="md-nav__link">
    get_segment_from_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot" class="md-nav__link">
    plot
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectory" class="md-nav__link">
    Trajectory
  </a>
  
    <nav class="md-nav" aria-label="Trajectory">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes_1" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#descendants" class="md-nav__link">
    Descendants
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_1" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_1" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_between_times" class="md-nav__link">
    get_segment_between_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_1" class="md-nav__link">
    plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize" class="md-nav__link">
    visualize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trajectorylogger" class="md-nav__link">
    TrajectoryLogger
  </a>
  
    <nav class="md-nav" aria-label="TrajectoryLogger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors-in-mro" class="md-nav__link">
    Ancestors (in MRO)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables_1" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methods_2" class="md-nav__link">
    Methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clear_log" class="md-nav__link">
    clear_log
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_2" class="md-nav__link">
    get_segment
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get_segment_between_times_1" class="md-nav__link">
    get_segment_between_times
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#log_state" class="md-nav__link">
    log_state
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#plot_2" class="md-nav__link">
    plot
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visualize_1" class="md-nav__link">
    visualize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/danielpmorton/pyastrobee/edit/main/reference/pyastrobee/trajectories/trajectory.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="module-pyastrobeetrajectoriestrajectory">Module pyastrobee.trajectories.trajectory</h1>
<p>Trajectory class for Astrobee control, and trajectory-associated helpers</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="sd">&quot;&quot;&quot;Trajectory class for Astrobee control, and trajectory-associated helpers&quot;&quot;&quot;</span>

<span class="c1"># TODO decide if trajectory attributes should be read-only? (properties)</span>

<span class="c1"># TODO make a subclass of Trajectory with the log() method</span>

<span class="c1"># TODO make it clearer what happens if some of the traj components are None</span>

<span class="c1">#      (Numerically calculate the gradient? Remove the option to set these as None?)</span>

<span class="c1"># TODO add max vel/accel lines into the plots?</span>

<span class="c1"># TODO remove the ability to not give time information... this makes no sense.</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">pybullet</span>

<span class="kn">from</span> <span class="nn">pybullet_utils.bullet_client</span> <span class="kn">import</span> <span class="n">BulletClient</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">numpy.typing</span> <span class="k">as</span> <span class="nn">npt</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>

<span class="kn">from</span> <span class="nn">pyastrobee.utils.poses</span> <span class="kn">import</span> <span class="n">batched_pos_quats_to_tmats</span>

<span class="kn">from</span> <span class="nn">pyastrobee.utils.debug_visualizer</span> <span class="kn">import</span> <span class="n">visualize_frame</span><span class="p">,</span> <span class="n">visualize_path</span>

<span class="kn">from</span> <span class="nn">pyastrobee.utils.quaternions</span> <span class="kn">import</span> <span class="n">quaternion_dist</span><span class="p">,</span> <span class="n">quats_to_angular_velocities</span>

<span class="kn">from</span> <span class="nn">pyastrobee.utils.boxes</span> <span class="kn">import</span> <span class="n">Box</span>

<span class="kn">from</span> <span class="nn">pyastrobee.utils.plotting</span> <span class="kn">import</span> <span class="n">num_subplots_to_shape</span>

<span class="k">class</span> <span class="nc">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trajectory class: Keeps track of a sequence of poses/velocities/accels over a period of time</span>

<span class="sd">    - All arguments can be omitted as needed (for instance, a pose-only trajectory without velocities,</span>

<span class="sd">        or a trajectory without time information)</span>

<span class="sd">    - All positions/orientations/velocities... are assumed to be defined in world frame</span>

<span class="sd">    Args:</span>

<span class="sd">        positions (Optional[npt.ArrayLike]): Sequence of XYZ positions, shape (n, 3)</span>

<span class="sd">        quats (Optional[npt.ArrayLike]): Sequence of XYZW quaternions, shape (n, 4)</span>

<span class="sd">        lin_vels (Optional[npt.ArrayLike]): Sequence of (vx, vy, vz) linear velocities, shape (n, 3)</span>

<span class="sd">        ang_vels (Optional[npt.ArrayLike]): Sequence of (wx, wy, wz) angular velocities, shape (n, 3)</span>

<span class="sd">        lin_accels (Optional[npt.ArrayLike]): Sequence of (ax, ay, az) linear accelerations, shape (n, 3)</span>

<span class="sd">        ang_accels (Optional[npt.ArrayLike]): Sequence of (al_x, al_y, al_z) angular accelerations, shape (n, 3)</span>

<span class="sd">        times (Optional[npt.ArrayLike]): Times corresponding to each trajectory entry, shape (n)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span>

        <span class="n">positions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">quats</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">lin_vels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">ang_vels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">lin_accels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">ang_accels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">times</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_positions</span> <span class="o">=</span> <span class="n">positions</span> <span class="k">if</span> <span class="n">positions</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_quats</span> <span class="o">=</span> <span class="n">quats</span> <span class="k">if</span> <span class="n">quats</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lin_vels</span> <span class="o">=</span> <span class="n">lin_vels</span> <span class="k">if</span> <span class="n">lin_vels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ang_vels</span> <span class="o">=</span> <span class="n">ang_vels</span> <span class="k">if</span> <span class="n">ang_vels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lin_accels</span> <span class="o">=</span> <span class="n">lin_accels</span> <span class="k">if</span> <span class="n">lin_accels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ang_accels</span> <span class="o">=</span> <span class="n">ang_accels</span> <span class="k">if</span> <span class="n">ang_accels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="n">times</span> <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_poses</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Init</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tmats</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Init</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_num_timesteps</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Init</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">positions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_positions</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">quaternions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_quats</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">linear_velocities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lin_vels</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">angular_velocities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ang_vels</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">linear_accels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lin_accels</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">angular_accels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ang_accels</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">)</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">timestep</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">num_timesteps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_timesteps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_num_timesteps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_num_timesteps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># If there is no position or orientation info, trajectory is empty (None)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_num_timesteps</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">poses</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pose array (position + xyzw quaternion), shape (n, 7)&quot;&quot;&quot;</span>

        <span class="c1"># if self._poses is not None:</span>

        <span class="c1">#     return self._poses  # Only calculate this once</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No position information available&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No orientation information available&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_poses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">column_stack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="p">])</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_poses</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">tmats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Poses expressed as transformation matrices, shape (n, 4, 4)&quot;&quot;&quot;</span>

        <span class="c1"># if self._tmats is not None:</span>

        <span class="c1">#     return self._tmats  # Only calculate this once</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tmats</span> <span class="o">=</span> <span class="n">batched_pos_quats_to_tmats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">poses</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tmats</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">contains_pos_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the trajectory contains only position info&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">contains_orn_only</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the trajectory contains only orientation info&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">contains_pos_and_orn</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the trajectory contains both position and orientation info&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="nd">@property</span>

    <span class="k">def</span> <span class="nf">is_empty</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Whether the trajectory contains no position/orientation info&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">==</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span>

        <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="kp">size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>

        <span class="n">client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BulletClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;View the trajectory in Pybullet</span>

<span class="sd">        Args:</span>

<span class="sd">            n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="sd">                Defaults to None (plot all frames)</span>

<span class="sd">            size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="sd">                with respect to the dimensions of the Astrobee)</span>

<span class="sd">            client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="sd">                (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="sd">        Returns:</span>

<span class="sd">            list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">client</span><span class="p">:</span> <span class="n">pybullet</span> <span class="o">=</span> <span class="n">pybullet</span> <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">client</span>

        <span class="n">connection_status</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">isConnected</span><span class="p">()</span>

        <span class="c1"># Bring up the Pybullet GUI if needed</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">connection_status</span><span class="p">:</span>

            <span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">pybullet</span><span class="o">.</span><span class="n">GUI</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_pos_and_orn</span><span class="p">:</span>

            <span class="n">ids</span> <span class="o">=</span> <span class="n">visualize_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="kp">size</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_pos_only</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trajectory only contains position info. Showing path instead&quot;</span><span class="p">)</span>

            <span class="n">ids</span> <span class="o">=</span> <span class="n">visualize_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_orn_only</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>

                <span class="s2">&quot;Visualizing a sequence of purely orientations is not implemented yet&quot;</span>

            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Empty trajectory</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No trajectory information to visualize&quot;</span><span class="p">)</span>

        <span class="c1"># Disconnect Pybullet if we originally weren&#39;t connected</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">connection_status</span><span class="p">:</span>

            <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Press Enter to disconnect Pybullet&quot;</span><span class="p">)</span>

            <span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">ids</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="sd">        Args:</span>

<span class="sd">            show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="sd">        Returns:</span>

<span class="sd">            Figure: Matplotlib figure containing the plots</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">plot_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Trajectory&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct a trajectory segment from a larger trajectory</span>

<span class="sd">        Args:</span>

<span class="sd">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="sd">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="sd">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="sd">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="sd">        Returns:</span>

<span class="sd">            Trajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: add check for invalid slicing indices? Or just leave it up to numpy</span>

        <span class="c1"># Time needs to get handled differently because the trajectory may or may not have time info</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># No time info</span>

            <span class="n">new_times</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">new_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">reset_time</span><span class="p">:</span>

                <span class="n">new_times</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">Trajectory</span><span class="p">(</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">quaternions</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">],</span>

            <span class="n">new_times</span><span class="p">,</span>

        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_segment_between_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

        <span class="c1"># start_index = np.searchsorted(self.times, start_time)</span>

        <span class="c1"># end_index = np.searchsorted(self.times, end_time)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;TODO&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">TrajectoryLogger</span><span class="p">(</span><span class="n">Trajectory</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for maintaining a history of a robot&#39;s state over time&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Create an empty Trajectory which we will iteratively append to</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log_state</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span>

        <span class="n">pos</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

        <span class="n">quat</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

        <span class="n">lin_vel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">ang_vel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">dt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="p">):</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Record the robot state at a given timestep</span>

<span class="sd">        If velocity information is not available (for instance, with a softbody),</span>

<span class="sd">        we can log just the position + orientation information</span>

<span class="sd">        Args:</span>

<span class="sd">            pos (npt.ArrayLike): Current position, shape (3,)</span>

<span class="sd">            quat (npt.ArrayLike): Current orientation (XYZW quaternion), shape (4,)</span>

<span class="sd">            lin_vel (Optional[npt.ArrayLike]): Current linear velocity, shape (3,). Defaults to None.</span>

<span class="sd">            ang_vel (Optional[npt.ArrayLike]): Current angular velocity, shape (3,). Defaults to None.</span>

<span class="sd">            dt (Optional[float]): Time elapsed since the previous step. Defaults to None.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO refine this functionality</span>

        <span class="c1"># Can log position/orientation info without velocity if needed</span>

        <span class="c1"># These values can be None because matplotlib will just not plot them</span>

        <span class="c1"># Most importantly, we want to make sure that things correspond in time</span>

        <span class="c1"># (There shouldn&#39;t be an instance where we have histories of different lengths)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_positions</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_quats</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lin_vels</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">lin_vel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ang_vels</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">ang_vel</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">clear_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Clears the log of all trajectory data&quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_positions</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_quats</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_lin_vels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_ang_vels</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_times</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># TODO improve this... make it match up with the normal class</span>

<span class="c1"># TODO velocity/force control?</span>

<span class="c1"># TODO use a dictionary for the angles instead? map joint indices =&gt; their angles over time</span>

<span class="c1"># TODO should we always define the trajectory for all of the joints?</span>

<span class="k">class</span> <span class="nc">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Maintains information on the positions of the arm&#39;s joint angles over time</span>

<span class="sd">    Currently this assumes we are working with position control</span>

<span class="sd">    Args:</span>

<span class="sd">        angles (np.ndarray): Joint angles over time, shape (n_timesteps, n_controlled_joints)</span>

<span class="sd">        joint_ids (npt.ArrayLike): Indices of the joints being controlled with position control. Unspecified joints</span>

<span class="sd">            will be left at their default control value (Either manually set or defined at robot initialization)</span>

<span class="sd">        times (Optional[npt.ArrayLike]): Time information for the trajectory, shape (n_timesteps). Defaults to None.</span>

<span class="sd">        key_times (Optional[dict[str, float]]): Information about when key transitions occur in the trajectory,</span>

<span class="sd">            for instance, when we start/stop an arm deployment motion. Defaults to None.</span>

<span class="sd">    Raises:</span>

<span class="sd">        ValueError: If the shape of the angles input does not match the expected number of joints being controlled,</span>

<span class="sd">            or the number of timesteps in the time input</span>

<span class="sd">        KeyError: If the key_times dictionary contains unexpected keys. Currently supported: &quot;begin_drag_motion&quot;,</span>

<span class="sd">            &quot;end_drag_motion&quot;, &quot;begin_grasp_motion&quot;, &quot;end_grasp_motion&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span>

        <span class="n">angles</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>

        <span class="n">joint_ids</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

        <span class="n">times</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

        <span class="n">key_times</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="p">):</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">ndim</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="kp">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">joint_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_1d</span><span class="p">(</span><span class="n">joint_ids</span><span class="p">)</span>

        <span class="n">n_steps</span><span class="p">,</span> <span class="n">n_joints</span> <span class="o">=</span> <span class="n">angles</span><span class="o">.</span><span class="kp">shape</span>

        <span class="k">if</span> <span class="n">n_joints</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">joint_ids</span><span class="p">):</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="s2">&quot;Mismatched inputs: The second dimension of the angles must match the number of joints.</span><span class="se">\n</span><span class="s2">&quot;</span>

                <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;Got shape: </span><span class="si">{</span><span class="n">angles</span><span class="o">.</span><span class="kp">shape</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">joint_ids</span><span class="p">)</span><span class="si">}</span><span class="s2"> joint indices: </span><span class="si">{</span><span class="n">joint_ids</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="p">)</span>

        <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span> <span class="o">!=</span> <span class="n">n_steps</span><span class="p">:</span>

            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

                <span class="s2">&quot;Mismatched input dimensions: Time info is not the same length as the angles&quot;</span>

            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">angles</span> <span class="o">=</span> <span class="n">angles</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span> <span class="o">=</span> <span class="n">joint_ids</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">=</span> <span class="n">times</span> <span class="k">if</span> <span class="n">times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span> <span class="o">=</span> <span class="n">n_steps</span>

        <span class="c1"># Hacky way to store information on the times/indices when the arm moves back or forward</span>

        <span class="c1"># This somewhat assumes that we&#39;re going to move the arm to &quot;drag&quot; and then back to &quot;grasp&quot;</span>

        <span class="c1"># TODO make this more general</span>

        <span class="c1"># TODO improve how we handle the keys that we&#39;d expect to see</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">key_times</span> <span class="o">=</span> <span class="n">key_times</span>

        <span class="n">expected_keys</span> <span class="o">=</span> <span class="p">{</span>

            <span class="s2">&quot;begin_drag_motion&quot;</span><span class="p">,</span>

            <span class="s2">&quot;end_drag_motion&quot;</span><span class="p">,</span>

            <span class="s2">&quot;begin_grasp_motion&quot;</span><span class="p">,</span>

            <span class="s2">&quot;end_grasp_motion&quot;</span><span class="p">,</span>

        <span class="p">}</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_times</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>

            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">expected_keys</span><span class="p">:</span>

                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Unexpected key time name: &quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">x_axis</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

            <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Timesteps&quot;</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">x_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span>

            <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time, s&quot;</span>

        <span class="n">n_subplots</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">)</span>

        <span class="n">subplot_shape</span> <span class="o">=</span> <span class="n">num_subplots_to_shape</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)</span>

        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">):</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="o">*</span><span class="n">subplot_shape</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Joint </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Angle&quot;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># TODO!! USE NEW CONCATENATE AND EXTRAPOLATE METHODS</span>

    <span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span> <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ArmTrajectory&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="sd">        Args:</span>

<span class="sd">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="sd">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="sd">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="sd">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="sd">        Returns:</span>

<span class="sd">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: add check for invalid slicing indices? Or just leave it up to numpy</span>

        <span class="c1"># HACK HACK HACK !!!!!!!!!!!!!!!!!!!!!!</span>

        <span class="n">n_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>

        <span class="c1"># print(f&quot;GETTING ARM SEGMENT: Start: {start_index}, End: {end_index}&quot;)</span>

        <span class="k">if</span> <span class="n">start_index</span> <span class="o">&lt;</span> <span class="n">n_steps</span> <span class="ow">and</span> <span class="n">end_index</span> <span class="o">&lt;</span> <span class="n">n_steps</span><span class="p">:</span>

            <span class="c1"># NORMAL</span>

            <span class="c1"># Time needs to get handled differently because the trajectory may or may not have time info</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># No time info</span>

                <span class="n">new_times</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">else</span><span class="p">:</span>

                <span class="n">new_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">]</span>

            <span class="n">new_key_times</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">new_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>

            <span class="k">if</span> <span class="n">reset_time</span> <span class="ow">and</span> <span class="n">new_times</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

                <span class="n">new_times</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">new_key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">ArmTrajectory</span><span class="p">(</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="n">start_index</span><span class="p">:</span><span class="n">end_index</span><span class="p">,</span> <span class="p">:],</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">,</span>

                <span class="n">new_times</span><span class="p">,</span>

                <span class="n">new_key_times</span><span class="p">,</span>

            <span class="p">)</span>

        <span class="k">elif</span> <span class="n">start_index</span> <span class="o">&lt;</span> <span class="n">n_steps</span> <span class="ow">and</span> <span class="n">end_index</span> <span class="o">&gt;=</span> <span class="n">n_steps</span><span class="p">:</span>

            <span class="n">angles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">(</span>

                <span class="p">[</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="n">start_index</span><span class="p">:,</span> <span class="p">:],</span>

                    <span class="n">np</span><span class="o">.</span><span class="kp">ones</span><span class="p">((</span><span class="n">end_index</span> <span class="o">-</span> <span class="n">n_steps</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">)))</span>

                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>

                <span class="p">]</span>

            <span class="p">)</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">new_times</span> <span class="o">=</span> <span class="p">(</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">start_index</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

            <span class="p">)</span>

            <span class="n">new_key_times</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">new_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>

            <span class="k">if</span> <span class="n">reset_time</span><span class="p">:</span>

                <span class="n">new_times</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">new_key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">,</span> <span class="n">new_times</span><span class="p">,</span> <span class="n">new_key_times</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Both over the limit</span>

            <span class="n">angles</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones</span><span class="p">(</span>

                <span class="p">(</span><span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">))</span>

            <span class="p">)</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">new_times</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="n">end_index</span> <span class="o">-</span> <span class="n">start_index</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

            <span class="n">new_key_times</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                <span class="k">if</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">time</span> <span class="o">&lt;=</span> <span class="n">new_times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span>

            <span class="k">if</span> <span class="n">reset_time</span><span class="p">:</span>

                <span class="n">new_times</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">new_key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

                    <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">-=</span> <span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">,</span> <span class="n">new_times</span><span class="p">,</span> <span class="n">new_key_times</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_segment_from_times</span><span class="p">(</span>

        <span class="bp">self</span><span class="p">,</span> <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ArmTrajectory&quot;</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="sd">        Args:</span>

<span class="sd">            start_time (float): Starting time of the segment</span>

<span class="sd">            end_time (float): Ending time of the segment</span>

<span class="sd">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="sd">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="sd">        Returns:</span>

<span class="sd">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">start_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">searchsorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">start_time</span><span class="p">)</span>

        <span class="n">end_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">searchsorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">end_index</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>  <span class="c1"># Past the max time... somewhat of a HACK</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

            <span class="n">time_after</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">end_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">round</span><span class="p">(</span><span class="n">time_after</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_segment</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span> <span class="n">end_index</span><span class="p">,</span> <span class="n">reset_time</span><span class="p">)</span>

<span class="c1"># TODO see if we can incorporate a sequence of Boxes for the position constraints</span>

<span class="c1"># on a spline trajectory (rather than just a single Box constraint for a single curve)</span>

<span class="k">def</span> <span class="nf">plot_traj_constraints</span><span class="p">(</span>

    <span class="n">traj</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span>

    <span class="n">pos_lims</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Box</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">max_vel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">max_accel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">max_omega</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">max_alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot trajectory info to visualize how it satisfies constraints</span>

<span class="sd">    Args:</span>

<span class="sd">        traj (Trajectory): Trajectory to plot</span>

<span class="sd">        pos_lims (Optional[Union[Box, npt.ArrayLike]]): Lower and upper limits on the XYZ position. Defaults to None.</span>

<span class="sd">        max_vel (Optional[float]): Maximum velocity magnitude. Defaults to None.</span>

<span class="sd">        max_accel (Optional[float]): Maximum acceleration magnitude. Defaults to None.</span>

<span class="sd">        max_omega (Optional[float]): Maximum angular velocity magnitude. Defaults to None.</span>

<span class="sd">        max_alpha (Optional[float]): Maximum angular acceleration magnitude. Defaults to None.</span>

<span class="sd">        show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="sd">    Returns:</span>

<span class="sd">        Figure: The plot</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">x_axis</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Timesteps&quot;</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">x_axis</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time, s&quot;</span>

    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;k-&quot;</span>

    <span class="n">lim_fmt</span> <span class="o">=</span> <span class="s2">&quot;r--&quot;</span>

    <span class="c1"># Top row is position info, bottom row is orientation info</span>

    <span class="c1"># Columns give derivative info</span>

    <span class="n">subfigs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Position</span>

    <span class="n">top_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top_left</span><span class="p">):</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="n">fmt</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">([</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pos_lims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">lower_pos_lim</span><span class="p">,</span> <span class="n">upper_pos_lim</span> <span class="o">=</span> <span class="n">pos_lims</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">top_left</span><span class="p">):</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">lower_pos_lim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">upper_pos_lim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

    <span class="c1"># Linear velocity</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">top_middle</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">top_middle</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">fmt</span><span class="p">)</span>

        <span class="n">top_middle</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;||vel||&quot;</span><span class="p">)</span>

        <span class="n">top_middle</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_vel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">top_middle</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">max_vel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

    <span class="c1"># Linear acceleration</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">linear_accels</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">top_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">top_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">fmt</span><span class="p">)</span>

        <span class="n">top_right</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;||accel||&quot;</span><span class="p">)</span>

        <span class="n">top_right</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_accel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">top_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">max_accel</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

    <span class="c1"># Quaternions</span>

    <span class="c1"># These are unconstrained so it&#39;s the same plotting method as in the standard plot traj function</span>

    <span class="n">bot_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">quaternions</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">_plot</span><span class="p">(</span>

            <span class="n">bot_left</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;qx&quot;</span><span class="p">,</span> <span class="s2">&quot;qy&quot;</span><span class="p">,</span> <span class="s2">&quot;qz&quot;</span><span class="p">,</span> <span class="s2">&quot;qw&quot;</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span>

        <span class="p">)</span>

    <span class="c1"># Angular velocity</span>

    <span class="n">bot_middle</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">bot_middle</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">fmt</span><span class="p">)</span>

        <span class="n">bot_middle</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;||omega||&quot;</span><span class="p">)</span>

        <span class="n">bot_middle</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_omega</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">bot_middle</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">max_omega</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

    <span class="c1"># Angular acceleration</span>

    <span class="n">bot_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">angular_accels</span><span class="o">.</span><span class="kp">size</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">bot_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">fmt</span><span class="p">)</span>

        <span class="n">bot_right</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;||alpha||&quot;</span><span class="p">)</span>

        <span class="n">bot_right</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">max_alpha</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

            <span class="n">bot_right</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">max_alpha</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span> <span class="n">lim_fmt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">plot_traj</span><span class="p">(</span><span class="n">traj</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;k-&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="sd">    Args:</span>

<span class="sd">        traj (Trajectory): The Trajectory object to plot</span>

<span class="sd">        show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="sd">        fmt (str, optional): Matplotlib line specification. Defaults to &quot;k-&quot;</span>

<span class="sd">    Returns:</span>

<span class="sd">        Figure: Matplotlib figure containing the plots</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Indexing helper variables</span>

    <span class="n">POS</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">ORN</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">LIN_VEL</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">ANG_VEL</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">LIN_ACCEL</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">ANG_ACCEL</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>

        <span class="n">POS</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>

        <span class="n">ORN</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;qx&quot;</span><span class="p">,</span> <span class="s2">&quot;qy&quot;</span><span class="p">,</span> <span class="s2">&quot;qz&quot;</span><span class="p">,</span> <span class="s2">&quot;qw&quot;</span><span class="p">],</span>

        <span class="n">LIN_VEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vx&quot;</span><span class="p">,</span> <span class="s2">&quot;vy&quot;</span><span class="p">,</span> <span class="s2">&quot;vz&quot;</span><span class="p">],</span>

        <span class="n">ANG_VEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;wx&quot;</span><span class="p">,</span> <span class="s2">&quot;wy&quot;</span><span class="p">,</span> <span class="s2">&quot;wz&quot;</span><span class="p">],</span>

        <span class="n">LIN_ACCEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="s2">&quot;ay&quot;</span><span class="p">,</span> <span class="s2">&quot;az&quot;</span><span class="p">],</span>

        <span class="n">ANG_ACCEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;al_x&quot;</span><span class="p">,</span> <span class="s2">&quot;al_y&quot;</span><span class="p">,</span> <span class="s2">&quot;al_z&quot;</span><span class="p">],</span>

    <span class="p">}</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">x_axis</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Timesteps&quot;</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">x_axis</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time, s&quot;</span>

    <span class="c1"># Top row is position info, bottom row is orientation info</span>

    <span class="c1"># Columns give derivative info</span>

    <span class="n">subfigs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">top_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">POS</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="n">top_middle</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_VEL</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="n">top_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_ACCEL</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="n">bot_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ORN</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="n">bot_middle</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_middle</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_VEL</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="n">bot_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_ACCEL</span><span class="p">],</span> <span class="n">x_axis</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">_plot</span><span class="p">(</span>

    <span class="n">axes</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">],</span>

    <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>

    <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>

    <span class="n">x_axis</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>

    <span class="n">x_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>

    <span class="o">*</span><span class="n">args</span><span class="p">,</span>

    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>

<span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Helper function for plotting trajectory components</span>

<span class="sd">    Args:</span>

<span class="sd">        axes (np.ndarray[plt.Axes]): Matplotlib axes for subplots within a subfigure, length = n</span>

<span class="sd">        data (np.ndarray): Trajectory information to plot, shape (m, n) where m is the number of timesteps</span>

<span class="sd">            and n refers to the number of components of that trajectory info (for instance, position has</span>

<span class="sd">            data for x, y, and z, so n = 3)</span>

<span class="sd">        labels (list[str]): Labels for each of the components of the trajectory data, length = n</span>

<span class="sd">        x_axis (np.ndarray): X-axis data to plot the trajectory against, length = m</span>

<span class="sd">        x_label (str): Label for the x-axis (for instance, &quot;Time&quot; or &quot;Steps&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># If the trajectory doesn&#39;t contain the info, don&#39;t plot it</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">return</span>

    <span class="c1"># Number of components to plot (for instance, position: n = 3: x, y, z)</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">n</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

    <span class="c1"># Plot each component of the trajectory information on a separate axis</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="c1"># TODO all of the plotting logic here is extremely similar to the single-plot method</span>

<span class="c1"># Figure out a way to simplify the code</span>

<span class="k">def</span> <span class="nf">compare_trajs</span><span class="p">(</span>

    <span class="n">traj_1</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span>

    <span class="n">traj_2</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span>

    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>

    <span class="n">fmt_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;k-&quot;</span><span class="p">,</span>

    <span class="n">fmt_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;b-&quot;</span><span class="p">,</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compares two trajectories by plotting them on the same axes</span>

<span class="sd">    Args:</span>

<span class="sd">        traj_1 (Trajectory): First trajectory to plot</span>

<span class="sd">        traj_2 (Trajectory): Second trajectory to plot</span>

<span class="sd">        show (bool, optional): . Defaults to True.</span>

<span class="sd">        fmt_1 (str, optional): Matplotlib line specification for the first traj. Defaults to &quot;k-&quot;.</span>

<span class="sd">        fmt_2 (str, optional): Matplotlib line specification for the second traj. Defaults to &quot;b-&quot;.</span>

<span class="sd">    Returns:</span>

<span class="sd">        Figure: Matplotlib figure containing the plots</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Indexing helper variables</span>

    <span class="n">POS</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">ORN</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">LIN_VEL</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">ANG_VEL</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">LIN_ACCEL</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">ANG_ACCEL</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>

        <span class="n">POS</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">],</span>

        <span class="n">ORN</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;qx&quot;</span><span class="p">,</span> <span class="s2">&quot;qy&quot;</span><span class="p">,</span> <span class="s2">&quot;qz&quot;</span><span class="p">,</span> <span class="s2">&quot;qw&quot;</span><span class="p">],</span>

        <span class="n">LIN_VEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;vx&quot;</span><span class="p">,</span> <span class="s2">&quot;vy&quot;</span><span class="p">,</span> <span class="s2">&quot;vz&quot;</span><span class="p">],</span>

        <span class="n">ANG_VEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;wx&quot;</span><span class="p">,</span> <span class="s2">&quot;wy&quot;</span><span class="p">,</span> <span class="s2">&quot;wz&quot;</span><span class="p">],</span>

        <span class="n">LIN_ACCEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="s2">&quot;ay&quot;</span><span class="p">,</span> <span class="s2">&quot;az&quot;</span><span class="p">],</span>

        <span class="n">ANG_ACCEL</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;al_x&quot;</span><span class="p">,</span> <span class="s2">&quot;al_y&quot;</span><span class="p">,</span> <span class="s2">&quot;al_z&quot;</span><span class="p">],</span>

    <span class="p">}</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="c1"># TODO this check is kinda weird right now</span>

    <span class="c1"># what happens if one has time info and the other doesn&#39;t??</span>

    <span class="k">if</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">x_axis_1</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj_1</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Timesteps&quot;</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">x_axis_1</span> <span class="o">=</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span>

        <span class="n">x_label</span> <span class="o">=</span> <span class="s2">&quot;Time, s&quot;</span>

    <span class="k">if</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">x_axis_2</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">x_axis_2</span> <span class="o">=</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span>

    <span class="c1"># Top row is position info, bottom row is orientation info</span>

    <span class="c1"># Columns give derivative info</span>

    <span class="c1"># fmt: off</span>

    <span class="n">subfigs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">top_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">POS</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">POS</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="n">top_middle</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_VEL</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_VEL</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="n">top_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_ACCEL</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">LIN_ACCEL</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="n">bot_left</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ORN</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ORN</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="n">bot_mid</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_mid</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_VEL</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_mid</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_VEL</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="n">bot_right</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_ACCEL</span><span class="p">],</span> <span class="n">x_axis_1</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_1</span><span class="p">)</span>

    <span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">labels</span><span class="p">[</span><span class="n">ANG_ACCEL</span><span class="p">],</span> <span class="n">x_axis_2</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">fmt_2</span><span class="p">)</span>

    <span class="c1"># fmt: on</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">visualize_traj</span><span class="p">(</span>

    <span class="n">traj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Trajectory</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>

    <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

    <span class="kp">size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>

    <span class="n">client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BulletClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Visualizes a trajectory&#39;s sequence of poses on the Pybullet GUI</span>

<span class="sd">    Args:</span>

<span class="sd">        traj (Union[Trajectory, npt.ArrayLike]): Trajectory to visualize (must contain at least</span>

<span class="sd">            position + orientation info), or an array of position + quaternion poses, shape (n, 7)</span>

<span class="sd">        n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="sd">            Defaults to None (plot all frames)</span>

<span class="sd">        size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="sd">            with respect to the dimensions of the Astrobee)</span>

<span class="sd">        client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="sd">            (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="sd">    Returns:</span>

<span class="sd">        list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">client</span><span class="p">:</span> <span class="n">pybullet</span> <span class="o">=</span> <span class="n">pybullet</span> <span class="k">if</span> <span class="n">client</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">client</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span> <span class="n">Trajectory</span><span class="p">):</span>

        <span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">poses</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="c1"># If there is more information (velocity, time) in our array, only use the pose info</span>

        <span class="n">traj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">atleast_2d</span><span class="p">(</span><span class="n">traj</span><span class="p">)[:,</span> <span class="p">:</span><span class="mi">7</span><span class="p">]</span>

    <span class="n">n_frames</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># If desired, sample frames evenly across the trajectory to plot a subset</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">n_frames</span><span class="p">:</span>

        <span class="c1"># This indexing ensures that the first and last frames are plotted</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_frames</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="kp">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">traj</span> <span class="o">=</span> <span class="n">traj</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">tmats</span> <span class="o">=</span> <span class="n">batched_pos_quats_to_tmats</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

    <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tmats</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>

        <span class="n">ids</span> <span class="o">+=</span> <span class="n">visualize_frame</span><span class="p">(</span><span class="n">tmats</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="kp">size</span><span class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ids</span>

<span class="c1"># TODO Move this to a more dynamics-relevant location?</span>

<span class="k">def</span> <span class="nf">stopping_criteria</span><span class="p">(</span>

    <span class="n">pos</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">quat</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">lin_vel</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">ang_vel</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">pos_des</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">quat_des</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>

    <span class="n">dp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>

    <span class="n">dq</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>

    <span class="n">dv</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="p">,</span>

    <span class="n">dw</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5e-3</span><span class="p">,</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine if the Astrobee has fully stopped, based on its current dynamics state</span>

<span class="sd">    Args:</span>

<span class="sd">        pos (npt.ArrayLike): Current position, shape (3,)</span>

<span class="sd">        quat (npt.ArrayLike): Current XYZW quaternion orientation, shape (4,)</span>

<span class="sd">        lin_vel (npt.ArrayLike): Current linear velocity, shape (3,)</span>

<span class="sd">        ang_vel (npt.ArrayLike): Current angular velocity, shape (3,)</span>

<span class="sd">        pos_des (npt.ArrayLike): Desired position, shape (3,)</span>

<span class="sd">        quat_des (npt.ArrayLike): Desired XYZW quaternion orientation, shape (4,)</span>

<span class="sd">        dp (float, optional): Tolerance on position error magnitude. Defaults to 1e-2.</span>

<span class="sd">        dq (float, optional): Tolerance on quaternion distance between cur/des. Defaults to 1e-2.</span>

<span class="sd">        dv (float, optional): Tolerance on linear velocity error magnitude. Defaults to 1e-2.</span>

<span class="sd">        dw (float, optional): Tolerance on angular velocity error magnitude. Defaults to 5e-3.</span>

<span class="sd">    Returns:</span>

<span class="sd">        bool: If the Astrobee have successfully stopped at its desired goal pose</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">pos_des</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dp</span>

    <span class="n">q_check</span> <span class="o">=</span> <span class="n">quaternion_dist</span><span class="p">(</span><span class="n">quat</span><span class="p">,</span> <span class="n">quat_des</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dq</span>

    <span class="n">v_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">lin_vel</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dv</span>

    <span class="n">w_check</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ang_vel</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">dw</span>

    <span class="n">checks</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_check</span><span class="p">,</span> <span class="n">q_check</span><span class="p">,</span> <span class="n">v_check</span><span class="p">,</span> <span class="n">w_check</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">all</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">merge_trajs</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span> <span class="n">orn_traj</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge the position component from one trajectory with the orientation component from another</span>

<span class="sd">    Args:</span>

<span class="sd">        pos_traj (Trajectory): Trajectory with desired position component</span>

<span class="sd">        orn_traj (Trajectory): Trajectory with desired orientation component</span>

<span class="sd">    Returns:</span>

<span class="sd">        Trajectory: Merged trajectory with both position + orientation info</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="n">positions</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">positions</span>

    <span class="n">quaternions</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">quaternions</span>

    <span class="c1"># Time</span>

    <span class="c1"># If both trajectories have time info, make sure they match up</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="kp">allclose</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">orn_traj</span><span class="o">.</span><span class="n">times</span><span class="p">):</span>

                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Mismatched time information&quot;</span><span class="p">)</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">times</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">timestep</span>

    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">times</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">orn_traj</span><span class="o">.</span><span class="n">times</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="n">orn_traj</span><span class="o">.</span><span class="n">timestep</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">times</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">dt</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># If either trajectory is missing derivative info, compute it if we can</span>

    <span class="c1"># Position</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">lin_vels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">gradient</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">lin_vels</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">linear_velocities</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">lin_accels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">gradient</span><span class="p">(</span><span class="n">lin_vels</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">lin_accels</span> <span class="o">=</span> <span class="n">pos_traj</span><span class="o">.</span><span class="n">linear_accels</span>

    <span class="c1"># Orientation</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">ang_vels</span> <span class="o">=</span> <span class="n">quats_to_angular_velocities</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">ang_vels</span> <span class="o">=</span> <span class="n">orn_traj</span><span class="o">.</span><span class="n">angular_velocities</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="kp">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">dt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">ang_accels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">gradient</span><span class="p">(</span><span class="n">ang_vels</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>

        <span class="n">ang_accels</span> <span class="o">=</span> <span class="n">orn_traj</span><span class="o">.</span><span class="n">angular_accels</span>

    <span class="k">return</span> <span class="n">Trajectory</span><span class="p">(</span>

        <span class="n">positions</span><span class="p">,</span> <span class="n">quaternions</span><span class="p">,</span> <span class="n">lin_vels</span><span class="p">,</span> <span class="n">ang_vels</span><span class="p">,</span> <span class="n">lin_accels</span><span class="p">,</span> <span class="n">ang_accels</span><span class="p">,</span> <span class="n">times</span>

    <span class="p">)</span>

<span class="k">def</span> <span class="nf">concatenate_trajs</span><span class="p">(</span><span class="n">traj_1</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span> <span class="n">traj_2</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine two trajectories one after the other</span>

<span class="sd">    This will follow the first trajectory until its end, then follow the second one until it ends</span>

<span class="sd">    Args:</span>

<span class="sd">        traj_1 (Trajectory): First trajectory</span>

<span class="sd">        traj_2 (Trajectory): Second trajectory</span>

<span class="sd">    Returns:</span>

<span class="sd">        Trajectory: Combined trajectory</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Ensure continuity in time</span>

    <span class="c1"># TODO check for continuity in all other components?</span>

    <span class="c1"># TODO this assumes that both have time information</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span> <span class="o">+</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">])</span>

    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">):</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">Trajectory</span><span class="p">(</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">positions</span><span class="p">]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">(</span>

            <span class="p">[</span><span class="n">traj_1</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">quaternions</span><span class="p">],</span>

        <span class="p">),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">]),</span>

        <span class="n">times</span><span class="p">,</span>

    <span class="p">)</span>

<span class="k">def</span> <span class="nf">concatenate_arm_trajs</span><span class="p">(</span>

    <span class="n">traj_1</span><span class="p">:</span> <span class="n">ArmTrajectory</span><span class="p">,</span> <span class="n">traj_2</span><span class="p">:</span> <span class="n">ArmTrajectory</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Combine two arm trajectories one after the other</span>

<span class="sd">    This will follow the first trajectory until its end, then follow the second one until it ends</span>

<span class="sd">    Args:</span>

<span class="sd">        traj_1 (ArmTrajectory): First trajectory</span>

<span class="sd">        traj_2 (ArmTrajectory): Second trajectory</span>

<span class="sd">    Returns:</span>

<span class="sd">        ArmTrajectory: Combined trajectory</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">joint_ids</span> <span class="o">!=</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>

            <span class="s2">&quot;Controlled joint indices must match between the two trajectories (for now)&quot;</span>

        <span class="p">)</span>

    <span class="c1"># Ensure continuity in time, and merge the key time information</span>

    <span class="c1"># TODO check for continuity in all other components?</span>

    <span class="c1"># TODO this assumes that both have time information</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="n">new_key_times</span> <span class="o">=</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">key_times</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">):</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span> <span class="o">+</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span> <span class="ow">in</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">key_times</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

            <span class="n">new_key_times</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span>

    <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span><span class="p">):</span>

        <span class="n">times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">times</span><span class="p">])</span>

        <span class="n">new_key_times</span> <span class="o">|=</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">key_times</span>

    <span class="k">return</span> <span class="n">ArmTrajectory</span><span class="p">(</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">traj_2</span><span class="o">.</span><span class="n">angles</span><span class="p">]),</span>

        <span class="n">traj_1</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">,</span>

        <span class="n">times</span><span class="p">,</span>

        <span class="n">new_key_times</span><span class="p">,</span>

    <span class="p">)</span>

<span class="k">def</span> <span class="nf">extrapolate_traj</span><span class="p">(</span>

    <span class="n">traj</span><span class="p">:</span> <span class="n">Trajectory</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extrapolates a trajectory by an amount of time</span>

<span class="sd">    This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</span>

<span class="sd">    Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</span>

<span class="sd">    Args:</span>

<span class="sd">        traj (Trajectory): Original trajectory</span>

<span class="sd">        duration (Optional[float], optional): Amount of time to extrapolate by. Defaults to None</span>

<span class="sd">            (n_steps input must be provided)</span>

<span class="sd">        n_steps (Optional[int], optional): Number of timesteps to extrapolate by. Defaults to None</span>

<span class="sd">            (duration input must be provided)</span>

<span class="sd">    Returns:</span>

<span class="sd">        Trajectory: Extrapolated trajectory</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

            <span class="s2">&quot;Must provide either a duration to extrapolate by, or a fixed number of timesteps&quot;</span>

        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either a duration or a number of timesteps, not both&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">n_steps</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>

        <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">0</span>

    <span class="p">):</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>

            <span class="s2">&quot;Cannot extrapolate the trajectory: Only implemented for trajectories that end at a stopped pose&quot;</span>

        <span class="p">)</span>

    <span class="k">return</span> <span class="n">Trajectory</span><span class="p">(</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">positions</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">quaternions</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">linear_velocities</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">angular_velocities</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">linear_accels</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">angular_accels</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">3</span><span class="p">))]),</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">]),</span>

    <span class="p">)</span>

<span class="k">def</span> <span class="nf">extrapolate_arm_traj</span><span class="p">(</span>

    <span class="n">traj</span><span class="p">:</span> <span class="n">ArmTrajectory</span><span class="p">,</span> <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Extrapolates an arm trajectory by an amount of time</span>

<span class="sd">    This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</span>

<span class="sd">    Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</span>

<span class="sd">    Args:</span>

<span class="sd">        traj (ArmTrajectory): Original arm trajectory</span>

<span class="sd">        duration (Optional[float], optional): Amount of time to extrapolate by. Defaults to None</span>

<span class="sd">            (n_steps input must be provided)</span>

<span class="sd">        n_steps (Optional[int], optional): Number of timesteps to extrapolate by. Defaults to None</span>

<span class="sd">            (duration input must be provided)</span>

<span class="sd">    Returns:</span>

<span class="sd">        ArmTrajectory: Extrapolated arm trajectory</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dt</span> <span class="o">=</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>

            <span class="s2">&quot;Must provide either a duration to extrapolate by, or a fixed number of timesteps&quot;</span>

        <span class="p">)</span>

    <span class="k">elif</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Provide either a duration or a number of timesteps, not both&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">duration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">n_steps</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">n_steps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">ArmTrajectory</span><span class="p">(</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">vstack</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">angles</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">angles</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span> <span class="mi">1</span><span class="p">))]),</span>

        <span class="n">traj</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">,</span>

        <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">,</span> <span class="n">traj</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span><span class="p">]),</span>

        <span class="n">traj</span><span class="o">.</span><span class="n">key_times</span><span class="p">,</span>

    <span class="p">)</span>
</code></pre></div>

</details>
<h2 id="functions">Functions</h2>
<h3 id="compare_trajs">compare_trajs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">compare_trajs</span><span class="p">(</span>
    <span class="n">traj_1</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">traj_2</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fmt_1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span>
    <span class="n">fmt_2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;b-&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>
</code></pre></div>

<p>Compares two trajectories by plotting them on the same axes</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj_1</td>
<td>Trajectory</td>
<td>First trajectory to plot</td>
<td>None</td>
</tr>
<tr>
<td>traj_2</td>
<td>Trajectory</td>
<td>Second trajectory to plot</td>
<td>None</td>
</tr>
<tr>
<td>show</td>
<td>bool</td>
<td>. Defaults to True.</td>
<td>True</td>
</tr>
<tr>
<td>fmt_1</td>
<td>str</td>
<td>Matplotlib line specification for the first traj. Defaults to "k-".</td>
<td>"k-"</td>
</tr>
<tr>
<td>fmt_2</td>
<td>str</td>
<td>Matplotlib line specification for the second traj. Defaults to "b-".</td>
<td>"b-"</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure</td>
<td>Matplotlib figure containing the plots</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">compare_trajs</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj_1</span><span class="p">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span>

<span class="w">    </span><span class="nl">traj_2</span><span class="p">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span>

<span class="w">    </span><span class="nl">show</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span>

<span class="w">    </span><span class="nl">fmt_1</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;k-&quot;</span><span class="p">,</span>

<span class="w">    </span><span class="nl">fmt_2</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;b-&quot;</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Compares two trajectories by plotting them on the same axes</span>

<span class="ss">    Args:</span>

<span class="ss">        traj_1 (Trajectory): First trajectory to plot</span>

<span class="ss">        traj_2 (Trajectory): Second trajectory to plot</span>

<span class="ss">        show (bool, optional): . Defaults to True.</span>

<span class="ss">        fmt_1 (str, optional): Matplotlib line specification for the first traj. Defaults to &quot;</span><span class="n">k</span><span class="o">-</span><span class="ss">&quot;.</span>

<span class="ss">        fmt_2 (str, optional): Matplotlib line specification for the second traj. Defaults to &quot;</span><span class="n">b</span><span class="o">-</span><span class="ss">&quot;.</span>

<span class="ss">    Returns:</span>

<span class="ss">        Figure: Matplotlib figure containing the plots</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">variables</span>

<span class="w">    </span><span class="n">POS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="n">ORN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="n">LIN_VEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="n">ANG_VEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="w">    </span><span class="n">LIN_ACCEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>

<span class="w">    </span><span class="n">ANG_ACCEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>

<span class="w">    </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="nl">POS</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;x&quot;, &quot;y&quot;, &quot;z&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ORN</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;qx&quot;, &quot;qy&quot;, &quot;qz&quot;, &quot;qw&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">LIN_VEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;vx&quot;, &quot;vy&quot;, &quot;vz&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ANG_VEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;wx&quot;, &quot;wy&quot;, &quot;wz&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">LIN_ACCEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;ax&quot;, &quot;ay&quot;, &quot;az&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ANG_ACCEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;al_x&quot;, &quot;al_y&quot;, &quot;al_z&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">kinda</span><span class="w"> </span><span class="n">weird</span><span class="w"> </span><span class="nf">right</span><span class="w"> </span><span class="n">now</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">happens</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">doesn</span><span class="err">&#39;</span><span class="n">t</span><span class="vm">??</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">traj_1</span><span class="p">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Timesteps&quot;</span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Time, s&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Top</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Columns</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">fmt</span><span class="p">:</span><span class="w"> </span><span class="k">off</span>

<span class="w">    </span><span class="n">subfigs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="p">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">POS</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">POS</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ORN</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ORN</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_mid</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_mid</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_1</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_1</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis_2</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt_2</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">fmt</span><span class="p">:</span><span class="w"> </span><span class="k">on</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">show</span><span class="p">:</span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fig</span>
</code></pre></div>

</details>
<h3 id="concatenate_arm_trajs">concatenate_arm_trajs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">concatenate_arm_trajs</span><span class="p">(</span>
    <span class="n">traj_1</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ArmTrajectory</span><span class="p">,</span>
    <span class="n">traj_2</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ArmTrajectory</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ArmTrajectory</span>
</code></pre></div>

<p>Combine two arm trajectories one after the other</p>
<p>This will follow the first trajectory until its end, then follow the second one until it ends</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj_1</td>
<td>ArmTrajectory</td>
<td>First trajectory</td>
<td>None</td>
</tr>
<tr>
<td>traj_2</td>
<td>ArmTrajectory</td>
<td>Second trajectory</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArmTrajectory</td>
<td>Combined trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">concatenate_arm_trajs</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj_1</span><span class="p">:</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">,</span><span class="w"> </span><span class="nl">traj_2</span><span class="p">:</span><span class="w"> </span><span class="n">ArmTrajectory</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Combine two arm trajectories one after the other</span>

<span class="ss">    This will follow the first trajectory until its end, then follow the second one until it ends</span>

<span class="ss">    Args:</span>

<span class="ss">        traj_1 (ArmTrajectory): First trajectory</span>

<span class="ss">        traj_2 (ArmTrajectory): Second trajectory</span>

<span class="ss">    Returns:</span>

<span class="ss">        ArmTrajectory: Combined trajectory</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">joint_ids</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="nl">joint_ids</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;Controlled joint indices must match between the two trajectories (for now)&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Ensure</span><span class="w"> </span><span class="n">continuity</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">time</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">merge</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">information</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">continuity</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">components</span><span class="vm">?</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">assumes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">both</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">information</span>

<span class="w">    </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-2</span><span class="o">]</span>

<span class="w">    </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">key_times</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="o">[</span><span class="n">traj_1.times, traj_2.times + traj_1.times[-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="err">]</span><span class="p">)</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="o">[</span><span class="n">traj_1.times, traj_2.times</span><span class="o">]</span><span class="p">)</span>

<span class="w">        </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">key_times</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj_1.angles, traj_2.angles</span><span class="o">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">traj_1</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span>

<span class="w">        </span><span class="n">times</span><span class="p">,</span>

<span class="w">        </span><span class="n">new_key_times</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="concatenate_trajs">concatenate_trajs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">concatenate_trajs</span><span class="p">(</span>
    <span class="n">traj_1</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">traj_2</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span>
</code></pre></div>

<p>Combine two trajectories one after the other</p>
<p>This will follow the first trajectory until its end, then follow the second one until it ends</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj_1</td>
<td>Trajectory</td>
<td>First trajectory</td>
<td>None</td>
</tr>
<tr>
<td>traj_2</td>
<td>Trajectory</td>
<td>Second trajectory</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trajectory</td>
<td>Combined trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">concatenate_trajs</span><span class="p">(</span><span class="n">traj_1</span><span class="o">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="o">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Trajectory</span><span class="o">:</span>

<span class="w">    </span><span class="s">&quot;&quot;&quot;Combine two trajectories one after the other</span>

<span class="s">    This will follow the first trajectory until its end, then follow the second one until it ends</span>

<span class="s">    Args:</span>

<span class="s">        traj_1 (Trajectory): First trajectory</span>

<span class="s">        traj_2 (Trajectory): Second trajectory</span>

<span class="s">    Returns:</span>

<span class="s">        Trajectory: Combined trajectory</span>

<span class="s">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Ensure</span><span class="w"> </span><span class="n">continuity</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">time</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">continuity</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="kr">all</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">components</span><span class="o">?</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">assumes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">information</span>

<span class="w">    </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">])</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span><span class="o">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">times</span><span class="p">])</span>

<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">positions</span><span class="p">]),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span>

<span class="w">            </span><span class="p">[</span><span class="n">traj_1</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">quaternions</span><span class="p">],</span>

<span class="w">        </span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">]),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">]),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">]),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">traj_1</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">,</span><span class="w"> </span><span class="n">traj_2</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">]),</span>

<span class="w">        </span><span class="n">times</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="extrapolate_arm_traj">extrapolate_arm_traj</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extrapolate_arm_traj</span><span class="p">(</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ArmTrajectory</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">ArmTrajectory</span>
</code></pre></div>

<p>Extrapolates an arm trajectory by an amount of time</p>
<p>This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</p>
<p>Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj</td>
<td>ArmTrajectory</td>
<td>Original arm trajectory</td>
<td>None</td>
</tr>
<tr>
<td>duration</td>
<td>Optional[float]</td>
<td>Amount of time to extrapolate by. Defaults to None<br>(n_steps input must be provided)</td>
<td>None</td>
</tr>
<tr>
<td>n_steps</td>
<td>Optional[int]</td>
<td>Number of timesteps to extrapolate by. Defaults to None<br>(duration input must be provided)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArmTrajectory</td>
<td>Extrapolated arm trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">extrapolate_arm_traj</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj</span><span class="p">:</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">,</span><span class="w"> </span><span class="nl">duration</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Extrapolates an arm trajectory by an amount of time</span>

<span class="ss">    This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</span>

<span class="ss">    Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</span>

<span class="ss">    Args:</span>

<span class="ss">        traj (ArmTrajectory): Original arm trajectory</span>

<span class="ss">        duration (Optional[float], optional): Amount of time to extrapolate by. Defaults to None</span>

<span class="ss">            (n_steps input must be provided)</span>

<span class="ss">        n_steps (Optional[int], optional): Number of timesteps to extrapolate by. Defaults to None</span>

<span class="ss">            (duration input must be provided)</span>

<span class="ss">    Returns:</span>

<span class="ss">        ArmTrajectory: Extrapolated arm trajectory</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-2</span><span class="o">]</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;Must provide either a duration to extrapolate by, or a fixed number of timesteps&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Provide either a duration or a number of timesteps, not both&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">duration</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">    </span><span class="n">assert</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.angles, traj.angles[-1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="err">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">traj</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="o">[</span><span class="n">traj.times, traj.times[-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="err">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">traj</span><span class="p">.</span><span class="n">key_times</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="extrapolate_traj">extrapolate_traj</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">extrapolate_traj</span><span class="p">(</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">n_steps</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span>
</code></pre></div>

<p>Extrapolates a trajectory by an amount of time</p>
<p>This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</p>
<p>Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj</td>
<td>Trajectory</td>
<td>Original trajectory</td>
<td>None</td>
</tr>
<tr>
<td>duration</td>
<td>Optional[float]</td>
<td>Amount of time to extrapolate by. Defaults to None<br>(n_steps input must be provided)</td>
<td>None</td>
</tr>
<tr>
<td>n_steps</td>
<td>Optional[int]</td>
<td>Number of timesteps to extrapolate by. Defaults to None<br>(duration input must be provided)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trajectory</td>
<td>Extrapolated trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">extrapolate_traj</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj</span><span class="p">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span><span class="w"> </span><span class="nl">duration</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Extrapolates a trajectory by an amount of time</span>

<span class="ss">    This assumes that the (pre-extrapolation) trajectory comes to a rest at the end</span>

<span class="ss">    Either the extrapolation duration or number of timesteps must be specified. Not both, not neither</span>

<span class="ss">    Args:</span>

<span class="ss">        traj (Trajectory): Original trajectory</span>

<span class="ss">        duration (Optional[float], optional): Amount of time to extrapolate by. Defaults to None</span>

<span class="ss">            (n_steps input must be provided)</span>

<span class="ss">        n_steps (Optional[int], optional): Number of timesteps to extrapolate by. Defaults to None</span>

<span class="ss">            (duration input must be provided)</span>

<span class="ss">    Returns:</span>

<span class="ss">        Trajectory: Extrapolated trajectory</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-2</span><span class="o">]</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;Must provide either a duration to extrapolate by, or a fixed number of timesteps&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;Provide either a duration or a number of timesteps, not both&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">duration</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">    </span><span class="n">assert</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">linear_velocities</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">isclose</span><span class="p">(</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">angular_velocities</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;Cannot extrapolate the trajectory: Only implemented for trajectories that end at a stopped pose&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.positions, traj.positions[-1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="err">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.quaternions, traj.quaternions[-1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="err">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.linear_velocities, np.zeros((n_steps, 3))</span><span class="o">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.angular_velocities, np.zeros((n_steps, 3))</span><span class="o">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.linear_accels, np.zeros((n_steps, 3))</span><span class="o">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span><span class="o">[</span><span class="n">traj.angular_accels, np.zeros((n_steps, 3))</span><span class="o">]</span><span class="p">),</span>

<span class="w">        </span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="o">[</span><span class="n">traj.times, traj.times[-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span><span class="err">]</span><span class="p">),</span>

<span class="w">    </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="merge_trajs">merge_trajs</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">merge_trajs</span><span class="p">(</span>
    <span class="n">pos_traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">orn_traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span>
</code></pre></div>

<p>Merge the position component from one trajectory with the orientation component from another</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>pos_traj</td>
<td>Trajectory</td>
<td>Trajectory with desired position component</td>
<td>None</td>
</tr>
<tr>
<td>orn_traj</td>
<td>Trajectory</td>
<td>Trajectory with desired orientation component</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trajectory</td>
<td>Merged trajectory with both position + orientation info</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">merge_trajs</span><span class="p">(</span><span class="n">pos_traj</span><span class="o">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span><span class="w"> </span><span class="n">orn_traj</span><span class="o">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Trajectory</span><span class="o">:</span>

<span class="w">    </span><span class="s">&quot;&quot;&quot;Merge the position component from one trajectory with the orientation component from another</span>

<span class="s">    Args:</span>

<span class="s">        pos_traj (Trajectory): Trajectory with desired position component</span>

<span class="s">        orn_traj (Trajectory): Trajectory with desired orientation component</span>

<span class="s">    Returns:</span>

<span class="s">        Trajectory: Merged trajectory with both position + orientation info</span>

<span class="s">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="kr">assert</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">positions</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="kr">assert</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">quaternions</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="n">positions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">positions</span>

<span class="w">    </span><span class="n">quaternions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">quaternions</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Time</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">trajectories</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">match</span><span class="w"> </span><span class="n">up</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">orn_traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="o">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="s">&quot;Mismatched time information&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">times</span>

<span class="w">        </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">timestep</span>

<span class="w">    </span><span class="n">elif</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orn_traj</span><span class="p">.</span><span class="n">times</span>

<span class="w">        </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orn_traj</span><span class="p">.</span><span class="n">timestep</span>

<span class="w">    </span><span class="n">else</span><span class="o">:</span>

<span class="w">        </span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nf">If</span><span class="w"> </span><span class="n">either</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">missing</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">compute</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="nf">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Position</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="n">lin_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="w">    </span><span class="n">else</span><span class="o">:</span>

<span class="w">        </span><span class="n">lin_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">linear_velocities</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">pos_traj</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="n">lin_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">lin_vels</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="w">    </span><span class="n">else</span><span class="o">:</span>

<span class="w">        </span><span class="n">lin_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_traj</span><span class="p">.</span><span class="n">linear_accels</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Orientation</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="n">ang_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quats_to_angular_velocities</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">    </span><span class="n">else</span><span class="o">:</span>

<span class="w">        </span><span class="n">ang_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orn_traj</span><span class="p">.</span><span class="n">angular_velocities</span>

<span class="w">    </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="n">orn_traj</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kr">and</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="n">ang_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">ang_vels</span><span class="p">,</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="w">    </span><span class="n">else</span><span class="o">:</span>

<span class="w">        </span><span class="n">ang_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orn_traj</span><span class="p">.</span><span class="n">angular_accels</span>

<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">        </span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">lin_vels</span><span class="p">,</span><span class="w"> </span><span class="n">ang_vels</span><span class="p">,</span><span class="w"> </span><span class="n">lin_accels</span><span class="p">,</span><span class="w"> </span><span class="n">ang_accels</span><span class="p">,</span><span class="w"> </span><span class="n">times</span>

<span class="w">    </span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="plot_traj">plot_traj</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_traj</span><span class="p">(</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;k-&#39;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>
</code></pre></div>

<p>Plot the trajectory components over time</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj</td>
<td>Trajectory</td>
<td>The Trajectory object to plot</td>
<td>None</td>
</tr>
<tr>
<td>show</td>
<td>bool</td>
<td>Whether or not to display the plot. Defaults to True.</td>
<td>True</td>
</tr>
<tr>
<td>fmt</td>
<td>str</td>
<td>Matplotlib line specification. Defaults to "k-"</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure</td>
<td>Matplotlib figure containing the plots</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">plot_traj</span><span class="p">(</span><span class="nl">traj</span><span class="p">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span><span class="w"> </span><span class="nl">show</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span><span class="w"> </span><span class="nl">fmt</span><span class="p">:</span><span class="w"> </span><span class="nf">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;k-&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="ss">    Args:</span>

<span class="ss">        traj (Trajectory): The Trajectory object to plot</span>

<span class="ss">        show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="ss">        fmt (str, optional): Matplotlib line specification. Defaults to &quot;</span><span class="n">k</span><span class="o">-</span><span class="ss">&quot;</span>

<span class="ss">    Returns:</span>

<span class="ss">        Figure: Matplotlib figure containing the plots</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="n">helper</span><span class="w"> </span><span class="n">variables</span>

<span class="w">    </span><span class="n">POS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="n">ORN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="n">LIN_VEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span>

<span class="w">    </span><span class="n">ANG_VEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span>

<span class="w">    </span><span class="n">LIN_ACCEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span>

<span class="w">    </span><span class="n">ANG_ACCEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>

<span class="w">    </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">        </span><span class="nl">POS</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;x&quot;, &quot;y&quot;, &quot;z&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ORN</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;qx&quot;, &quot;qy&quot;, &quot;qz&quot;, &quot;qw&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">LIN_VEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;vx&quot;, &quot;vy&quot;, &quot;vz&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ANG_VEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;wx&quot;, &quot;wy&quot;, &quot;wz&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">LIN_ACCEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;ax&quot;, &quot;ay&quot;, &quot;az&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ANG_ACCEL</span><span class="p">:</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;al_x&quot;, &quot;al_y&quot;, &quot;al_z&quot;</span><span class="o">]</span><span class="p">,</span>

<span class="w">    </span><span class="err">}</span>

<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Timesteps&quot;</span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Time, s&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Top</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Columns</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="n">subfigs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="p">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">POS</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_middle</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="n">top_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">top_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">LIN_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ORN</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_middle</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_VEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="n">bot_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="n">_plot</span><span class="p">(</span><span class="n">bot_right</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">[</span><span class="n">ANG_ACCEL</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">show</span><span class="p">:</span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fig</span>
</code></pre></div>

</details>
<h3 id="plot_traj_constraints">plot_traj_constraints</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot_traj_constraints</span><span class="p">(</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span>
    <span class="n">pos_lims</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pyastrobee</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">Box</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_vel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_accel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_omega</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_alpha</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>
</code></pre></div>

<p>Plot trajectory info to visualize how it satisfies constraints</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj</td>
<td>Trajectory</td>
<td>Trajectory to plot</td>
<td>None</td>
</tr>
<tr>
<td>pos_lims</td>
<td>Optional[Union[Box, npt.ArrayLike]]</td>
<td>Lower and upper limits on the XYZ position. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>max_vel</td>
<td>Optional[float]</td>
<td>Maximum velocity magnitude. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>max_accel</td>
<td>Optional[float]</td>
<td>Maximum acceleration magnitude. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>max_omega</td>
<td>Optional[float]</td>
<td>Maximum angular velocity magnitude. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>max_alpha</td>
<td>Optional[float]</td>
<td>Maximum angular acceleration magnitude. Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>show</td>
<td>bool</td>
<td>Whether or not to display the plot. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure</td>
<td>The plot</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">plot_traj_constraints</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj</span><span class="p">:</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">,</span>

<span class="w">    </span><span class="nl">pos_lims</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Union[Box, npt.ArrayLike</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">max_vel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">max_accel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">max_omega</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">max_alpha</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">show</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Figure</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Plot trajectory info to visualize how it satisfies constraints</span>

<span class="ss">    Args:</span>

<span class="ss">        traj (Trajectory): Trajectory to plot</span>

<span class="ss">        pos_lims (Optional[Union[Box, npt.ArrayLike]]): Lower and upper limits on the XYZ position. Defaults to None.</span>

<span class="ss">        max_vel (Optional[float]): Maximum velocity magnitude. Defaults to None.</span>

<span class="ss">        max_accel (Optional[float]): Maximum acceleration magnitude. Defaults to None.</span>

<span class="ss">        max_omega (Optional[float]): Maximum angular velocity magnitude. Defaults to None.</span>

<span class="ss">        max_alpha (Optional[float]): Maximum angular acceleration magnitude. Defaults to None.</span>

<span class="ss">        show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="ss">    Returns:</span>

<span class="ss">        Figure: The plot</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Timesteps&quot;</span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span>

<span class="w">        </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">times</span>

<span class="w">        </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Time, s&quot;</span>

<span class="w">    </span><span class="n">fmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;k-&quot;</span>

<span class="w">    </span><span class="n">lim_fmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;r--&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Top</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">bottom</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Columns</span><span class="w"> </span><span class="n">give</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="n">info</span>

<span class="w">    </span><span class="n">subfigs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fig</span><span class="p">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Position</span>

<span class="w">    </span><span class="n">top_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">top_left</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">positions</span><span class="o">[</span><span class="n">:, i</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">            </span><span class="n">ax</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="o">[</span><span class="n">&quot;x&quot;, &quot;y&quot;, &quot;z&quot;</span><span class="o">][</span><span class="n">i</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">pos_lims</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">lower_pos_lim</span><span class="p">,</span><span class="w"> </span><span class="n">upper_pos_lim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_lims</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ax</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">top_left</span><span class="p">)</span><span class="err">:</span>

<span class="w">                </span><span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">lower_pos_lim</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">                </span><span class="n">ax</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">upper_pos_lim</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Linear</span><span class="w"> </span><span class="n">velocity</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">top_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_middle</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_middle</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;||vel||&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_middle</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_vel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">top_middle</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">max_vel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Linear</span><span class="w"> </span><span class="n">acceleration</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">top_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">0, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_right</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_right</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;||accel||&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">top_right</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_accel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">top_right</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">max_accel</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Quaternions</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">unconstrained</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">it</span><span class="err">&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">plotting</span><span class="w"> </span><span class="k">method</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">standard</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">traj</span><span class="w"> </span><span class="k">function</span>

<span class="w">    </span><span class="n">bot_left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 0</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">_plot</span><span class="p">(</span>

<span class="w">            </span><span class="n">bot_left</span><span class="p">,</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">quaternions</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">&quot;qx&quot;, &quot;qy&quot;, &quot;qz&quot;, &quot;qw&quot;</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">x_label</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Angular</span><span class="w"> </span><span class="n">velocity</span>

<span class="w">    </span><span class="n">bot_middle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 1</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">bot_middle</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">        </span><span class="n">bot_middle</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;||omega||&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">bot_middle</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_omega</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">bot_middle</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">max_omega</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Angular</span><span class="w"> </span><span class="n">acceleration</span>

<span class="w">    </span><span class="n">bot_right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">subfigs</span><span class="o">[</span><span class="n">1, 2</span><span class="o">]</span><span class="p">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">        </span><span class="n">bot_right</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">traj</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="n">fmt</span><span class="p">)</span>

<span class="w">        </span><span class="n">bot_right</span><span class="p">.</span><span class="n">set_title</span><span class="p">(</span><span class="ss">&quot;||alpha||&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">bot_right</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">max_alpha</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">bot_right</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">max_alpha</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_axis</span><span class="p">),</span><span class="w"> </span><span class="n">lim_fmt</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nl">show</span><span class="p">:</span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">fig</span>
</code></pre></div>

</details>
<h3 id="stopping_criteria">stopping_criteria</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">stopping_criteria</span><span class="p">(</span>
    <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">quat</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">lin_vel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">ang_vel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">pos_des</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">quat_des</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">dp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">dq</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">dv</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="n">dw</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
</code></pre></div>

<p>Determine if the Astrobee has fully stopped, based on its current dynamics state</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>pos</td>
<td>npt.ArrayLike</td>
<td>Current position, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>quat</td>
<td>npt.ArrayLike</td>
<td>Current XYZW quaternion orientation, shape (4,)</td>
<td>None</td>
</tr>
<tr>
<td>lin_vel</td>
<td>npt.ArrayLike</td>
<td>Current linear velocity, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>ang_vel</td>
<td>npt.ArrayLike</td>
<td>Current angular velocity, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>pos_des</td>
<td>npt.ArrayLike</td>
<td>Desired position, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>quat_des</td>
<td>npt.ArrayLike</td>
<td>Desired XYZW quaternion orientation, shape (4,)</td>
<td>None</td>
</tr>
<tr>
<td>dp</td>
<td>float</td>
<td>Tolerance on position error magnitude. Defaults to 1e-2.</td>
<td>1e-2</td>
</tr>
<tr>
<td>dq</td>
<td>float</td>
<td>Tolerance on quaternion distance between cur/des. Defaults to 1e-2.</td>
<td>1e-2</td>
</tr>
<tr>
<td>dv</td>
<td>float</td>
<td>Tolerance on linear velocity error magnitude. Defaults to 1e-2.</td>
<td>1e-2</td>
</tr>
<tr>
<td>dw</td>
<td>float</td>
<td>Tolerance on angular velocity error magnitude. Defaults to 5e-3.</td>
<td>5e-3</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>bool</td>
<td>If the Astrobee have successfully stopped at its desired goal pose</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">stopping_criteria</span><span class="p">(</span>

<span class="w">    </span><span class="n">pos</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">quat</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">lin_vel</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">ang_vel</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">pos_des</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">quat_des</span><span class="o">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="n">dp</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">,</span>

<span class="w">    </span><span class="n">dq</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">,</span>

<span class="w">    </span><span class="n">dv</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1e-2</span><span class="p">,</span>

<span class="w">    </span><span class="n">dw</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5e-3</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bool</span><span class="o">:</span>

<span class="w">    </span><span class="s">&quot;&quot;&quot;Determine if the Astrobee has fully stopped, based on its current dynamics state</span>

<span class="s">    Args:</span>

<span class="s">        pos (npt.ArrayLike): Current position, shape (3,)</span>

<span class="s">        quat (npt.ArrayLike): Current XYZW quaternion orientation, shape (4,)</span>

<span class="s">        lin_vel (npt.ArrayLike): Current linear velocity, shape (3,)</span>

<span class="s">        ang_vel (npt.ArrayLike): Current angular velocity, shape (3,)</span>

<span class="s">        pos_des (npt.ArrayLike): Desired position, shape (3,)</span>

<span class="s">        quat_des (npt.ArrayLike): Desired XYZW quaternion orientation, shape (4,)</span>

<span class="s">        dp (float, optional): Tolerance on position error magnitude. Defaults to 1e-2.</span>

<span class="s">        dq (float, optional): Tolerance on quaternion distance between cur/des. Defaults to 1e-2.</span>

<span class="s">        dv (float, optional): Tolerance on linear velocity error magnitude. Defaults to 1e-2.</span>

<span class="s">        dw (float, optional): Tolerance on angular velocity error magnitude. Defaults to 5e-3.</span>

<span class="s">    Returns:</span>

<span class="s">        bool: If the Astrobee have successfully stopped at its desired goal pose</span>

<span class="s">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">p_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">pos</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">pos_des</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dp</span>

<span class="w">    </span><span class="n">q_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quaternion_dist</span><span class="p">(</span><span class="n">quat</span><span class="p">,</span><span class="w"> </span><span class="n">quat_des</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dq</span>

<span class="w">    </span><span class="n">v_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">lin_vel</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dv</span>

<span class="w">    </span><span class="n">w_check</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">ang_vel</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">dw</span>

<span class="w">    </span><span class="n">checks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">p_check</span><span class="p">,</span><span class="w"> </span><span class="n">q_check</span><span class="p">,</span><span class="w"> </span><span class="n">v_check</span><span class="p">,</span><span class="w"> </span><span class="n">w_check</span><span class="p">]</span>

<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="kr">all</span><span class="p">(</span><span class="n">checks</span><span class="p">)</span>
</code></pre></div>

</details>
<h3 id="visualize_traj">visualize_traj</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">visualize_traj</span><span class="p">(</span>
    <span class="n">traj</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">trajectory</span><span class="o">.</span><span class="n">Trajectory</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pybullet_utils</span><span class="o">.</span><span class="n">bullet_client</span><span class="o">.</span><span class="n">BulletClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>Visualizes a trajectory's sequence of poses on the Pybullet GUI</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>traj</td>
<td>Union[Trajectory, npt.ArrayLike]</td>
<td>Trajectory to visualize (must contain at least<br>position + orientation info), or an array of position + quaternion poses, shape (n, 7)</td>
<td>None</td>
</tr>
<tr>
<td>n</td>
<td>Optional[int]</td>
<td>Number of frames to plot, if plotting all of the frames is not desired.<br>Defaults to None (plot all frames)</td>
<td>None</td>
</tr>
<tr>
<td>size</td>
<td>float</td>
<td>Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale<br>with respect to the dimensions of the Astrobee)</td>
<td>0</td>
</tr>
<tr>
<td>client</td>
<td>BulletClient</td>
<td>If connecting to multiple physics servers, include the client<br>(the class instance, not just the ID) here. Defaults to None (use default connected client)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>list[int]</td>
<td>Pybullet IDs for the lines drawn onto the GUI</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">visualize_traj</span><span class="p">(</span>

<span class="w">    </span><span class="nl">traj</span><span class="p">:</span><span class="w"> </span><span class="ow">Union</span><span class="o">[</span><span class="n">Trajectory, npt.ArrayLike</span><span class="o">]</span><span class="p">,</span>

<span class="w">    </span><span class="nl">n</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="k">size</span><span class="err">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>

<span class="w">    </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">BulletClient</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Visualizes a trajectory&#39;s sequence of poses on the Pybullet GUI</span>

<span class="ss">    Args:</span>

<span class="ss">        traj (Union[Trajectory, npt.ArrayLike]): Trajectory to visualize (must contain at least</span>

<span class="ss">            position + orientation info), or an array of position + quaternion poses, shape (n, 7)</span>

<span class="ss">        n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="ss">            Defaults to None (plot all frames)</span>

<span class="ss">        size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="ss">            with respect to the dimensions of the Astrobee)</span>

<span class="ss">        client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="ss">            (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="ss">    Returns:</span>

<span class="ss">        list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">client</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">isinstance</span><span class="p">(</span><span class="n">traj</span><span class="p">,</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">traj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">poses</span>

<span class="w">    </span><span class="k">else</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="p">)</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="k">array</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pose</span><span class="w"> </span><span class="n">info</span>

<span class="w">        </span><span class="n">traj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span><span class="o">[</span><span class="n">:, :7</span><span class="o">]</span>

<span class="w">    </span><span class="n">n_frames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="p">.</span><span class="n">shape</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">desired</span><span class="p">,</span><span class="w"> </span><span class="n">sample</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="n">evenly</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subset</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nl">n_frames</span><span class="p">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">indexing</span><span class="w"> </span><span class="n">ensures</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">frames</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">plotted</span>

<span class="w">        </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">n_frames</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">endpoint</span><span class="o">=</span><span class="k">True</span><span class="p">)).</span><span class="n">astype</span><span class="p">(</span><span class="nc">int</span><span class="p">)</span>

<span class="w">        </span><span class="n">traj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">traj</span><span class="o">[</span><span class="n">idx, :</span><span class="o">]</span>

<span class="w">    </span><span class="n">tmats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batched_pos_quats_to_tmats</span><span class="p">(</span><span class="n">traj</span><span class="p">)</span>

<span class="w">    </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">tmats</span><span class="p">.</span><span class="n">shape</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">ids</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">visualize_frame</span><span class="p">(</span><span class="n">tmats</span><span class="o">[</span><span class="n">i, :, :</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ids</span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="armtrajectory">ArmTrajectory</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">ArmTrajectory</span><span class="p">(</span>
    <span class="n">angles</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="n">joint_ids</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">times</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">key_times</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Maintains information on the positions of the arm's joint angles over time</p>
<p>Currently this assumes we are working with position control</p>
<h4 id="attributes">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>angles</td>
<td>np.ndarray</td>
<td>Joint angles over time, shape (n_timesteps, n_controlled_joints)</td>
<td>None</td>
</tr>
<tr>
<td>joint_ids</td>
<td>npt.ArrayLike</td>
<td>Indices of the joints being controlled with position control. Unspecified joints<br>will be left at their default control value (Either manually set or defined at robot initialization)</td>
<td>None</td>
</tr>
<tr>
<td>times</td>
<td>Optional[npt.ArrayLike]</td>
<td>Time information for the trajectory, shape (n_timesteps). Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>key_times</td>
<td>Optional[dict[str, float]]</td>
<td>Information about when key transitions occur in the trajectory,<br>for instance, when we start/stop an arm deployment motion. Defaults to None.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">ArmTrajectory</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Maintains information on the positions of the arm&#39;s joint angles over time</span>

<span class="ss">    Currently this assumes we are working with position control</span>

<span class="ss">    Args:</span>

<span class="ss">        angles (np.ndarray): Joint angles over time, shape (n_timesteps, n_controlled_joints)</span>

<span class="ss">        joint_ids (npt.ArrayLike): Indices of the joints being controlled with position control. Unspecified joints</span>

<span class="ss">            will be left at their default control value (Either manually set or defined at robot initialization)</span>

<span class="ss">        times (Optional[npt.ArrayLike]): Time information for the trajectory, shape (n_timesteps). Defaults to None.</span>

<span class="ss">        key_times (Optional[dict[str, float]]): Information about when key transitions occur in the trajectory,</span>

<span class="ss">            for instance, when we start/stop an arm deployment motion. Defaults to None.</span>

<span class="ss">    Raises:</span>

<span class="ss">        ValueError: If the shape of the angles input does not match the expected number of joints being controlled,</span>

<span class="ss">            or the number of timesteps in the time input</span>

<span class="ss">        KeyError: If the key_times dictionary contains unexpected keys. Currently supported: &quot;</span><span class="n">begin_drag_motion</span><span class="ss">&quot;,</span>

<span class="ss">            &quot;</span><span class="n">end_drag_motion</span><span class="ss">&quot;, &quot;</span><span class="n">begin_grasp_motion</span><span class="ss">&quot;, &quot;</span><span class="n">end_grasp_motion</span><span class="ss">&quot;</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">angles</span><span class="p">:</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ndarray</span><span class="p">,</span>

<span class="w">        </span><span class="nl">joint_ids</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">        </span><span class="nl">times</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">key_times</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">dict[str, float</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">angles</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="err">:</span>

<span class="w">            </span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angles</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">        </span><span class="n">joint_ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">joint_ids</span><span class="p">)</span>

<span class="w">        </span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="n">n_joints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angles</span><span class="p">.</span><span class="n">shape</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">n_joints</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">joint_ids</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="ss">&quot;Mismatched inputs: The second dimension of the angles must match the number of joints.\n&quot;</span>

<span class="w">                </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="ss">&quot;Got shape: {angles.shape} for {len(joint_ids)} joint indices: {joint_ids}&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">                </span><span class="ss">&quot;Mismatched input dimensions: Time info is not the same length as the angles&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">angles</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">joint_ids</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">num_timesteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_steps</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Hacky</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">store</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">times</span><span class="o">/</span><span class="n">indices</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">arm</span><span class="w"> </span><span class="n">moves</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">forward</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="n">assumes</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="s1">&#39;re going to move the arm to &quot;drag&quot; and then back to &quot;grasp&quot;</span>

<span class="s1">        # TODO make this more general</span>

<span class="s1">        # TODO improve how we handle the keys that we&#39;</span><span class="n">d</span><span class="w"> </span><span class="n">expect</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">see</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key_times</span>

<span class="w">        </span><span class="n">expected_keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{</span>

<span class="w">            </span><span class="ss">&quot;begin_drag_motion&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;end_drag_motion&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;begin_grasp_motion&quot;</span><span class="p">,</span>

<span class="w">            </span><span class="ss">&quot;end_grasp_motion&quot;</span><span class="p">,</span>

<span class="w">        </span><span class="err">}</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">keys</span><span class="p">()</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nl">expected_keys</span><span class="p">:</span>

<span class="w">                </span><span class="n">raise</span><span class="w"> </span><span class="n">KeyError</span><span class="p">(</span><span class="ss">&quot;Unexpected key time name: &quot;</span><span class="p">,</span><span class="w"> </span><span class="k">key</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">            </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Timesteps&quot;</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span>

<span class="w">            </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span>

<span class="w">            </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Time, s&quot;</span>

<span class="w">        </span><span class="n">n_subplots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">)</span>

<span class="w">        </span><span class="n">subplot_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_subplots_to_shape</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)</span>

<span class="w">        </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="k">index</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">)</span><span class="err">:</span>

<span class="w">            </span><span class="n">plt</span><span class="p">.</span><span class="n">subplot</span><span class="p">(</span><span class="o">*</span><span class="n">subplot_shape</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">:, j</span><span class="o">]</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="p">.</span><span class="n">title</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Joint {index}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="p">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="p">.</span><span class="n">ylabel</span><span class="p">(</span><span class="ss">&quot;Angle&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">plt</span><span class="p">.</span><span class="n">show</span><span class="p">()</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="err">!!</span><span class="w"> </span><span class="k">USE</span><span class="w"> </span><span class="k">NEW</span><span class="w"> </span><span class="n">CONCATENATE</span><span class="w"> </span><span class="ow">AND</span><span class="w"> </span><span class="n">EXTRAPOLATE</span><span class="w"> </span><span class="n">METHODS</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">start_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">end_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&quot;ArmTrajectory&quot;</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="ss">        Args:</span>

<span class="ss">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="ss">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="ss">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="ss">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="ss">        Returns:</span>

<span class="ss">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">slicing</span><span class="w"> </span><span class="n">indices</span><span class="vm">?</span><span class="w"> </span><span class="ow">Or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">numpy</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="err">!!!!!!!!!!!!!!!!!!!!!!</span>

<span class="w">        </span><span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;GETTING ARM SEGMENT: Start: {start_index}, End: {end_index}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">NORMAL</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nc">Time</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">reset_time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">new_times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">start_index:end_index, :</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span>

<span class="w">                </span><span class="n">new_times</span><span class="p">,</span>

<span class="w">                </span><span class="n">new_key_times</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span>

<span class="w">            </span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span>

<span class="w">                </span><span class="o">[</span>

<span class="n">                    self.angles[start_index:, :</span><span class="o">]</span><span class="p">,</span>

<span class="w">                    </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">)))</span>

<span class="w">                    </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="err">]</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">start_index</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span><span class="w"> </span><span class="n">new_times</span><span class="p">,</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Both</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">limit</span>

<span class="w">            </span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span>

<span class="w">                </span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span><span class="w"> </span><span class="n">new_times</span><span class="p">,</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment_from_times</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">start_time</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="p">,</span><span class="w"> </span><span class="nl">end_time</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="p">,</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&quot;ArmTrajectory&quot;</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="ss">        Args:</span>

<span class="ss">            start_time (float): Starting time of the segment</span>

<span class="ss">            end_time (float): Ending time of the segment</span>

<span class="ss">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="ss">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="ss">        Returns:</span>

<span class="ss">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">)</span>

<span class="w">        </span><span class="n">end_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">end_time</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Past</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="nc">time</span><span class="p">...</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">HACK</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-2</span><span class="o">]</span>

<span class="w">            </span><span class="n">time_after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span>

<span class="w">            </span><span class="n">end_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">time_after</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_segment</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="n">end_index</span><span class="p">,</span><span class="w"> </span><span class="n">reset_time</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="methods">Methods</h4>
<h4 id="get_segment">get_segment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ArmTrajectory&#39;</span>
</code></pre></div>

<p>Construct an arm trajectory segment from a larger trajectory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_index</td>
<td>int</td>
<td>Starting index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>end_index</td>
<td>int</td>
<td>Ending index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>reset_time</td>
<td>bool</td>
<td>Whether to maintain the time association with the original trajectory,<br>or reset the start time back to 0. Defaults to True (reset start time back to 0)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArmTrajectory</td>
<td>A new trajectory representing a segment of the original trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">start_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">end_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&quot;ArmTrajectory&quot;</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="ss">        Args:</span>

<span class="ss">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="ss">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="ss">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="ss">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="ss">        Returns:</span>

<span class="ss">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">slicing</span><span class="w"> </span><span class="n">indices</span><span class="vm">?</span><span class="w"> </span><span class="ow">Or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">numpy</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="n">HACK</span><span class="w"> </span><span class="err">!!!!!!!!!!!!!!!!!!!!!!</span>

<span class="w">        </span><span class="n">n_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;GETTING ARM SEGMENT: Start: {start_index}, End: {end_index}&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="n">NORMAL</span>

<span class="w">            </span><span class="err">#</span><span class="w"> </span><span class="nc">Time</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">            </span><span class="k">else</span><span class="err">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">reset_time</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">new_times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">start_index:end_index, :</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span>

<span class="w">                </span><span class="n">new_times</span><span class="p">,</span>

<span class="w">                </span><span class="n">new_key_times</span><span class="p">,</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_steps</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="nl">n_steps</span><span class="p">:</span>

<span class="w">            </span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">vstack</span><span class="p">(</span>

<span class="w">                </span><span class="o">[</span>

<span class="n">                    self.angles[start_index:, :</span><span class="o">]</span><span class="p">,</span>

<span class="w">                    </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">n_steps</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">)))</span>

<span class="w">                    </span><span class="o">*</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="p">,</span>

<span class="w">                </span><span class="err">]</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">start_index</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span><span class="w"> </span><span class="n">new_times</span><span class="p">,</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Both</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">limit</span>

<span class="w">            </span><span class="n">angles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">angles</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span>

<span class="w">                </span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">))</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">end_index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start_index</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>

<span class="w">            </span><span class="n">new_key_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">{}</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">time</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">                </span><span class="k">for</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">.</span><span class="n">items</span><span class="p">()</span><span class="err">:</span>

<span class="w">                    </span><span class="n">new_key_times</span><span class="o">[</span><span class="n">name</span><span class="o">]</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">ArmTrajectory</span><span class="p">(</span><span class="n">angles</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">joint_ids</span><span class="p">,</span><span class="w"> </span><span class="n">new_times</span><span class="p">,</span><span class="w"> </span><span class="n">new_key_times</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="get_segment_from_times">get_segment_from_times</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment_from_times</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;ArmTrajectory&#39;</span>
</code></pre></div>

<p>Construct an arm trajectory segment from a larger trajectory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_time</td>
<td>float</td>
<td>Starting time of the segment</td>
<td>None</td>
</tr>
<tr>
<td>end_time</td>
<td>float</td>
<td>Ending time of the segment</td>
<td>None</td>
</tr>
<tr>
<td>reset_time</td>
<td>bool</td>
<td>Whether to maintain the time association with the original trajectory,<br>or reset the start time back to 0. Defaults to True (reset start time back to 0)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ArmTrajectory</td>
<td>A new trajectory representing a segment of the original trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment_from_times</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="p">,</span><span class="w"> </span><span class="kd">end_</span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="n">float</span><span class="p">,</span><span class="w"> </span><span class="n">reset_time</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;ArmTrajectory&quot;</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Construct an arm trajectory segment from a larger trajectory</span>

<span class="s">        Args:</span>

<span class="s">            start_time (float): Starting time of the segment</span>

<span class="s">            end_time (float): Ending time of the segment</span>

<span class="s">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="s">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="s">        Returns:</span>

<span class="s">            ArmTrajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">)</span>

<span class="w">        </span><span class="kd">end_</span><span class="nf">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="kd">end_</span><span class="n">time</span><span class="p">)</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="kd">end_</span><span class="nf">index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="o">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Past</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nf">max</span><span class="w"> </span><span class="n">time</span><span class="p">...</span><span class="w"> </span><span class="n">somewhat</span><span class="w"> </span><span class="kr">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">HACK</span>

<span class="w">            </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

<span class="w">            </span><span class="n">time_after</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">end_</span><span class="n">time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="w">            </span><span class="kd">end_</span><span class="nf">index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">time_after</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">get_segment</span><span class="p">(</span><span class="n">start_index</span><span class="p">,</span><span class="w"> </span><span class="kd">end_</span><span class="nf">index</span><span class="p">,</span><span class="w"> </span><span class="n">reset_time</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="plot">plot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">None</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>

<span class="w">            </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_timesteps</span><span class="p">)</span>

<span class="w">            </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Timesteps&quot;</span>

<span class="w">        </span><span class="k">else</span><span class="p">:</span>

<span class="w">            </span><span class="n">x_axis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">times</span>

<span class="w">            </span><span class="n">x_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Time, s&quot;</span>

<span class="w">        </span><span class="n">n_subplots</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">)</span>

<span class="w">        </span><span class="n">subplot_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">num_subplots_to_shape</span><span class="p">(</span><span class="n">n_subplots</span><span class="p">)</span>

<span class="w">        </span><span class="n">fig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">joint_ids</span><span class="p">):</span>

<span class="w">            </span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="o">*</span><span class="n">subplot_shape</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_axis</span><span class="p">,</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">angles</span><span class="p">[:,</span><span class="w"> </span><span class="n">j</span><span class="p">])</span>

<span class="w">            </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">f</span><span class="s2">&quot;Joint {index}&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">)</span>

<span class="w">            </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Angle&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</details>
<h3 id="trajectory">Trajectory</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">Trajectory</span><span class="p">(</span>
    <span class="n">positions</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">quats</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lin_vels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ang_vels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lin_accels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ang_accels</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">times</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Trajectory class: Keeps track of a sequence of poses/velocities/accels over a period of time</p>
<ul>
<li>All arguments can be omitted as needed (for instance, a pose-only trajectory without velocities,
    or a trajectory without time information)</li>
<li>All positions/orientations/velocities... are assumed to be defined in world frame</li>
</ul>
<h4 id="attributes_1">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>positions</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of XYZ positions, shape (n, 3)</td>
<td>None</td>
</tr>
<tr>
<td>quats</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of XYZW quaternions, shape (n, 4)</td>
<td>None</td>
</tr>
<tr>
<td>lin_vels</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of (vx, vy, vz) linear velocities, shape (n, 3)</td>
<td>None</td>
</tr>
<tr>
<td>ang_vels</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of (wx, wy, wz) angular velocities, shape (n, 3)</td>
<td>None</td>
</tr>
<tr>
<td>lin_accels</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of (ax, ay, az) linear accelerations, shape (n, 3)</td>
<td>None</td>
</tr>
<tr>
<td>ang_accels</td>
<td>Optional[npt.ArrayLike]</td>
<td>Sequence of (al_x, al_y, al_z) angular accelerations, shape (n, 3)</td>
<td>None</td>
</tr>
<tr>
<td>times</td>
<td>Optional[npt.ArrayLike]</td>
<td>Times corresponding to each trajectory entry, shape (n)</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nl">Trajectory</span><span class="p">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Trajectory class: Keeps track of a sequence of poses/velocities/accels over a period of time</span>

<span class="ss">    - All arguments can be omitted as needed (for instance, a pose-only trajectory without velocities,</span>

<span class="ss">        or a trajectory without time information)</span>

<span class="ss">    - All positions/orientations/velocities... are assumed to be defined in world frame</span>

<span class="ss">    Args:</span>

<span class="ss">        positions (Optional[npt.ArrayLike]): Sequence of XYZ positions, shape (n, 3)</span>

<span class="ss">        quats (Optional[npt.ArrayLike]): Sequence of XYZW quaternions, shape (n, 4)</span>

<span class="ss">        lin_vels (Optional[npt.ArrayLike]): Sequence of (vx, vy, vz) linear velocities, shape (n, 3)</span>

<span class="ss">        ang_vels (Optional[npt.ArrayLike]): Sequence of (wx, wy, wz) angular velocities, shape (n, 3)</span>

<span class="ss">        lin_accels (Optional[npt.ArrayLike]): Sequence of (ax, ay, az) linear accelerations, shape (n, 3)</span>

<span class="ss">        ang_accels (Optional[npt.ArrayLike]): Sequence of (al_x, al_y, al_z) angular accelerations, shape (n, 3)</span>

<span class="ss">        times (Optional[npt.ArrayLike]): Times corresponding to each trajectory entry, shape (n)</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">positions</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">quats</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">lin_vels</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ang_vels</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">lin_accels</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ang_accels</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">times</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_positions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">positions</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_quats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quats</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">quats</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lin_vels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lin_vels</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ang_vels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ang_vels</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_lin_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lin_accels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">lin_accels</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_ang_accels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ang_accels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">ang_accels</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_poses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Init</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_tmats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Init</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_num_timesteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Init</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">positions</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_positions</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">quaternions</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_quats</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">linear_velocities</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">angular_velocities</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">linear_accels</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_lin_accels</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">angular_accels</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_ang_accels</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">times</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">)</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">timestep</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">num_timesteps</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">int</span><span class="err">:</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_num_timesteps</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">_num_timesteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="n">shape</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">            </span><span class="n">elif</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">                </span><span class="n">self</span><span class="p">.</span><span class="n">_num_timesteps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="n">shape</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span><span class="p">,</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="p">(</span><span class="k">None</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_num_timesteps</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">duration</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nc">float</span><span class="err">:</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">poses</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Pose array (position + xyzw quaternion), shape (n, 7)&quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_poses</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_poses</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Only</span><span class="w"> </span><span class="n">calculate</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">once</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;No position information available&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;No orientation information available&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_poses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">column_stack</span><span class="p">(</span><span class="o">[</span><span class="n">self.positions, self.quaternions</span><span class="o">]</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_poses</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">tmats</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="nl">ndarray</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Poses expressed as transformation matrices, shape (n, 4, 4)&quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_tmats</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w">     </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_tmats</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Only</span><span class="w"> </span><span class="n">calculate</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">once</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_tmats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">batched_pos_quats_to_tmats</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">poses</span><span class="p">)</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_tmats</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">contains_pos_only</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Whether the trajectory contains only position info&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">contains_orn_only</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Whether the trajectory contains only orientation info&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">contains_pos_and_orn</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Whether the trajectory contains both position and orientation info&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="nv">@property</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">is_empty</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">bool</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Whether the trajectory contains no position/orientation info&quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">.</span><span class="k">size</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">visualize</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">n</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">size</span><span class="err">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">BulletClient</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;View the trajectory in Pybullet</span>

<span class="ss">        Args:</span>

<span class="ss">            n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="ss">                Defaults to None (plot all frames)</span>

<span class="ss">            size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="ss">                with respect to the dimensions of the Astrobee)</span>

<span class="ss">            client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="ss">                (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="ss">        Returns:</span>

<span class="ss">            list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">client</span>

<span class="w">        </span><span class="n">connection_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">isConnected</span><span class="p">()</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Bring</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="n">GUI</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">connect</span><span class="p">(</span><span class="n">pybullet</span><span class="p">.</span><span class="n">GUI</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_and_orn</span><span class="p">:</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_traj</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_only</span><span class="p">:</span>

<span class="w">            </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;Trajectory only contains position info. Showing path instead&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_path</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_orn_only</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">                </span><span class="ss">&quot;Visualizing a sequence of purely orientations is not implemented yet&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Empty</span><span class="w"> </span><span class="n">trajectory</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;No trajectory information to visualize&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Disconnect</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">originally</span><span class="w"> </span><span class="n">weren</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">connected</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="k">input</span><span class="p">(</span><span class="ss">&quot;Press Enter to disconnect Pybullet&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">disconnect</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ids</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">show</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="nl">Figure</span><span class="p">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="ss">        Args:</span>

<span class="ss">            show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="ss">        Returns:</span>

<span class="ss">            Figure: Matplotlib figure containing the plots</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">plot_traj</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="nl">start_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">end_index</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="ss">&quot;Trajectory&quot;</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Construct a trajectory segment from a larger trajectory</span>

<span class="ss">        Args:</span>

<span class="ss">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="ss">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="ss">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="ss">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="ss">        Returns:</span>

<span class="ss">            Trajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nl">TODO</span><span class="p">:</span><span class="w"> </span><span class="k">add</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">slicing</span><span class="w"> </span><span class="n">indices</span><span class="vm">?</span><span class="w"> </span><span class="ow">Or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">numpy</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="nc">Time</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="k">size</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">No</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">quaternions</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">linear_velocities</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">angular_velocities</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">linear_accels</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">angular_accels</span><span class="o">[</span><span class="n">start_index:end_index</span><span class="o">]</span><span class="p">,</span>

<span class="w">            </span><span class="n">new_times</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment_between_times</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">,</span><span class="w"> </span><span class="n">end_time</span><span class="p">,</span><span class="w"> </span><span class="nl">reset_time</span><span class="p">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">start_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">start_time</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">end_index</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">times</span><span class="p">,</span><span class="w"> </span><span class="n">end_time</span><span class="p">)</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span><span class="ss">&quot;TODO&quot;</span><span class="p">)</span>
</code></pre></div>

</details>
<hr />
<h4 id="descendants">Descendants</h4>
<ul>
<li>pyastrobee.trajectories.trajectory.TrajectoryLogger</li>
</ul>
<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">angular_accels</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">angular_velocities</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">contains_orn_only</span>
</code></pre></div>

<p>Whether the trajectory contains only orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">contains_pos_and_orn</span>
</code></pre></div>

<p>Whether the trajectory contains both position and orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">contains_pos_only</span>
</code></pre></div>

<p>Whether the trajectory contains only position info</p>
<div class="codehilite"><pre><span></span><code><span class="n">duration</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">is_empty</span>
</code></pre></div>

<p>Whether the trajectory contains no position/orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">linear_accels</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">linear_velocities</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">num_timesteps</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">poses</span>
</code></pre></div>

<p>Pose array (position + xyzw quaternion), shape (n, 7)</p>
<div class="codehilite"><pre><span></span><code><span class="n">positions</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">quaternions</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">times</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">timestep</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">tmats</span>
</code></pre></div>

<p>Poses expressed as transformation matrices, shape (n, 4, 4)</p>
<h4 id="methods_1">Methods</h4>
<h4 id="get_segment_1">get_segment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Trajectory&#39;</span>
</code></pre></div>

<p>Construct a trajectory segment from a larger trajectory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_index</td>
<td>int</td>
<td>Starting index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>end_index</td>
<td>int</td>
<td>Ending index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>reset_time</td>
<td>bool</td>
<td>Whether to maintain the time association with the original trajectory,<br>or reset the start time back to 0. Defaults to True (reset start time back to 0)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trajectory</td>
<td>A new trajectory representing a segment of the original trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">start_index</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="kd">end_</span><span class="nf">index</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">reset_time</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Trajectory&quot;</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Construct a trajectory segment from a larger trajectory</span>

<span class="s">        Args:</span>

<span class="s">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="s">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="s">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="s">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="s">        Returns:</span>

<span class="s">            Trajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="o">:</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">slicing</span><span class="w"> </span><span class="n">indices</span><span class="o">?</span><span class="w"> </span><span class="kr">Or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">numpy</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">else</span><span class="o">:</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">]</span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="n">reset_time</span><span class="o">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">positions</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="n">new_times</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="get_segment_between_times">get_segment_between_times</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment_between_times</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def get_segment_between_times(self, start_time, end_time, reset_time: bool = True):

        # start_index = np.searchsorted(self.times, start_time)

        # end_index = np.searchsorted(self.times, end_time)

        raise NotImplementedError(&quot;TODO&quot;)
</code></pre></div>

</details>
<h4 id="plot_1">plot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>
</code></pre></div>

<p>Plot the trajectory components over time</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>show</td>
<td>bool</td>
<td>Whether or not to display the plot. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure</td>
<td>Matplotlib figure containing the plots</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Figure</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="s">        Args:</span>

<span class="s">            show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="s">        Returns:</span>

<span class="s">            Figure: Matplotlib figure containing the plots</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">plot_traj</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="visualize">visualize</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pybullet_utils</span><span class="o">.</span><span class="n">bullet_client</span><span class="o">.</span><span class="n">BulletClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>View the trajectory in Pybullet</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>Optional[int]</td>
<td>Number of frames to plot, if plotting all of the frames is not desired.<br>Defaults to None (plot all frames)</td>
<td>None</td>
</tr>
<tr>
<td>size</td>
<td>float</td>
<td>Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale<br>with respect to the dimensions of the Astrobee)</td>
<td>0</td>
</tr>
<tr>
<td>client</td>
<td>BulletClient</td>
<td>If connecting to multiple physics servers, include the client<br>(the class instance, not just the ID) here. Defaults to None (use default connected client)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>list[int]</td>
<td>Pybullet IDs for the lines drawn onto the GUI</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">visualize</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">n</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">size</span><span class="err">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">BulletClient</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;View the trajectory in Pybullet</span>

<span class="ss">        Args:</span>

<span class="ss">            n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="ss">                Defaults to None (plot all frames)</span>

<span class="ss">            size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="ss">                with respect to the dimensions of the Astrobee)</span>

<span class="ss">            client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="ss">                (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="ss">        Returns:</span>

<span class="ss">            list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">client</span>

<span class="w">        </span><span class="n">connection_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">isConnected</span><span class="p">()</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Bring</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="n">GUI</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">connect</span><span class="p">(</span><span class="n">pybullet</span><span class="p">.</span><span class="n">GUI</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_and_orn</span><span class="p">:</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_traj</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_only</span><span class="p">:</span>

<span class="w">            </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;Trajectory only contains position info. Showing path instead&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_path</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_orn_only</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">                </span><span class="ss">&quot;Visualizing a sequence of purely orientations is not implemented yet&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Empty</span><span class="w"> </span><span class="n">trajectory</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;No trajectory information to visualize&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Disconnect</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">originally</span><span class="w"> </span><span class="n">weren</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">connected</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="k">input</span><span class="p">(</span><span class="ss">&quot;Press Enter to disconnect Pybullet&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">disconnect</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ids</span>
</code></pre></div>

</details>
<h3 id="trajectorylogger">TrajectoryLogger</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">TrajectoryLogger</span><span class="p">(</span>

<span class="p">)</span>
</code></pre></div>

<p>Class for maintaining a history of a robot's state over time</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">TrajectoryLogger</span><span class="p">(</span><span class="n">Trajectory</span><span class="p">)</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Class for maintaining a history of a robot&#39;s state over time&quot;&quot;&quot;</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Create</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">Trajectory</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">iteratively</span><span class="w"> </span><span class="n">append</span><span class="w"> </span><span class="k">to</span>

<span class="w">        </span><span class="n">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">,</span><span class="w"> </span><span class="k">None</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">log_state</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">        </span><span class="nl">quat</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">        </span><span class="nl">lin_vel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ang_vel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">dt</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Record the robot state at a given timestep</span>

<span class="ss">        If velocity information is not available (for instance, with a softbody),</span>

<span class="ss">        we can log just the position + orientation information</span>

<span class="ss">        Args:</span>

<span class="ss">            pos (npt.ArrayLike): Current position, shape (3,)</span>

<span class="ss">            quat (npt.ArrayLike): Current orientation (XYZW quaternion), shape (4,)</span>

<span class="ss">            lin_vel (Optional[npt.ArrayLike]): Current linear velocity, shape (3,). Defaults to None.</span>

<span class="ss">            ang_vel (Optional[npt.ArrayLike]): Current angular velocity, shape (3,). Defaults to None.</span>

<span class="ss">            dt (Optional[float]): Time elapsed since the previous step. Defaults to None.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">refine</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">functionality</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="k">position</span><span class="o">/</span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">matplotlib</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">them</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Most</span><span class="w"> </span><span class="n">importantly</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">time</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="n">There</span><span class="w"> </span><span class="n">shouldn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">histories</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">lengths</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_positions</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_quats</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lin_vel</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ang_vel</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear_log</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Clears the log of all trajectory data&quot;&quot;&quot;</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_positions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_quats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
</code></pre></div>

</details>
<hr />
<h4 id="ancestors-in-mro">Ancestors (in MRO)</h4>
<ul>
<li>pyastrobee.trajectories.trajectory.Trajectory</li>
</ul>
<h4 id="instance-variables_1">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">angular_accels</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">angular_velocities</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">contains_orn_only</span>
</code></pre></div>

<p>Whether the trajectory contains only orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">contains_pos_and_orn</span>
</code></pre></div>

<p>Whether the trajectory contains both position and orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">contains_pos_only</span>
</code></pre></div>

<p>Whether the trajectory contains only position info</p>
<div class="codehilite"><pre><span></span><code><span class="n">duration</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">is_empty</span>
</code></pre></div>

<p>Whether the trajectory contains no position/orientation info</p>
<div class="codehilite"><pre><span></span><code><span class="n">linear_accels</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">linear_velocities</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">num_timesteps</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">poses</span>
</code></pre></div>

<p>Pose array (position + xyzw quaternion), shape (n, 7)</p>
<div class="codehilite"><pre><span></span><code><span class="n">positions</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">quaternions</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">times</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">timestep</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="n">tmats</span>
</code></pre></div>

<p>Poses expressed as transformation matrices, shape (n, 4, 4)</p>
<h4 id="methods_2">Methods</h4>
<h4 id="clear_log">clear_log</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">clear_log</span><span class="p">(</span>
    <span class="bp">self</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

<p>Clears the log of all trajectory data</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">clear_log</span><span class="p">(</span><span class="kr">self</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">None</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Clears the log of all trajectory data&quot;&quot;&quot;</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_positions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_quats</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>

<span class="w">        </span><span class="kr">self</span><span class="p">.</span><span class="n">_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
</code></pre></div>

</details>
<h4 id="get_segment_2">get_segment</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">end_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Trajectory&#39;</span>
</code></pre></div>

<p>Construct a trajectory segment from a larger trajectory</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>start_index</td>
<td>int</td>
<td>Starting index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>end_index</td>
<td>int</td>
<td>Ending index of the larger trajectory to extract the segment</td>
<td>None</td>
</tr>
<tr>
<td>reset_time</td>
<td>bool</td>
<td>Whether to maintain the time association with the original trajectory,<br>or reset the start time back to 0. Defaults to True (reset start time back to 0)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Trajectory</td>
<td>A new trajectory representing a segment of the original trajectory</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">get_segment</span><span class="p">(</span>

<span class="w">        </span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">start_index</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="kd">end_</span><span class="nf">index</span><span class="o">:</span><span class="w"> </span><span class="n">int</span><span class="p">,</span><span class="w"> </span><span class="n">reset_time</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Trajectory&quot;</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Construct a trajectory segment from a larger trajectory</span>

<span class="s">        Args:</span>

<span class="s">            start_index (int): Starting index of the larger trajectory to extract the segment</span>

<span class="s">            end_index (int): Ending index of the larger trajectory to extract the segment</span>

<span class="s">            reset_time (bool): Whether to maintain the time association with the original trajectory,</span>

<span class="s">                or reset the start time back to 0. Defaults to True (reset start time back to 0)</span>

<span class="s">        Returns:</span>

<span class="s">            Trajectory: A new trajectory representing a segment of the original trajectory</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="o">:</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">for</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="n">slicing</span><span class="w"> </span><span class="n">indices</span><span class="o">?</span><span class="w"> </span><span class="kr">Or</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">numpy</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">handled</span><span class="w"> </span><span class="n">differently</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">trajectory</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kr">or</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="kr">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">        </span><span class="nf">if</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">size</span><span class="p">(</span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="n">info</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">None</span>

<span class="w">        </span><span class="n">else</span><span class="o">:</span>

<span class="w">            </span><span class="n">new_times</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">self</span><span class="p">.</span><span class="n">times</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">]</span>

<span class="w">            </span><span class="nf">if</span><span class="w"> </span><span class="n">reset_time</span><span class="o">:</span>

<span class="w">                </span><span class="n">new_times</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">new_times</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">Trajectory</span><span class="p">(</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">positions</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">quaternions</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">linear_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">angular_velocities</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">linear_accels</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="kr">self</span><span class="p">.</span><span class="n">angular_accels</span><span class="p">[</span><span class="n">start_index</span><span class="o">:</span><span class="kd">end_</span><span class="nf">index</span><span class="p">],</span>

<span class="w">            </span><span class="n">new_times</span><span class="p">,</span>

<span class="w">        </span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="get_segment_between_times_1">get_segment_between_times</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">get_segment_between_times</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start_time</span><span class="p">,</span>
    <span class="n">end_time</span><span class="p">,</span>
    <span class="n">reset_time</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span>
</code></pre></div>

<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>    def get_segment_between_times(self, start_time, end_time, reset_time: bool = True):

        # start_index = np.searchsorted(self.times, start_time)

        # end_index = np.searchsorted(self.times, end_time)

        raise NotImplementedError(&quot;TODO&quot;)
</code></pre></div>

</details>
<h4 id="log_state">log_state</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">log_state</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">pos</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">quat</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">lin_vel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ang_vel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dt</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span>
</code></pre></div>

<p>Record the robot state at a given timestep</p>
<p>If velocity information is not available (for instance, with a softbody),
we can log just the position + orientation information</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>pos</td>
<td>npt.ArrayLike</td>
<td>Current position, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>quat</td>
<td>npt.ArrayLike</td>
<td>Current orientation (XYZW quaternion), shape (4,)</td>
<td>None</td>
</tr>
<tr>
<td>lin_vel</td>
<td>Optional[npt.ArrayLike]</td>
<td>Current linear velocity, shape (3,). Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>ang_vel</td>
<td>Optional[npt.ArrayLike]</td>
<td>Current angular velocity, shape (3,). Defaults to None.</td>
<td>None</td>
</tr>
<tr>
<td>dt</td>
<td>Optional[float]</td>
<td>Time elapsed since the previous step. Defaults to None.</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">log_state</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">pos</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">        </span><span class="nl">quat</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">        </span><span class="nl">lin_vel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">ang_vel</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="nl">dt</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;Record the robot state at a given timestep</span>

<span class="ss">        If velocity information is not available (for instance, with a softbody),</span>

<span class="ss">        we can log just the position + orientation information</span>

<span class="ss">        Args:</span>

<span class="ss">            pos (npt.ArrayLike): Current position, shape (3,)</span>

<span class="ss">            quat (npt.ArrayLike): Current orientation (XYZW quaternion), shape (4,)</span>

<span class="ss">            lin_vel (Optional[npt.ArrayLike]): Current linear velocity, shape (3,). Defaults to None.</span>

<span class="ss">            ang_vel (Optional[npt.ArrayLike]): Current angular velocity, shape (3,). Defaults to None.</span>

<span class="ss">            dt (Optional[float]): Time elapsed since the previous step. Defaults to None.</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">TODO</span><span class="w"> </span><span class="n">refine</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">functionality</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Can</span><span class="w"> </span><span class="nf">log</span><span class="w"> </span><span class="k">position</span><span class="o">/</span><span class="n">orientation</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">velocity</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">These</span><span class="w"> </span><span class="k">values</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">matplotlib</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="n">them</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Most</span><span class="w"> </span><span class="n">importantly</span><span class="p">,</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">want</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">things</span><span class="w"> </span><span class="n">correspond</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nc">time</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="p">(</span><span class="n">There</span><span class="w"> </span><span class="n">shouldn</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">instance</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">histories</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">lengths</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_positions</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_quats</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">quat</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_lin_vels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lin_vel</span><span class="p">)</span>

<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">_ang_vels</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">ang_vel</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">            </span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_times</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dt</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="plot_2">plot</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span>
</code></pre></div>

<p>Plot the trajectory components over time</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>show</td>
<td>bool</td>
<td>Whether or not to display the plot. Defaults to True.</td>
<td>True</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Figure</td>
<td>Matplotlib figure containing the plots</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">plot</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="o">:</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">True</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Figure</span><span class="o">:</span>

<span class="w">        </span><span class="s">&quot;&quot;&quot;Plot the trajectory components over time</span>

<span class="s">        Args:</span>

<span class="s">            show (bool, optional): Whether or not to display the plot. Defaults to True.</span>

<span class="s">        Returns:</span>

<span class="s">            Figure: Matplotlib figure containing the plots</span>

<span class="s">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="kr">return</span><span class="w"> </span><span class="n">plot_traj</span><span class="p">(</span><span class="kr">self</span><span class="p">,</span><span class="w"> </span><span class="n">show</span><span class="o">=</span><span class="n">show</span><span class="p">)</span>
</code></pre></div>

</details>
<h4 id="visualize_1">visualize</h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">client</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pybullet_utils</span><span class="o">.</span><span class="n">bullet_client</span><span class="o">.</span><span class="n">BulletClient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</code></pre></div>

<p>View the trajectory in Pybullet</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>Optional[int]</td>
<td>Number of frames to plot, if plotting all of the frames is not desired.<br>Defaults to None (plot all frames)</td>
<td>None</td>
</tr>
<tr>
<td>size</td>
<td>float</td>
<td>Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale<br>with respect to the dimensions of the Astrobee)</td>
<td>0</td>
</tr>
<tr>
<td>client</td>
<td>BulletClient</td>
<td>If connecting to multiple physics servers, include the client<br>(the class instance, not just the ID) here. Defaults to None (use default connected client)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>list[int]</td>
<td>Pybullet IDs for the lines drawn onto the GUI</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">visualize</span><span class="p">(</span>

<span class="w">        </span><span class="n">self</span><span class="p">,</span>

<span class="w">        </span><span class="nl">n</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">        </span><span class="k">size</span><span class="err">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">BulletClient</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">list</span><span class="o">[</span><span class="n">int</span><span class="o">]</span><span class="err">:</span>

<span class="w">        </span><span class="ss">&quot;&quot;&quot;View the trajectory in Pybullet</span>

<span class="ss">        Args:</span>

<span class="ss">            n (Optional[int]): Number of frames to plot, if plotting all of the frames is not desired.</span>

<span class="ss">                Defaults to None (plot all frames)</span>

<span class="ss">            size (float, optional): Length of the lines to plot for each frame. Defaults to 0.5 (this gives a good scale</span>

<span class="ss">                with respect to the dimensions of the Astrobee)</span>

<span class="ss">            client (BulletClient, optional): If connecting to multiple physics servers, include the client</span>

<span class="ss">                (the class instance, not just the ID) here. Defaults to None (use default connected client)</span>

<span class="ss">        Returns:</span>

<span class="ss">            list[int]: Pybullet IDs for the lines drawn onto the GUI</span>

<span class="ss">        &quot;&quot;&quot;</span>

<span class="w">        </span><span class="nl">client</span><span class="p">:</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">client</span>

<span class="w">        </span><span class="n">connection_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">isConnected</span><span class="p">()</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">Bring</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="n">GUI</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">needed</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">connect</span><span class="p">(</span><span class="n">pybullet</span><span class="p">.</span><span class="n">GUI</span><span class="p">)</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_and_orn</span><span class="p">:</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_traj</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="k">size</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_pos_only</span><span class="p">:</span>

<span class="w">            </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;Trajectory only contains position info. Showing path instead&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">visualize_path</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">positions</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">client</span><span class="o">=</span><span class="n">client</span><span class="p">)</span>

<span class="w">        </span><span class="n">elif</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="nl">contains_orn_only</span><span class="p">:</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">NotImplementedError</span><span class="p">(</span>

<span class="w">                </span><span class="ss">&quot;Visualizing a sequence of purely orientations is not implemented yet&quot;</span>

<span class="w">            </span><span class="p">)</span>

<span class="w">        </span><span class="k">else</span><span class="err">:</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="n">Empty</span><span class="w"> </span><span class="n">trajectory</span>

<span class="w">            </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="ss">&quot;No trajectory information to visualize&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="k">Disconnect</span><span class="w"> </span><span class="n">Pybullet</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">originally</span><span class="w"> </span><span class="n">weren</span><span class="err">&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">connected</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nl">connection_status</span><span class="p">:</span>

<span class="w">            </span><span class="k">input</span><span class="p">(</span><span class="ss">&quot;Press Enter to disconnect Pybullet&quot;</span><span class="p">)</span>

<span class="w">            </span><span class="n">client</span><span class="p">.</span><span class="k">disconnect</span><span class="p">()</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ids</span>
</code></pre></div>

</details>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        
<footer class="md-footer">
    
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../timing/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Timing" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                Timing
              </div>
            </div>
          </a>
        
        
          
          <a href="../variable_time_curves/" class="md-footer__link md-footer__link--next" aria-label="Next: Variable Time Curves" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Variable Time Curves
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
            
            Powered by
            <a href="http://timothycrosley.github.io/portray">portray.</a>
            You too can
            <a href="http://timothycrosley.github.io/portray">
              portray</a>
            your Python project well using automatic documentation.
          </div>
        
      </div>
    </div>
  </footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>