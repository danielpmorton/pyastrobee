
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../../images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.4">
    
    
      
        <title>Bezier - pyastrobee</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.80dcb947.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#module-pyastrobeetrajectoriesbezier" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="pyastrobee" class="md-header__button md-logo" aria-label="pyastrobee" data-md-component="logo">
      
  <img src="../../../../images/favicon_large.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyastrobee
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bezier
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/danielpmorton/pyastrobee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyastrobee
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="pyastrobee" class="md-nav__button md-logo" aria-label="pyastrobee" data-md-component="logo">
      
  <img src="../../../../images/favicon_large.png" alt="logo">

    </a>
    pyastrobee
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/danielpmorton/pyastrobee" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pyastrobee
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/additional_installs/" class="md-nav__link">
        Additional Installs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/bag_dynamics/" class="md-nav__link">
        Bag Dynamics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/getting_started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/loading_iss_meshes/" class="md-nav__link">
        Loading Iss Meshes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/meshing/" class="md-nav__link">
        Meshing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/nasa_sim/" class="md-nav__link">
        Nasa Sim
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/pybullet_tips/" class="md-nav__link">
        Pybullet Tips
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/references/" class="md-nav__link">
        References
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/retexturing/" class="md-nav__link">
        Retexturing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../../docs/tet_meshing/" class="md-nav__link">
        Tet Meshing
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13" type="checkbox" id="__nav_13" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1" type="checkbox" id="__nav_13_1" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1">
          Pyastrobee
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Pyastrobee" data-md-level="2">
        <label class="md-nav__title" for="__nav_13_1">
          <span class="md-nav__icon md-icon"></span>
          Pyastrobee
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1_2" type="checkbox" id="__nav_13_1_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1_2">
          Config
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Config" data-md-level="3">
        <label class="md-nav__title" for="__nav_13_1_2">
          <span class="md-nav__icon md-icon"></span>
          Config
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_geom/" class="md-nav__link">
        Astrobee Geom
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_motion/" class="md-nav__link">
        Astrobee Motion
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/astrobee_transforms/" class="md-nav__link">
        Astrobee Transforms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/bag_properties/" class="md-nav__link">
        Bag Properties
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/iss_paths/" class="md-nav__link">
        Iss Paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../config/iss_safe_boxes/" class="md-nav__link">
        Iss Safe Boxes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1_3" type="checkbox" id="__nav_13_1_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1_3">
          Control
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Control" data-md-level="3">
        <label class="md-nav__title" for="__nav_13_1_3">
          <span class="md-nav__icon md-icon"></span>
          Control
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/constraint_controller/" class="md-nav__link">
        Constraint Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/force_torque_control/" class="md-nav__link">
        Force Torque Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/keyboard_controller/" class="md-nav__link">
        Keyboard Controller
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/multi_robot/" class="md-nav__link">
        Multi Robot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/sampling_mpc/" class="md-nav__link">
        Sampling Mpc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../control/sampling_mpc_multithreaded/" class="md-nav__link">
        Sampling Mpc Multithreaded
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1_4" type="checkbox" id="__nav_13_1_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1_4">
          Core
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Core" data-md-level="3">
        <label class="md-nav__title" for="__nav_13_1_4">
          <span class="md-nav__icon md-icon"></span>
          Core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/abstract_bag/" class="md-nav__link">
        Abstract Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/astrobee/" class="md-nav__link">
        Astrobee
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/composite_bag/" class="md-nav__link">
        Composite Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/constraint_bag/" class="md-nav__link">
        Constraint Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/deformable_bag/" class="md-nav__link">
        Deformable Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/environments/" class="md-nav__link">
        Environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/hybrid_bag/" class="md-nav__link">
        Hybrid Bag
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/iss/" class="md-nav__link">
        Iss
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../core/rigid_bag/" class="md-nav__link">
        Rigid Bag
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1_5" type="checkbox" id="__nav_13_1_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1_5">
          Trajectories
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Trajectories" data-md-level="3">
        <label class="md-nav__title" for="__nav_13_1_5">
          <span class="md-nav__icon md-icon"></span>
          Trajectories
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../arm_planner/" class="md-nav__link">
        Arm Planner
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Bezier
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Bezier
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bernstein" class="md-nav__link">
    bernstein
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bezier_trajectory" class="md-nav__link">
    bezier_trajectory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beziercurve" class="md-nav__link">
    BezierCurve
  </a>
  
    <nav class="md-nav" aria-label="BezierCurve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../bezier_slerp/" class="md-nav__link">
        Bezier Slerp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../box_paths/" class="md-nav__link">
        Box Paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../curve_utils/" class="md-nav__link">
        Curve Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../decasteljau_slerp/" class="md-nav__link">
        Decasteljau Slerp
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../face_forward/" class="md-nav__link">
        Face Forward
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../multi_robot_trajs/" class="md-nav__link">
        Multi Robot Trajs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../planner/" class="md-nav__link">
        Planner
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../polynomials/" class="md-nav__link">
        Polynomials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quaternion_interpolation/" class="md-nav__link">
        Quaternion Interpolation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sampling/" class="md-nav__link">
        Sampling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../simple_trajectories/" class="md-nav__link">
        Simple Trajectories
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../splines/" class="md-nav__link">
        Splines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../timing/" class="md-nav__link">
        Timing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../trajectory/" class="md-nav__link">
        Trajectory
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../variable_time_curves/" class="md-nav__link">
        Variable Time Curves
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_13_1_6" type="checkbox" id="__nav_13_1_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_13_1_6">
          Utils
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Utils" data-md-level="3">
        <label class="md-nav__title" for="__nav_13_1_6">
          <span class="md-nav__icon md-icon"></span>
          Utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/algos/" class="md-nav__link">
        Algos
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bag_frame/" class="md-nav__link">
        Bag Frame
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/boxes/" class="md-nav__link">
        Boxes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/bullet_utils/" class="md-nav__link">
        Bullet Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/debug_visualizer/" class="md-nav__link">
        Debug Visualizer
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/dynamics/" class="md-nav__link">
        Dynamics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/errors/" class="md-nav__link">
        Errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        Index
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/math_utils/" class="md-nav__link">
        Math Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/mesh_utils/" class="md-nav__link">
        Mesh Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/poses/" class="md-nav__link">
        Poses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/python_utils/" class="md-nav__link">
        Python Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/quaternion_derivatives/" class="md-nav__link">
        Quaternion Derivatives
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/quaternions/" class="md-nav__link">
        Quaternions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/rotations/" class="md-nav__link">
        Rotations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/transformations/" class="md-nav__link">
        Transformations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/video_concatenation/" class="md-nav__link">
        Video Concatenation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    Variables
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functions" class="md-nav__link">
    Functions
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bernstein" class="md-nav__link">
    bernstein
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bezier_trajectory" class="md-nav__link">
    bezier_trajectory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#classes" class="md-nav__link">
    Classes
  </a>
  
    <nav class="md-nav" aria-label="Classes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beziercurve" class="md-nav__link">
    BezierCurve
  </a>
  
    <nav class="md-nav" aria-label="BezierCurve">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attributes" class="md-nav__link">
    Attributes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instance-variables" class="md-nav__link">
    Instance variables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/danielpmorton/pyastrobee/edit/main/reference/pyastrobee/trajectories/bezier.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="module-pyastrobeetrajectoriesbezier">Module pyastrobee.trajectories.bezier</h1>
<p>Generating trajectories using Bezier curves and Bernstein polynomials</p>
<p>When compared with polynomial trajectories, these are:
- More numerically stable during optimization
- Easier to formulate constraints on maximum velocity, acceleration, ...
- Easier to formulate cost functions (such as minimizing jerk)
- Easier to specify motions within a safe convex set</p>
<p>Imposing constraints on the curve and its derivatives:
- This is quite simple. If we have boundary conditions on position, for instance, we can constraint the start and 
  end points of the curve to our desired start/end positions.
- Likewise, the derivative of a Bezier curve is also a Bezier curve (of lower order: M-1), so we can constrain the 
  start/end points of the derivative curve to meet constraints on the derivative (velocity, for instance)
- This can be extended to higher-order derivatives, provided that the original curve is of a high-enough order
  so that the reduced-order derivative curves still have enough control points to meet the constraints.</p>
<p>Cost function:
- The squared L2 norm of a Bezier curve is a natural (convex, quadratic) choice for a cost function. If we are 
  minimizing jerk, for instance, we can use the third-derivative of a position curve with this function</p>
<p>Safe motion:
- If the free space is defined as a convex set, we can enforce that the trajectory remains within the free space by
  constraining the control points to remain in free space. Since the Bezier curve is contained within the convex hull
  of the control points, this ensures that the entire curve is in free space.</p>
<p>Stephen Boyd and Tobia Marcucci recommended using these. 
Refer to "Fast Path Planning Through Large Collections of Safe Boxes" for more info, as well as Tobia's repository
https://github.com/cvxgrp/fastpathplanning/</p>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>&quot;&quot;&quot;Generating<span class="w"> </span>trajectories<span class="w"> </span>using<span class="w"> </span>Bezier<span class="w"> </span>curves<span class="w"> </span>and<span class="w"> </span>Bernstein<span class="w"> </span>polynomials

When<span class="w"> </span>compared<span class="w"> </span>with<span class="w"> </span>polynomial<span class="w"> </span>trajectories,<span class="w"> </span>these<span class="w"> </span>are:

-<span class="w"> </span>More<span class="w"> </span>numerically<span class="w"> </span>stable<span class="w"> </span>during<span class="w"> </span>optimization

-<span class="w"> </span>Easier<span class="w"> </span>to<span class="w"> </span>formulate<span class="w"> </span>constraints<span class="w"> </span>on<span class="w"> </span>maximum<span class="w"> </span>velocity,<span class="w"> </span>acceleration,<span class="w"> </span>...

-<span class="w"> </span>Easier<span class="w"> </span>to<span class="w"> </span>formulate<span class="w"> </span>cost<span class="w"> </span>functions<span class="w"> </span>(such<span class="w"> </span>as<span class="w"> </span>minimizing<span class="w"> </span>jerk)

-<span class="w"> </span>Easier<span class="w"> </span>to<span class="w"> </span>specify<span class="w"> </span>motions<span class="w"> </span>within<span class="w"> </span>a<span class="w"> </span>safe<span class="w"> </span>convex<span class="w"> </span>set

Imposing<span class="w"> </span>constraints<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>derivatives:

-<span class="w"> </span>This<span class="w"> </span>is<span class="w"> </span>quite<span class="w"> </span>simple.<span class="w"> </span>If<span class="w"> </span>we<span class="w"> </span>have<span class="w"> </span>boundary<span class="w"> </span>conditions<span class="w"> </span>on<span class="w"> </span>position,<span class="w"> </span>for<span class="w"> </span>instance,<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>constraint<span class="w"> </span>the<span class="w"> </span>start<span class="w"> </span>and

<span class="w">  </span>end<span class="w"> </span>points<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>to<span class="w"> </span>our<span class="w"> </span>desired<span class="w"> </span>start/end<span class="w"> </span>positions.

-<span class="w"> </span>Likewise,<span class="w"> </span>the<span class="w"> </span>derivative<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>also<span class="w"> </span>a<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>(of<span class="w"> </span>lower<span class="w"> </span>order:<span class="w"> </span>M-1),<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>constrain<span class="w"> </span>the

<span class="w">  </span>start/end<span class="w"> </span>points<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>derivative<span class="w"> </span>curve<span class="w"> </span>to<span class="w"> </span>meet<span class="w"> </span>constraints<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>derivative<span class="w"> </span>(velocity,<span class="w"> </span>for<span class="w"> </span>instance)

-<span class="w"> </span>This<span class="w"> </span>can<span class="w"> </span>be<span class="w"> </span>extended<span class="w"> </span>to<span class="w"> </span>higher-order<span class="w"> </span>derivatives,<span class="w"> </span>provided<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>original<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>high-enough<span class="w"> </span>order

<span class="w">  </span>so<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>reduced-order<span class="w"> </span>derivative<span class="w"> </span>curves<span class="w"> </span>still<span class="w"> </span>have<span class="w"> </span>enough<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>to<span class="w"> </span>meet<span class="w"> </span>the<span class="w"> </span>constraints.

Cost<span class="w"> </span>function:

-<span class="w"> </span>The<span class="w"> </span>squared<span class="w"> </span>L2<span class="w"> </span>norm<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>natural<span class="w"> </span>(convex,<span class="w"> </span>quadratic)<span class="w"> </span>choice<span class="w"> </span>for<span class="w"> </span>a<span class="w"> </span>cost<span class="w"> </span>function.<span class="w"> </span>If<span class="w"> </span>we<span class="w"> </span>are

<span class="w">  </span>minimizing<span class="w"> </span>jerk,<span class="w"> </span>for<span class="w"> </span>instance,<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>use<span class="w"> </span>the<span class="w"> </span>third-derivative<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>position<span class="w"> </span>curve<span class="w"> </span>with<span class="w"> </span>this<span class="w"> </span>function

Safe<span class="w"> </span>motion:

-<span class="w"> </span>If<span class="w"> </span>the<span class="w"> </span>free<span class="w"> </span>space<span class="w"> </span>is<span class="w"> </span>defined<span class="w"> </span>as<span class="w"> </span>a<span class="w"> </span>convex<span class="w"> </span>set,<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>enforce<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>trajectory<span class="w"> </span>remains<span class="w"> </span>within<span class="w"> </span>the<span class="w"> </span>free<span class="w"> </span>space<span class="w"> </span>by

<span class="w">  </span>constraining<span class="w"> </span>the<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>to<span class="w"> </span>remain<span class="w"> </span>in<span class="w"> </span>free<span class="w"> </span>space.<span class="w"> </span>Since<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>contained<span class="w"> </span>within<span class="w"> </span>the<span class="w"> </span>convex<span class="w"> </span>hull

<span class="w">  </span>of<span class="w"> </span>the<span class="w"> </span>control<span class="w"> </span>points,<span class="w"> </span>this<span class="w"> </span>ensures<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>entire<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>in<span class="w"> </span>free<span class="w"> </span>space.

Stephen<span class="w"> </span>Boyd<span class="w"> </span>and<span class="w"> </span>Tobia<span class="w"> </span>Marcucci<span class="w"> </span>recommended<span class="w"> </span>using<span class="w"> </span>these.

Refer<span class="w"> </span>to<span class="w"> </span>&quot;Fast<span class="w"> </span>Path<span class="w"> </span>Planning<span class="w"> </span>Through<span class="w"> </span>Large<span class="w"> </span>Collections<span class="w"> </span>of<span class="w"> </span>Safe<span class="w"> </span>Boxes&quot;<span class="w"> </span>for<span class="w"> </span>more<span class="w"> </span>info,<span class="w"> </span>as<span class="w"> </span>well<span class="w"> </span>as<span class="w"> </span>Tobia&#39;s<span class="w"> </span>repository

https://github.com/cvxgrp/fastpathplanning/

&quot;&quot;&quot;

#<span class="w"> </span>TODO

#<span class="w"> </span>-<span class="w"> </span>The<span class="w"> </span>L2<span class="w"> </span>squared<span class="w"> </span>metric<span class="w"> </span>seems<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>nonconvex<span class="w"> </span>if<span class="w"> </span>the<span class="w"> </span>total<span class="w"> </span>duration<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>is<span class="w"> </span>also<span class="w"> </span>an<span class="w"> </span>optimization<span class="w"> </span>variable...

#<span class="w">   </span>See<span class="w"> </span>if<span class="w"> </span>there<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>better<span class="w"> </span>way<span class="w"> </span>to<span class="w"> </span>formulate<span class="w"> </span>this

from<span class="w"> </span>typing<span class="w"> </span>import<span class="w"> </span>Optional,<span class="w"> </span>Union

import<span class="w"> </span>numpy<span class="w"> </span>as<span class="w"> </span>np

import<span class="w"> </span>numpy.typing<span class="w"> </span>as<span class="w"> </span>npt

import<span class="w"> </span>cvxpy<span class="w"> </span>as<span class="w"> </span>cp

from<span class="w"> </span>scipy.special<span class="w"> </span>import<span class="w"> </span>binom

import<span class="w"> </span>matplotlib.pyplot<span class="w"> </span>as<span class="w"> </span>plt

from<span class="w"> </span>pyastrobee.utils.boxes<span class="w"> </span>import<span class="w"> </span>Box

from<span class="w"> </span>pyastrobee.utils.errors<span class="w"> </span>import<span class="w"> </span>OptimizationError

class<span class="w"> </span>BezierCurve:

<span class="w">    </span>&quot;&quot;&quot;Bezier<span class="w"> </span>curve<span class="w"> </span>class<span class="w"> </span>for<span class="w"> </span>evaluating<span class="w"> </span>a<span class="w"> </span>curve,<span class="w"> </span>the<span class="w"> </span>basis<span class="w"> </span>polynomials,<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>derivative

<span class="w">    </span>To<span class="w"> </span>evaluate<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>at<span class="w"> </span>points<span class="w"> </span>t,<span class="w"> </span>call<span class="w"> </span>it<span class="w"> </span>with<span class="w"> </span>curve(t)

<span class="w">    </span>On<span class="w"> </span>initialization,<span class="w"> </span>for<span class="w"> </span>a<span class="w"> </span>standard<span class="w"> </span>&quot;unit-time&quot;<span class="w"> </span>curve,<span class="w"> </span>set<span class="w"> </span>a<span class="w"> </span>=<span class="w"> </span>0<span class="w"> </span>and<span class="w"> </span>b<span class="w"> </span>=<span class="w"> </span>1

<span class="w">    </span>Args:

<span class="w">        </span>points<span class="w"> </span>(Union[cp.Variable,<span class="w"> </span>cp.Expression,<span class="w"> </span>np.ndarray]):<span class="w"> </span>Control<span class="w"> </span>points,<span class="w"> </span>or<span class="w"> </span>a<span class="w"> </span>cvxpy<span class="w"> </span>Variable/Expression<span class="w"> </span>of<span class="w"> </span>the

<span class="w">            </span>control<span class="w"> </span>points.<span class="w"> </span>Shape<span class="w"> </span>(n_pts,<span class="w"> </span>dimension)

<span class="w">        </span>a<span class="w"> </span>(float):<span class="w"> </span>Lower<span class="w"> </span>limit<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>interval

<span class="w">        </span>b<span class="w"> </span>(Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]):<span class="w"> </span>Upper<span class="w"> </span>limit<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>interval.<span class="w"> </span>Variable<span class="w"> </span>if<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>also

<span class="w">            </span>optimizing<span class="w"> </span>the<span class="w"> </span>duration<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve

<span class="w">    </span>&quot;&quot;&quot;

<span class="w">    </span>def<span class="w"> </span>__init__(

<span class="w">        </span>self,

<span class="w">        </span>points:<span class="w"> </span>Union[cp.Variable,<span class="w"> </span>cp.Expression,<span class="w"> </span>np.ndarray],

<span class="w">        </span>a:<span class="w"> </span>float,

<span class="w">        </span>b:<span class="w"> </span>Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression],

<span class="w">    </span>):

<span class="w">        </span>if<span class="w"> </span>not<span class="w"> </span>isinstance(b,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression))<span class="w"> </span>and<span class="w"> </span>b<span class="w"> </span><span class="nt">&lt; a:</span>

<span class="w">            </span><span class="err">raise</span><span class="w"> </span><span class="err">ValueError(f&quot;Invalid</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limits:</span><span class="w"> </span><span class="err">({a},</span><span class="w"> </span><span class="err">{b})&quot;)</span>

<span class="w">        </span><span class="na">self.points =</span><span class="w"> </span><span class="s">points</span>

<span class="w">        </span><span class="na">self.h =</span><span class="w"> </span><span class="s">points.shape[0]</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">1</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Degree</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">curve</span><span class="w"> </span><span class="err">(AKA</span><span class="w"> </span><span class="err">M</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Tobia&#39;s</span><span class="w"> </span><span class="err">paper)</span>

<span class="w">        </span><span class="na">self.d =</span><span class="w"> </span><span class="s">points.shape[1]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Dimension</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">space</span>

<span class="w">        </span><span class="na">self.a =</span><span class="w"> </span><span class="s">a</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Lower</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limit</span>

<span class="w">        </span><span class="na">self.b =</span><span class="w"> </span><span class="s">b</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Upper</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limit</span>

<span class="w">        </span><span class="na">self.duration =</span><span class="w"> </span><span class="s">b</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">a</span>

<span class="w">    </span><span class="err">def</span><span class="w"> </span><span class="err">__call__(self,</span><span class="w"> </span><span class="err">t:</span><span class="w"> </span><span class="err">Union[float,</span><span class="w"> </span><span class="err">npt.ArrayLike])</span><span class="w"> </span><span class="err">-</span><span class="nt">&gt;</span><span class="w"> </span>np.ndarray:

<span class="w">        </span>&quot;&quot;&quot;Evaluates<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>(a<span class="w"> </span>sum<span class="w"> </span>of<span class="w"> </span>Bernstein<span class="w"> </span>polynomials)<span class="w"> </span>at<span class="w"> </span>specified<span class="w"> </span>points

<span class="w">        </span>Args:

<span class="w">            </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>points<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">        </span>Returns:

<span class="w">            </span>np.ndarray:<span class="w"> </span>Points<span class="w"> </span>along<span class="w"> </span>the<span class="w"> </span>curve,<span class="w"> </span>shape<span class="w"> </span>(n_pts,<span class="w"> </span>dimension)

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>c<span class="w"> </span>=<span class="w"> </span>np.array([self._bernstein(t,<span class="w"> </span>n)<span class="w"> </span>for<span class="w"> </span>n<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1)])

<span class="w">        </span>return<span class="w"> </span>c.T<span class="w"> </span>@<span class="w"> </span>self.points

<span class="w">    </span>def<span class="w"> </span>_bernstein(self,<span class="w"> </span>t:<span class="w"> </span>Union[float,<span class="w"> </span>npt.ArrayLike],<span class="w"> </span>n:<span class="w"> </span>int)<span class="w"> </span>-&gt;<span class="w"> </span>npt.ArrayLike:

<span class="w">        </span>&quot;&quot;&quot;Wrapper<span class="w"> </span>around<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>function,<span class="w"> </span>using<span class="w"> </span>attributes<span class="w"> </span>of<span class="w"> </span>self@BezierCurve

<span class="w">        </span>Args:

<span class="w">            </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>point(s)<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">            </span>n<span class="w"> </span>(int):<span class="w"> </span>Index<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial

<span class="w">        </span>Returns:

<span class="w">            </span>npt.ArrayLike:<span class="w"> </span>Evaluation(s)<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>bernstein<span class="w"> </span>polynomial<span class="w"> </span>at<span class="w"> </span>point(s)<span class="w"> </span>t.<span class="w"> </span>Returns<span class="w"> </span>a<span class="w"> </span>float<span class="w"> </span>if<span class="w"> </span>t<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>float,

<span class="w">                </span>otherwise<span class="w"> </span>will<span class="w"> </span>return<span class="w"> </span>an<span class="w"> </span>array<span class="w"> </span>of<span class="w"> </span>evaluations

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>bernstein(self.h,<span class="w"> </span>n,<span class="w"> </span>self.a,<span class="w"> </span>self.b,<span class="w"> </span>t)

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>start_point(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[np.ndarray,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Starting<span class="w"> </span>control<span class="w"> </span>point<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>self.points[0]

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>end_point(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[np.ndarray,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Ending<span class="w"> </span>control<span class="w"> </span>point<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>self.points[-1]

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>derivative(self)<span class="w"> </span>-&gt;<span class="w"> </span>&quot;BezierCurve&quot;:

<span class="w">        </span>&quot;&quot;&quot;Derivative<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>(A<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>h-1)&quot;&quot;&quot;

<span class="w">        </span>if<span class="w"> </span>isinstance(self.duration,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>points<span class="w"> </span>=<span class="w"> </span>(

<span class="w">                </span>(self.points[1:]<span class="w"> </span>-<span class="w"> </span>self.points[:-1])

<span class="w">                </span>*<span class="w"> </span>self.h

<span class="w">                </span>*<span class="w"> </span>cp.inv_pos(self.duration)

<span class="w">            </span>)

<span class="w">        </span>else:

<span class="w">            </span>points<span class="w"> </span>=<span class="w"> </span>(self.points[1:]<span class="w"> </span>-<span class="w"> </span>self.points[:-1])<span class="w"> </span>*<span class="w"> </span>(self.h<span class="w"> </span>/<span class="w"> </span>self.duration)

<span class="w">        </span>return<span class="w"> </span>BezierCurve(points,<span class="w"> </span>self.a,<span class="w"> </span>self.b)

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>l2_squared(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[float,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Squared<span class="w"> </span>L2<span class="w"> </span>norm<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>A<span class="w"> </span>=<span class="w"> </span>np.zeros((self.h<span class="w"> </span>+<span class="w"> </span>1,<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1))

<span class="w">        </span>for<span class="w"> </span>m<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1):

<span class="w">            </span>for<span class="w"> </span>n<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1):

<span class="w">                </span>A[m,<span class="w"> </span>n]<span class="w"> </span>=<span class="w"> </span>binom(self.h,<span class="w"> </span>m)<span class="w"> </span>*<span class="w"> </span>binom(self.h,<span class="w"> </span>n)<span class="w"> </span>/<span class="w"> </span>binom(2<span class="w"> </span>*<span class="w"> </span>self.h,<span class="w"> </span>m<span class="w"> </span>+<span class="w"> </span>n)

<span class="w">        </span>if<span class="w"> </span>isinstance(self.duration,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>cp.multiply(A,<span class="w"> </span>self.duration<span class="w"> </span>/<span class="w"> </span>(2<span class="w"> </span>*<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1))

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>cp.kron(A,<span class="w"> </span>np.eye(self.d))

<span class="w">        </span>else:

<span class="w">            </span>A<span class="w"> </span>*=<span class="w"> </span>self.duration<span class="w"> </span>/<span class="w"> </span>(2<span class="w"> </span>*<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1)

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>np.kron(A,<span class="w"> </span>np.eye(self.d))

<span class="w">        </span>if<span class="w"> </span>isinstance(self.points,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>#<span class="w"> </span>Note:<span class="w"> </span>CVXPY<span class="w"> </span>flattens<span class="w"> </span>matrices<span class="w"> </span>by<span class="w"> </span>columns<span class="w"> </span>rather<span class="w"> </span>than<span class="w"> </span>rows<span class="w"> </span>(opposite<span class="w"> </span>of<span class="w"> </span>numpy)

<span class="w">            </span>#<span class="w"> </span>So,<span class="w"> </span>flatten<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>transpose<span class="w"> </span>to<span class="w"> </span>make<span class="w"> </span>the<span class="w"> </span>math<span class="w"> </span>consistent

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.T.flatten()

<span class="w">            </span>return<span class="w"> </span>cp.quad_form(p,<span class="w"> </span>cp.psd_wrap(A))

<span class="w">        </span>elif<span class="w"> </span>isinstance(A,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.flatten()

<span class="w">            </span>return<span class="w"> </span>cp.quad_form(p,<span class="w"> </span>cp.psd_wrap(A))

<span class="w">        </span>else:<span class="w">  </span>#<span class="w"> </span>Numpy

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.flatten()

<span class="w">            </span>return<span class="w"> </span>p.dot(A.dot(p))

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>control_points_pathlength(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[float,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Sum<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>distances<span class="w"> </span>between<span class="w"> </span>consecutive<span class="w"> </span>control<span class="w"> </span>points

<span class="w">        </span>This<span class="w"> </span>is<span class="w"> </span>an<span class="w"> </span>upper<span class="w"> </span>bound<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>length<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>itself,<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>use<span class="w"> </span>this<span class="w"> </span>in<span class="w"> </span>a<span class="w"> </span>cost<span class="w"> </span>function

<span class="w">        </span>if<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>minimize<span class="w"> </span>the<span class="w"> </span>pathlength<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>trajectory

<span class="w">        </span>Returns:

<span class="w">            </span>Union[float,<span class="w"> </span>cp.Expression]:<span class="w"> </span>Float<span class="w"> </span>if<span class="w"> </span>the<span class="w"> </span>points<span class="w"> </span>are<span class="w"> </span>a<span class="w"> </span>numpy<span class="w"> </span>array,<span class="w"> </span>otherwise<span class="w"> </span>yields

<span class="w">                </span>a<span class="w"> </span>(convex,<span class="w"> </span>nonnegative)<span class="w"> </span>expression<span class="w"> </span>for<span class="w"> </span>this<span class="w"> </span>length

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>if<span class="w"> </span>isinstance(self.points,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>length<span class="w"> </span>=<span class="w"> </span>0

<span class="w">            </span>for<span class="w"> </span>i<span class="w"> </span>in<span class="w"> </span>range(self.h):

<span class="w">                </span>length<span class="w"> </span>+=<span class="w"> </span>cp.norm2(self.points[i<span class="w"> </span>+<span class="w"> </span>1]<span class="w"> </span>-<span class="w"> </span>self.points[i])

<span class="w">            </span>return<span class="w"> </span>length

<span class="w">        </span>else:

<span class="w">            </span>return<span class="w"> </span>np.sum(np.linalg.norm(np.gradient(self.points,<span class="w"> </span>axis=0),<span class="w"> </span>axis=1))

def<span class="w"> </span>bernstein(

<span class="w">    </span>h:<span class="w"> </span>int,

<span class="w">    </span>n:<span class="w"> </span>int,

<span class="w">    </span>a:<span class="w"> </span>float,

<span class="w">    </span>b:<span class="w"> </span>Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression],

<span class="w">    </span>t:<span class="w"> </span>Union[float,<span class="w"> </span>npt.ArrayLike],

)<span class="w"> </span>-&gt;<span class="w"> </span>npt.ArrayLike:

<span class="w">    </span>&quot;&quot;&quot;Evaluate<span class="w"> </span>the<span class="w"> </span>nth<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>h<span class="w"> </span>at<span class="w"> </span>a<span class="w"> </span>point<span class="w"> </span>(points)<span class="w"> </span>t

<span class="w">    </span>Args:

<span class="w">        </span>h<span class="w"> </span>(int):<span class="w"> </span>Degree<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>basis

<span class="w">        </span>n<span class="w"> </span>(int):<span class="w"> </span>Index<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial

<span class="w">        </span>a<span class="w"> </span>(float):<span class="w"> </span>Interval<span class="w"> </span>minimum<span class="w"> </span>value<span class="w"> </span>(e.g.<span class="w"> </span>starting<span class="w"> </span>time<span class="w"> </span>of<span class="w"> </span>trajectory)

<span class="w">        </span>b<span class="w"> </span>(float):<span class="w"> </span>Interval<span class="w"> </span>maximum<span class="w"> </span>value<span class="w"> </span>(e.g.<span class="w"> </span>ending<span class="w"> </span>time<span class="w"> </span>of<span class="w"> </span>trajectory)

<span class="w">        </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>point(s)<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">    </span>Returns:

<span class="w">        </span>npt.ArrayLike:<span class="w"> </span>Evaluation(s)<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>at<span class="w"> </span>point(s)<span class="w"> </span>t.<span class="w"> </span>Returns<span class="w"> </span>a<span class="w"> </span>float<span class="w"> </span>if<span class="w"> </span>t<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>float,

<span class="w">            </span>otherwise<span class="w"> </span>will<span class="w"> </span>return<span class="w"> </span>an<span class="w"> </span>array<span class="w"> </span>of<span class="w"> </span>evaluations

<span class="w">    </span>&quot;&quot;&quot;

<span class="w">    </span>if<span class="w"> </span>n<span class="w"> </span>&gt;<span class="w"> </span>h:

<span class="w">        </span>raise<span class="w"> </span>ValueError(

<span class="w">            </span>&quot;Bernstein<span class="w"> </span>polynomial<span class="w"> </span>index<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>larger<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>degree<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>basis&quot;

<span class="w">        </span>)

<span class="w">    </span>if<span class="w"> </span>np.ndim(t)<span class="w"> </span>&gt;=<span class="w"> </span>0:

<span class="w">        </span>t<span class="w"> </span>=<span class="w"> </span>np.asarray(t)

<span class="w">    </span>if<span class="w"> </span>not<span class="w"> </span>isinstance(b,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">        </span>if<span class="w"> </span>b<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>a:

<span class="w">            </span>raise<span class="w"> </span>ValueError(f&quot;Invalid<span class="w"> </span>interval<span class="w"> </span>limits:<span class="w"> </span>({a},<span class="w"> </span>{b})&quot;)

<span class="w">        </span>if<span class="w"> </span>not<span class="w"> </span>(np.all(a<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>t)<span class="w"> </span>and<span class="w"> </span>np.all(t<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>b)):

<span class="w">            </span>raise<span class="w"> </span>ValueError(

<span class="w">                </span>&quot;Cannot<span class="w"> </span>evaluate<span class="w"> </span>at<span class="w"> </span>points<span class="w"> </span>outside<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>interval&quot;

<span class="w">            </span>)

<span class="w">    </span>return<span class="w"> </span>binom(h,<span class="w"> </span>n)<span class="w"> </span>*<span class="w"> </span>((t<span class="w"> </span>-<span class="w"> </span>a)<span class="w"> </span>/<span class="w"> </span>(b<span class="w"> </span>-<span class="w"> </span>a))<span class="w"> </span>**<span class="w"> </span>n<span class="w"> </span>*<span class="w"> </span>((b<span class="w"> </span>-<span class="w"> </span>t)<span class="w"> </span>/<span class="w"> </span>(b<span class="w"> </span>-<span class="w"> </span>a))<span class="w"> </span>**<span class="w"> </span>(h<span class="w"> </span>-<span class="w"> </span>n)

def<span class="w"> </span>bezier_trajectory(

<span class="w">    </span>p0:<span class="w"> </span>npt.ArrayLike,

<span class="w">    </span>pf:<span class="w"> </span>npt.ArrayLike,

<span class="w">    </span>t0:<span class="w"> </span>float,

<span class="w">    </span>tf:<span class="w"> </span>float,

<span class="w">    </span>n_control_pts:<span class="w"> </span>int,

<span class="w">    </span>v0:<span class="w"> </span>Optional[npt.ArrayLike]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>vf:<span class="w"> </span>Optional[npt.ArrayLike]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>a0:<span class="w"> </span>Optional[npt.ArrayLike]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>af:<span class="w"> </span>Optional[npt.ArrayLike]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>box:<span class="w"> </span>Optional[Box]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>v_max:<span class="w"> </span>Optional[float]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>a_max:<span class="w"> </span>Optional[float]<span class="w"> </span>=<span class="w"> </span>None,

<span class="w">    </span>time_weight:<span class="w"> </span>float<span class="w"> </span>=<span class="w"> </span>0,

)<span class="w"> </span>-&gt;<span class="w"> </span>tuple[BezierCurve,<span class="w"> </span>float]:

<span class="w">    </span>&quot;&quot;&quot;Evaluate<span class="w"> </span>an<span class="w"> </span>optimal<span class="w"> </span>min-jerk<span class="w"> </span>trajectory<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>Bezier<span class="w"> </span>curves<span class="w"> </span>which<span class="w"> </span>meets<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>constraints

<span class="w">    </span>Args:

<span class="w">        </span>p0<span class="w"> </span>(npt.ArrayLike):<span class="w"> </span>Initial<span class="w"> </span>position,<span class="w"> </span>shape<span class="w"> </span>(3,)

<span class="w">        </span>pf<span class="w"> </span>(npt.ArrayLike):<span class="w"> </span>Final<span class="w"> </span>position,<span class="w"> </span>shape<span class="w"> </span>(3,)

<span class="w">        </span>t0<span class="w"> </span>(float):<span class="w"> </span>Starting<span class="w"> </span>time

<span class="w">        </span>tf<span class="w"> </span>(float):<span class="w"> </span>Ending<span class="w"> </span>time

<span class="w">        </span>n_control_pts<span class="w"> </span>(int):<span class="w"> </span>Number<span class="w"> </span>of<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve.<span class="w"> </span>Must<span class="w"> </span>be<span class="w"> </span>&gt;=<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>constraints,

<span class="w">            </span>and<span class="w"> </span>should<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>too<span class="w"> </span>large<span class="w"> </span>(&gt;15ish)<span class="w"> </span>as<span class="w"> </span>this<span class="w"> </span>can<span class="w"> </span>reduce<span class="w"> </span>optimization<span class="w"> </span>performance.<span class="w"> </span>6-10<span class="w"> </span>is<span class="w"> </span>usually<span class="w"> </span>good

<span class="w">        </span>v0<span class="w"> </span>(Optional[npt.ArrayLike]):<span class="w"> </span>Initial<span class="w"> </span>velocity,<span class="w"> </span>shape<span class="w"> </span>(3,).<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>vf<span class="w"> </span>(Optional[npt.ArrayLike]):<span class="w"> </span>Final<span class="w"> </span>velocity,<span class="w"> </span>shape<span class="w"> </span>(3,).<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>a0<span class="w"> </span>(Optional[npt.ArrayLike]):<span class="w"> </span>Initial<span class="w"> </span>acceleration,<span class="w"> </span>shape<span class="w"> </span>(3,).<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>af<span class="w"> </span>(Optional[npt.ArrayLike]):<span class="w"> </span>Final<span class="w"> </span>acceleration,<span class="w"> </span>shape<span class="w"> </span>(3,).<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>box<span class="w"> </span>(Optional[Box]):<span class="w"> </span>Box<span class="w"> </span>constraint<span class="w"> </span>on<span class="w"> </span>(lower,<span class="w"> </span>upper)<span class="w"> </span>position<span class="w"> </span>bounds.<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>v_max<span class="w"> </span>(Optional[float]):<span class="w"> </span>Maximum<span class="w"> </span>L2<span class="w"> </span>norm<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>velocity.<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>a_max<span class="w"> </span>(Optional[float]):<span class="w"> </span>Maximum<span class="w"> </span>L2<span class="w"> </span>norm<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>acceleration.<span class="w"> </span>Defaults<span class="w"> </span>to<span class="w"> </span>None<span class="w"> </span>(unconstrained)

<span class="w">        </span>time_weight<span class="w"> </span>(float,<span class="w"> </span>optional):<span class="w"> </span>Objective<span class="w"> </span>function<span class="w"> </span>weight<span class="w"> </span>corresponding<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>linear<span class="w"> </span>penalty<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>duration.

<span class="w">            </span>Defaults<span class="w"> </span>to<span class="w"> </span>0<span class="w"> </span>(minimize<span class="w"> </span>jerk<span class="w"> </span>only).<span class="w"> </span>Note:<span class="w"> </span>this<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>&gt;<span class="w"> </span>0<span class="w"> </span>if<span class="w"> </span>evaluating<span class="w"> </span>the<span class="w"> </span>free-final-time<span class="w"> </span>case

<span class="w">    </span>Raises:

<span class="w">        </span>OptimizationError:<span class="w"> </span>If<span class="w"> </span>the<span class="w"> </span>optimization<span class="w"> </span>failed<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>a<span class="w"> </span>valid<span class="w"> </span>solution<span class="w"> </span>(typically<span class="w"> </span>this<span class="w"> </span>is<span class="w"> </span>due<span class="w"> </span>to<span class="w"> </span>constraints

<span class="w">            </span>which<span class="w"> </span>are<span class="w"> </span>too<span class="w"> </span>restrictive)

<span class="w">    </span>Returns:

<span class="w">        </span>tuple[BezierCurve,<span class="w"> </span>float]:

<span class="w">            </span>BezierCurve:<span class="w"> </span>The<span class="w"> </span>optimal<span class="w"> </span>curve<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>position<span class="w"> </span>component<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>trajectory.<span class="w"> </span>Note:<span class="w"> </span>derivatives

<span class="w">                </span>can<span class="w"> </span>be<span class="w"> </span>evaluated<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>curve.derivative<span class="w"> </span>property

<span class="w">            </span>float:<span class="w"> </span>The<span class="w"> </span>optimal<span class="w"> </span>cost<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>objective<span class="w"> </span>function

<span class="w">    </span>&quot;&quot;&quot;

<span class="w">    </span>#<span class="w"> </span>Check<span class="w"> </span>inputs

<span class="w">    </span>n_constraints<span class="w"> </span>=<span class="w"> </span>sum(c<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None<span class="w"> </span>for<span class="w"> </span>c<span class="w"> </span>in<span class="w"> </span>[p0,<span class="w"> </span>pf,<span class="w"> </span>v0,<span class="w"> </span>vf,<span class="w"> </span>a0,<span class="w"> </span>af])

<span class="w">    </span>if<span class="w"> </span>n_constraints<span class="w"> </span>&gt;<span class="w"> </span>n_control_pts:

<span class="w">        </span>raise<span class="w"> </span>ValueError(

<span class="w">            </span>&quot;Number<span class="w"> </span>of<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>at<span class="w"> </span>least<span class="w"> </span>the<span class="w"> </span>number<span class="w"> </span>of<span class="w"> </span>constraints&quot;

<span class="w">        </span>)

<span class="w">    </span>if<span class="w"> </span>tf<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>t0:

<span class="w">        </span>raise<span class="w"> </span>ValueError(f&quot;Invalid<span class="w"> </span>time<span class="w"> </span>interval:<span class="w"> </span>({t0},<span class="w"> </span>{tf})&quot;)

<span class="w">    </span>dim<span class="w"> </span>=<span class="w"> </span>len(p0)

<span class="w">    </span>#<span class="w"> </span>Form<span class="w"> </span>the<span class="w"> </span>main<span class="w"> </span>Variable<span class="w"> </span>(the<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>position<span class="w"> </span>curve)<span class="w"> </span>and<span class="w"> </span>get<span class="w"> </span>the<span class="w"> </span>Expressions

<span class="w">    </span>#<span class="w"> </span>for<span class="w"> </span>the<span class="w"> </span>control<span class="w"> </span>points<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>derivative<span class="w"> </span>curves

<span class="w">    </span>pos_pts<span class="w"> </span>=<span class="w"> </span>cp.Variable((n_control_pts,<span class="w"> </span>dim))

<span class="w">    </span>pos_curve<span class="w"> </span>=<span class="w"> </span>BezierCurve(pos_pts,<span class="w"> </span>t0,<span class="w"> </span>tf)

<span class="w">    </span>vel_curve<span class="w"> </span>=<span class="w"> </span>pos_curve.derivative

<span class="w">    </span>vel_pts<span class="w"> </span>=<span class="w"> </span>vel_curve.points

<span class="w">    </span>accel_curve<span class="w"> </span>=<span class="w"> </span>vel_curve.derivative

<span class="w">    </span>accel_pts<span class="w"> </span>=<span class="w"> </span>accel_curve.points

<span class="w">    </span>jerk_curve<span class="w"> </span>=<span class="w"> </span>accel_curve.derivative

<span class="w">    </span>#<span class="w"> </span>Form<span class="w"> </span>the<span class="w"> </span>constraint<span class="w"> </span>list<span class="w"> </span>depending<span class="w"> </span>on<span class="w"> </span>what<span class="w"> </span>was<span class="w"> </span>specified<span class="w"> </span>in<span class="w"> </span>the<span class="w"> </span>inputs

<span class="w">    </span>constraints<span class="w"> </span>=<span class="w"> </span>[pos_pts[0]<span class="w"> </span>==<span class="w"> </span>p0,<span class="w"> </span>pos_pts[-1]<span class="w"> </span>==<span class="w"> </span>pf]

<span class="w">    </span>if<span class="w"> </span>v0<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(vel_pts[0]<span class="w"> </span>==<span class="w"> </span>v0)

<span class="w">    </span>if<span class="w"> </span>vf<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(vel_pts[-1]<span class="w"> </span>==<span class="w"> </span>vf)

<span class="w">    </span>if<span class="w"> </span>a0<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(accel_pts[0]<span class="w"> </span>==<span class="w"> </span>a0)

<span class="w">    </span>if<span class="w"> </span>af<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(accel_pts[-1]<span class="w"> </span>==<span class="w"> </span>af)

<span class="w">    </span>if<span class="w"> </span>box<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>lower,<span class="w"> </span>upper<span class="w"> </span>=<span class="w"> </span>box

<span class="w">        </span>constraints.append(pos_pts<span class="w"> </span>&gt;=<span class="w"> </span>np.tile(lower,<span class="w"> </span>(n_control_pts,<span class="w"> </span>1)))

<span class="w">        </span>constraints.append(pos_pts<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>np.tile(upper,<span class="w"> </span>(n_control_pts,<span class="w"> </span>1)))

<span class="w">    </span>if<span class="w"> </span>v_max<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(cp.norm2(vel_pts,<span class="w"> </span>axis=1)<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>v_max)

<span class="w">    </span>if<span class="w"> </span>a_max<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>None:

<span class="w">        </span>constraints.append(cp.norm2(accel_pts,<span class="w"> </span>axis=1)<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>a_max)

<span class="w">    </span>#<span class="w"> </span>Objective<span class="w"> </span>function<span class="w"> </span>criteria

<span class="w">    </span>jerk<span class="w"> </span>=<span class="w"> </span>jerk_curve.l2_squared

<span class="w">    </span>#<span class="w"> </span>Form<span class="w"> </span>the<span class="w"> </span>objective<span class="w"> </span>function<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>relative<span class="w"> </span>weighting<span class="w"> </span>between<span class="w"> </span>the<span class="w"> </span>criteria

<span class="w">    </span>objective<span class="w"> </span>=<span class="w"> </span>cp.Minimize(jerk<span class="w"> </span>+<span class="w"> </span>time_weight<span class="w"> </span>*<span class="w"> </span>(tf<span class="w"> </span>-<span class="w"> </span>t0))

<span class="w">    </span>#<span class="w"> </span>Form<span class="w"> </span>the<span class="w"> </span>problem<span class="w"> </span>and<span class="w"> </span>solve<span class="w"> </span>it

<span class="w">    </span>#<span class="w"> </span>Note:<span class="w"> </span>Clarabel<span class="w"> </span>is<span class="w"> </span>apparently<span class="w"> </span>better<span class="w"> </span>for<span class="w"> </span>quadratic<span class="w"> </span>objectives<span class="w"> </span>(like<span class="w"> </span>our<span class="w"> </span>jerk<span class="w"> </span>criteria)

<span class="w">    </span>prob<span class="w"> </span>=<span class="w"> </span>cp.Problem(objective,<span class="w"> </span>constraints)

<span class="w">    </span>try:

<span class="w">        </span>prob.solve(solver=cp.CLARABEL)

<span class="w">    </span>except<span class="w"> </span>cp.error.SolverError<span class="w"> </span>as<span class="w"> </span>e:

<span class="w">        </span>raise<span class="w"> </span>OptimizationError(&quot;Cannot<span class="w"> </span>generate<span class="w"> </span>the<span class="w"> </span>trajectory<span class="w"> </span>-<span class="w"> </span>Solver<span class="w"> </span>error!&quot;)<span class="w"> </span>from<span class="w"> </span>e

<span class="w">    </span>if<span class="w"> </span>prob.status<span class="w"> </span>!=<span class="w"> </span>cp.OPTIMAL:

<span class="w">        </span>raise<span class="w"> </span>OptimizationError(

<span class="w">            </span>f&quot;Unable<span class="w"> </span>to<span class="w"> </span>generate<span class="w"> </span>the<span class="w"> </span>trajectory<span class="w"> </span>(solver<span class="w"> </span>status:<span class="w"> </span>{prob.status}).\n&quot;

<span class="w">            </span>+<span class="w"> </span>&quot;Check<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>feasibility<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>constraints&quot;

<span class="w">        </span>)

<span class="w">    </span>#<span class="w"> </span>Construct<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>from<span class="w"> </span>the<span class="w"> </span>solved<span class="w"> </span>control<span class="w"> </span>points

<span class="w">    </span>return<span class="w"> </span>BezierCurve(pos_pts.value,<span class="w"> </span>t0,<span class="w"> </span>tf),<span class="w"> </span>prob.value

def<span class="w"> </span>_test_plot_bernstein_polys():

<span class="w">    </span>&quot;&quot;&quot;Example<span class="w"> </span>to<span class="w"> </span>visualize<span class="w"> </span>Bernstein<span class="w"> </span>polynomials<span class="w"> </span>of<span class="w"> </span>various<span class="w"> </span>degrees&quot;&quot;&quot;

<span class="w">    </span>a<span class="w"> </span>=<span class="w"> </span>0

<span class="w">    </span>b<span class="w"> </span>=<span class="w"> </span>10

<span class="w">    </span>n<span class="w"> </span>=<span class="w"> </span>50

<span class="w">    </span>t<span class="w"> </span>=<span class="w"> </span>np.linspace(a,<span class="w"> </span>b,<span class="w"> </span>n,<span class="w"> </span>endpoint=True)

<span class="w">    </span>M<span class="w"> </span>=<span class="w"> </span>4

<span class="w">    </span>fig<span class="w"> </span>=<span class="w"> </span>plt.figure()

<span class="w">    </span>for<span class="w"> </span>n<span class="w"> </span>in<span class="w"> </span>range(M<span class="w"> </span>+<span class="w"> </span>1):

<span class="w">        </span>evals<span class="w"> </span>=<span class="w"> </span>bernstein(M,<span class="w"> </span>n,<span class="w"> </span>a,<span class="w"> </span>b,<span class="w"> </span>t)

<span class="w">        </span>plt.plot(t,<span class="w"> </span>evals,<span class="w"> </span>label=str(n))

<span class="w">    </span>plt.legend()

<span class="w">    </span>plt.title(&quot;Bernstein<span class="w"> </span>Polynomials&quot;)

<span class="w">    </span>plt.show()

if<span class="w"> </span>__name__<span class="w"> </span>==<span class="w"> </span>&quot;__main__&quot;:

<span class="w">    </span>_test_plot_bernstein_polys()
</code></pre></div>

</details>
<h2 id="variables">Variables</h2>
<div class="codehilite"><pre><span></span><code><span class="n">binom</span>
</code></pre></div>

<h2 id="functions">Functions</h2>
<h3 id="bernstein">bernstein</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">bernstein</span><span class="p">(</span>
    <span class="n">h</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">Variable</span><span class="p">,</span> <span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">Expression</span><span class="p">],</span>
    <span class="n">t</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]]</span>
</code></pre></div>

<p>Evaluate the nth Bernstein polynomial of degree h at a point (points) t</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>h</td>
<td>int</td>
<td>Degree of the Bernstein basis</td>
<td>None</td>
</tr>
<tr>
<td>n</td>
<td>int</td>
<td>Index of the Bernstein polynomial</td>
<td>None</td>
</tr>
<tr>
<td>a</td>
<td>float</td>
<td>Interval minimum value (e.g. starting time of trajectory)</td>
<td>None</td>
</tr>
<tr>
<td>b</td>
<td>float</td>
<td>Interval maximum value (e.g. ending time of trajectory)</td>
<td>None</td>
</tr>
<tr>
<td>t</td>
<td>Union[float, npt.ArrayLike]</td>
<td>Evaluation point(s) (for instance, trajectory times)</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>npt.ArrayLike</td>
<td>Evaluation(s) of the Bernstein polynomial at point(s) t. Returns a float if t is a float,<br>otherwise will return an array of evaluations</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>def<span class="w"> </span>bernstein(

<span class="w">    </span>h:<span class="w"> </span>int,

<span class="w">    </span>n:<span class="w"> </span>int,

<span class="w">    </span>a:<span class="w"> </span>float,

<span class="w">    </span>b:<span class="w"> </span>Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression],

<span class="w">    </span>t:<span class="w"> </span>Union[float,<span class="w"> </span>npt.ArrayLike],

)<span class="w"> </span>-&gt;<span class="w"> </span>npt.ArrayLike:

<span class="w">    </span>&quot;&quot;&quot;Evaluate<span class="w"> </span>the<span class="w"> </span>nth<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>h<span class="w"> </span>at<span class="w"> </span>a<span class="w"> </span>point<span class="w"> </span>(points)<span class="w"> </span>t

<span class="w">    </span>Args:

<span class="w">        </span>h<span class="w"> </span>(int):<span class="w"> </span>Degree<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>basis

<span class="w">        </span>n<span class="w"> </span>(int):<span class="w"> </span>Index<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial

<span class="w">        </span>a<span class="w"> </span>(float):<span class="w"> </span>Interval<span class="w"> </span>minimum<span class="w"> </span>value<span class="w"> </span>(e.g.<span class="w"> </span>starting<span class="w"> </span>time<span class="w"> </span>of<span class="w"> </span>trajectory)

<span class="w">        </span>b<span class="w"> </span>(float):<span class="w"> </span>Interval<span class="w"> </span>maximum<span class="w"> </span>value<span class="w"> </span>(e.g.<span class="w"> </span>ending<span class="w"> </span>time<span class="w"> </span>of<span class="w"> </span>trajectory)

<span class="w">        </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>point(s)<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">    </span>Returns:

<span class="w">        </span>npt.ArrayLike:<span class="w"> </span>Evaluation(s)<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>at<span class="w"> </span>point(s)<span class="w"> </span>t.<span class="w"> </span>Returns<span class="w"> </span>a<span class="w"> </span>float<span class="w"> </span>if<span class="w"> </span>t<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>float,

<span class="w">            </span>otherwise<span class="w"> </span>will<span class="w"> </span>return<span class="w"> </span>an<span class="w"> </span>array<span class="w"> </span>of<span class="w"> </span>evaluations

<span class="w">    </span>&quot;&quot;&quot;

<span class="w">    </span>if<span class="w"> </span>n<span class="w"> </span>&gt;<span class="w"> </span>h:

<span class="w">        </span>raise<span class="w"> </span>ValueError(

<span class="w">            </span>&quot;Bernstein<span class="w"> </span>polynomial<span class="w"> </span>index<span class="w"> </span>cannot<span class="w"> </span>be<span class="w"> </span>larger<span class="w"> </span>than<span class="w"> </span>the<span class="w"> </span>degree<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>basis&quot;

<span class="w">        </span>)

<span class="w">    </span>if<span class="w"> </span>np.ndim(t)<span class="w"> </span>&gt;=<span class="w"> </span>0:

<span class="w">        </span>t<span class="w"> </span>=<span class="w"> </span>np.asarray(t)

<span class="w">    </span>if<span class="w"> </span>not<span class="w"> </span>isinstance(b,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">        </span>if<span class="w"> </span>b<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>a:

<span class="w">            </span>raise<span class="w"> </span>ValueError(f&quot;Invalid<span class="w"> </span>interval<span class="w"> </span>limits:<span class="w"> </span>({a},<span class="w"> </span>{b})&quot;)

<span class="w">        </span>if<span class="w"> </span>not<span class="w"> </span>(np.all(a<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>t)<span class="w"> </span>and<span class="w"> </span>np.all(t<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>b)):

<span class="w">            </span>raise<span class="w"> </span>ValueError(

<span class="w">                </span>&quot;Cannot<span class="w"> </span>evaluate<span class="w"> </span>at<span class="w"> </span>points<span class="w"> </span>outside<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>specified<span class="w"> </span>interval&quot;

<span class="w">            </span>)

<span class="w">    </span>return<span class="w"> </span>binom(h,<span class="w"> </span>n)<span class="w"> </span>*<span class="w"> </span>((t<span class="w"> </span>-<span class="w"> </span>a)<span class="w"> </span>/<span class="w"> </span>(b<span class="w"> </span>-<span class="w"> </span>a))<span class="w"> </span>**<span class="w"> </span>n<span class="w"> </span>*<span class="w"> </span>((b<span class="w"> </span>-<span class="w"> </span>t)<span class="w"> </span>/<span class="w"> </span>(b<span class="w"> </span>-<span class="w"> </span>a))<span class="w"> </span>**<span class="w"> </span>(h<span class="w"> </span>-<span class="w"> </span>n)
</code></pre></div>

</details>
<h3 id="bezier_trajectory">bezier_trajectory</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">bezier_trajectory</span><span class="p">(</span>
    <span class="n">p0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">pf</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]]],</span>
    <span class="n">t0</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">tf</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">n_control_pts</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">v0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">vf</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">a0</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">af</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]],</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_array_like</span><span class="o">.</span><span class="n">_SupportsArray</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]],</span> <span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">_typing</span><span class="o">.</span><span class="n">_nested_sequence</span><span class="o">.</span><span class="n">_NestedSequence</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">]],</span> <span class="n">NoneType</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">pyastrobee</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">boxes</span><span class="o">.</span><span class="n">Box</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">v_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">a_max</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">time_weight</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">pyastrobee</span><span class="o">.</span><span class="n">trajectories</span><span class="o">.</span><span class="n">bezier</span><span class="o">.</span><span class="n">BezierCurve</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span>
</code></pre></div>

<p>Evaluate an optimal min-jerk trajectory based on Bezier curves which meets the specified constraints</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>p0</td>
<td>npt.ArrayLike</td>
<td>Initial position, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>pf</td>
<td>npt.ArrayLike</td>
<td>Final position, shape (3,)</td>
<td>None</td>
</tr>
<tr>
<td>t0</td>
<td>float</td>
<td>Starting time</td>
<td>None</td>
</tr>
<tr>
<td>tf</td>
<td>float</td>
<td>Ending time</td>
<td>None</td>
</tr>
<tr>
<td>n_control_pts</td>
<td>int</td>
<td>Number of control points for the Bezier curve. Must be &gt;= to the number of constraints,<br>and should not be too large (&gt;15ish) as this can reduce optimization performance. 6-10 is usually good</td>
<td>None</td>
</tr>
<tr>
<td>v0</td>
<td>Optional[npt.ArrayLike]</td>
<td>Initial velocity, shape (3,). Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>vf</td>
<td>Optional[npt.ArrayLike]</td>
<td>Final velocity, shape (3,). Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>a0</td>
<td>Optional[npt.ArrayLike]</td>
<td>Initial acceleration, shape (3,). Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>af</td>
<td>Optional[npt.ArrayLike]</td>
<td>Final acceleration, shape (3,). Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>box</td>
<td>Optional[Box]</td>
<td>Box constraint on (lower, upper) position bounds. Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>v_max</td>
<td>Optional[float]</td>
<td>Maximum L2 norm of the velocity. Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>a_max</td>
<td>Optional[float]</td>
<td>Maximum L2 norm of the acceleration. Defaults to None (unconstrained)</td>
<td>None</td>
</tr>
<tr>
<td>time_weight</td>
<td>float</td>
<td>Objective function weight corresponding to a linear penalty on the duration.<br>Defaults to 0 (minimize jerk only). Note: this should be &gt; 0 if evaluating the free-final-time case</td>
<td>None</td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tuple[BezierCurve, float]</td>
<td>BezierCurve: The optimal curve for the position component of the trajectory. Note: derivatives<br>    can be evaluated using the curve.derivative property<br>float: The optimal cost of the objective function</td>
</tr>
</tbody>
</table>
<p><strong>Raises:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>OptimizationError</td>
<td>If the optimization failed to find a valid solution (typically this is due to constraints<br>which are too restrictive)</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">bezier_trajectory</span><span class="p">(</span>

<span class="w">    </span><span class="nl">p0</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="nl">pf</span><span class="p">:</span><span class="w"> </span><span class="n">npt</span><span class="p">.</span><span class="n">ArrayLike</span><span class="p">,</span>

<span class="w">    </span><span class="nl">t0</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="p">,</span>

<span class="w">    </span><span class="nl">tf</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="p">,</span>

<span class="w">    </span><span class="nl">n_control_pts</span><span class="p">:</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span>

<span class="w">    </span><span class="nl">v0</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">vf</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">a0</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">af</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">npt.ArrayLike</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">box</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">Box</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">v_max</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">a_max</span><span class="p">:</span><span class="w"> </span><span class="n">Optional</span><span class="o">[</span><span class="n">float</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">None</span><span class="p">,</span>

<span class="w">    </span><span class="nl">time_weight</span><span class="p">:</span><span class="w"> </span><span class="nc">float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>

<span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">tuple</span><span class="o">[</span><span class="n">BezierCurve, float</span><span class="o">]</span><span class="err">:</span>

<span class="w">    </span><span class="ss">&quot;&quot;&quot;Evaluate an optimal min-jerk trajectory based on Bezier curves which meets the specified constraints</span>

<span class="ss">    Args:</span>

<span class="ss">        p0 (npt.ArrayLike): Initial position, shape (3,)</span>

<span class="ss">        pf (npt.ArrayLike): Final position, shape (3,)</span>

<span class="ss">        t0 (float): Starting time</span>

<span class="ss">        tf (float): Ending time</span>

<span class="ss">        n_control_pts (int): Number of control points for the Bezier curve. Must be &gt;= to the number of constraints,</span>

<span class="ss">            and should not be too large (&gt;15ish) as this can reduce optimization performance. 6-10 is usually good</span>

<span class="ss">        v0 (Optional[npt.ArrayLike]): Initial velocity, shape (3,). Defaults to None (unconstrained)</span>

<span class="ss">        vf (Optional[npt.ArrayLike]): Final velocity, shape (3,). Defaults to None (unconstrained)</span>

<span class="ss">        a0 (Optional[npt.ArrayLike]): Initial acceleration, shape (3,). Defaults to None (unconstrained)</span>

<span class="ss">        af (Optional[npt.ArrayLike]): Final acceleration, shape (3,). Defaults to None (unconstrained)</span>

<span class="ss">        box (Optional[Box]): Box constraint on (lower, upper) position bounds. Defaults to None (unconstrained)</span>

<span class="ss">        v_max (Optional[float]): Maximum L2 norm of the velocity. Defaults to None (unconstrained)</span>

<span class="ss">        a_max (Optional[float]): Maximum L2 norm of the acceleration. Defaults to None (unconstrained)</span>

<span class="ss">        time_weight (float, optional): Objective function weight corresponding to a linear penalty on the duration.</span>

<span class="ss">            Defaults to 0 (minimize jerk only). Note: this should be &gt; 0 if evaluating the free-final-time case</span>

<span class="ss">    Raises:</span>

<span class="ss">        OptimizationError: If the optimization failed to find a valid solution (typically this is due to constraints</span>

<span class="ss">            which are too restrictive)</span>

<span class="ss">    Returns:</span>

<span class="ss">        tuple[BezierCurve, float]:</span>

<span class="ss">            BezierCurve: The optimal curve for the position component of the trajectory. Note: derivatives</span>

<span class="ss">                can be evaluated using the curve.derivative property</span>

<span class="ss">            float: The optimal cost of the objective function</span>

<span class="ss">    &quot;&quot;&quot;</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">Check</span><span class="w"> </span><span class="n">inputs</span>

<span class="w">    </span><span class="n">n_constraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="o">[</span><span class="n">p0, pf, v0, vf, a0, af</span><span class="o">]</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">n_constraints</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nl">n_control_pts</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>

<span class="w">            </span><span class="ss">&quot;Number of control points must be at least the number of constraints&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">tf</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nl">t0</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span><span class="n">f</span><span class="ss">&quot;Invalid time interval: ({t0}, {tf})&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">dim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">len</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="k">Variable</span><span class="w"> </span><span class="p">(</span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">position</span><span class="w"> </span><span class="n">curve</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Expressions</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">points</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="n">curves</span>

<span class="w">    </span><span class="n">pos_pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cp</span><span class="p">.</span><span class="k">Variable</span><span class="p">((</span><span class="n">n_control_pts</span><span class="p">,</span><span class="w"> </span><span class="n">dim</span><span class="p">))</span>

<span class="w">    </span><span class="n">pos_curve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BezierCurve</span><span class="p">(</span><span class="n">pos_pts</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">)</span>

<span class="w">    </span><span class="n">vel_curve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pos_curve</span><span class="p">.</span><span class="n">derivative</span>

<span class="w">    </span><span class="n">vel_pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vel_curve</span><span class="p">.</span><span class="n">points</span>

<span class="w">    </span><span class="n">accel_curve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vel_curve</span><span class="p">.</span><span class="n">derivative</span>

<span class="w">    </span><span class="n">accel_pts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accel_curve</span><span class="p">.</span><span class="n">points</span>

<span class="w">    </span><span class="n">jerk_curve</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accel_curve</span><span class="p">.</span><span class="n">derivative</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">constraint</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">depending</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">what</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">inputs</span>

<span class="w">    </span><span class="k">constraints</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">pos_pts[0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">p0</span><span class="p">,</span><span class="w"> </span><span class="n">pos_pts</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">pf</span><span class="err">]</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">v0</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">vel_pts</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">v0</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">vf</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">vel_pts</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">vf</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">a0</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">accel_pts</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">a0</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">af</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">accel_pts</span><span class="o">[</span><span class="n">-1</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">af</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="nf">lower</span><span class="p">,</span><span class="w"> </span><span class="nf">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">box</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos_pts</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="nf">lower</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">n_control_pts</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">pos_pts</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">tile</span><span class="p">(</span><span class="nf">upper</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">n_control_pts</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)))</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">v_max</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="p">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">vel_pts</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">v_max</span><span class="p">)</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">a_max</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">None</span><span class="err">:</span>

<span class="w">        </span><span class="k">constraints</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="p">.</span><span class="n">norm2</span><span class="p">(</span><span class="n">accel_pts</span><span class="p">,</span><span class="w"> </span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">a_max</span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Objective</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">criteria</span>

<span class="w">    </span><span class="n">jerk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">jerk_curve</span><span class="p">.</span><span class="n">l2_squared</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">objective</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="n">based</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="n">weighting</span><span class="w"> </span><span class="ow">between</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">criteria</span>

<span class="w">    </span><span class="n">objective</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cp</span><span class="p">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">jerk</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">time_weight</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">tf</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">t0</span><span class="p">))</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Form</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">problem</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">solve</span><span class="w"> </span><span class="n">it</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="nl">Note</span><span class="p">:</span><span class="w"> </span><span class="n">Clarabel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">apparently</span><span class="w"> </span><span class="n">better</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">quadratic</span><span class="w"> </span><span class="n">objectives</span><span class="w"> </span><span class="p">(</span><span class="ow">like</span><span class="w"> </span><span class="n">our</span><span class="w"> </span><span class="n">jerk</span><span class="w"> </span><span class="n">criteria</span><span class="p">)</span>

<span class="w">    </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cp</span><span class="p">.</span><span class="n">Problem</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span><span class="w"> </span><span class="k">constraints</span><span class="p">)</span>

<span class="w">    </span><span class="k">try</span><span class="err">:</span>

<span class="w">        </span><span class="n">prob</span><span class="p">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="n">cp</span><span class="p">.</span><span class="n">CLARABEL</span><span class="p">)</span>

<span class="w">    </span><span class="ow">except</span><span class="w"> </span><span class="n">cp</span><span class="p">.</span><span class="n">error</span><span class="p">.</span><span class="n">SolverError</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">e</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">OptimizationError</span><span class="p">(</span><span class="ss">&quot;Cannot generate the trajectory - Solver error!&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">e</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">prob</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">cp</span><span class="p">.</span><span class="nl">OPTIMAL</span><span class="p">:</span>

<span class="w">        </span><span class="n">raise</span><span class="w"> </span><span class="n">OptimizationError</span><span class="p">(</span>

<span class="w">            </span><span class="n">f</span><span class="ss">&quot;Unable to generate the trajectory (solver status: {prob.status}).\n&quot;</span>

<span class="w">            </span><span class="o">+</span><span class="w"> </span><span class="ss">&quot;Check on the feasibility of the constraints&quot;</span>

<span class="w">        </span><span class="p">)</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">Construct</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Bezier</span><span class="w"> </span><span class="n">curve</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">solved</span><span class="w"> </span><span class="n">control</span><span class="w"> </span><span class="n">points</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">BezierCurve</span><span class="p">(</span><span class="n">pos_pts</span><span class="p">.</span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="n">t0</span><span class="p">,</span><span class="w"> </span><span class="n">tf</span><span class="p">),</span><span class="w"> </span><span class="n">prob</span><span class="p">.</span><span class="k">value</span>
</code></pre></div>

</details>
<h2 id="classes">Classes</h2>
<h3 id="beziercurve">BezierCurve</h3>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BezierCurve</span><span class="p">(</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">Variable</span><span class="p">,</span> <span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">Expression</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span>
    <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">b</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">Variable</span><span class="p">,</span> <span class="n">cvxpy</span><span class="o">.</span><span class="n">expressions</span><span class="o">.</span><span class="n">expression</span><span class="o">.</span><span class="n">Expression</span><span class="p">]</span>
<span class="p">)</span>
</code></pre></div>

<p>Bezier curve class for evaluating a curve, the basis polynomials, and its derivative</p>
<p>To evaluate the curve at points t, call it with curve(t)</p>
<p>On initialization, for a standard "unit-time" curve, set a = 0 and b = 1</p>
<h4 id="attributes">Attributes</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>points</td>
<td>Union[cp.Variable, cp.Expression, np.ndarray]</td>
<td>Control points, or a cvxpy Variable/Expression of the<br>control points. Shape (n_pts, dimension)</td>
<td>None</td>
</tr>
<tr>
<td>a</td>
<td>float</td>
<td>Lower limit of the curve interval</td>
<td>None</td>
</tr>
<tr>
<td>b</td>
<td>Union[float, cp.Variable, cp.Expression]</td>
<td>Upper limit of the curve interval. Variable if we are also<br>optimizing the duration of the curve</td>
<td>None</td>
</tr>
</tbody>
</table>
<details class="example">
<summary>View Source</summary>
<div class="codehilite"><pre><span></span><code>class<span class="w"> </span>BezierCurve:

<span class="w">    </span>&quot;&quot;&quot;Bezier<span class="w"> </span>curve<span class="w"> </span>class<span class="w"> </span>for<span class="w"> </span>evaluating<span class="w"> </span>a<span class="w"> </span>curve,<span class="w"> </span>the<span class="w"> </span>basis<span class="w"> </span>polynomials,<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>derivative

<span class="w">    </span>To<span class="w"> </span>evaluate<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>at<span class="w"> </span>points<span class="w"> </span>t,<span class="w"> </span>call<span class="w"> </span>it<span class="w"> </span>with<span class="w"> </span>curve(t)

<span class="w">    </span>On<span class="w"> </span>initialization,<span class="w"> </span>for<span class="w"> </span>a<span class="w"> </span>standard<span class="w"> </span>&quot;unit-time&quot;<span class="w"> </span>curve,<span class="w"> </span>set<span class="w"> </span>a<span class="w"> </span>=<span class="w"> </span>0<span class="w"> </span>and<span class="w"> </span>b<span class="w"> </span>=<span class="w"> </span>1

<span class="w">    </span>Args:

<span class="w">        </span>points<span class="w"> </span>(Union[cp.Variable,<span class="w"> </span>cp.Expression,<span class="w"> </span>np.ndarray]):<span class="w"> </span>Control<span class="w"> </span>points,<span class="w"> </span>or<span class="w"> </span>a<span class="w"> </span>cvxpy<span class="w"> </span>Variable/Expression<span class="w"> </span>of<span class="w"> </span>the

<span class="w">            </span>control<span class="w"> </span>points.<span class="w"> </span>Shape<span class="w"> </span>(n_pts,<span class="w"> </span>dimension)

<span class="w">        </span>a<span class="w"> </span>(float):<span class="w"> </span>Lower<span class="w"> </span>limit<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>interval

<span class="w">        </span>b<span class="w"> </span>(Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]):<span class="w"> </span>Upper<span class="w"> </span>limit<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>interval.<span class="w"> </span>Variable<span class="w"> </span>if<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>also

<span class="w">            </span>optimizing<span class="w"> </span>the<span class="w"> </span>duration<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve

<span class="w">    </span>&quot;&quot;&quot;

<span class="w">    </span>def<span class="w"> </span>__init__(

<span class="w">        </span>self,

<span class="w">        </span>points:<span class="w"> </span>Union[cp.Variable,<span class="w"> </span>cp.Expression,<span class="w"> </span>np.ndarray],

<span class="w">        </span>a:<span class="w"> </span>float,

<span class="w">        </span>b:<span class="w"> </span>Union[float,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression],

<span class="w">    </span>):

<span class="w">        </span>if<span class="w"> </span>not<span class="w"> </span>isinstance(b,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression))<span class="w"> </span>and<span class="w"> </span>b<span class="w"> </span><span class="nt">&lt; a:</span>

<span class="w">            </span><span class="err">raise</span><span class="w"> </span><span class="err">ValueError(f&quot;Invalid</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limits:</span><span class="w"> </span><span class="err">({a},</span><span class="w"> </span><span class="err">{b})&quot;)</span>

<span class="w">        </span><span class="na">self.points =</span><span class="w"> </span><span class="s">points</span>

<span class="w">        </span><span class="na">self.h =</span><span class="w"> </span><span class="s">points.shape[0]</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">1</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Degree</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">curve</span><span class="w"> </span><span class="err">(AKA</span><span class="w"> </span><span class="err">M</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Tobia&#39;s</span><span class="w"> </span><span class="err">paper)</span>

<span class="w">        </span><span class="na">self.d =</span><span class="w"> </span><span class="s">points.shape[1]</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Dimension</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">the</span><span class="w"> </span><span class="err">space</span>

<span class="w">        </span><span class="na">self.a =</span><span class="w"> </span><span class="s">a</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Lower</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limit</span>

<span class="w">        </span><span class="na">self.b =</span><span class="w"> </span><span class="s">b</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Upper</span><span class="w"> </span><span class="err">interval</span><span class="w"> </span><span class="err">limit</span>

<span class="w">        </span><span class="na">self.duration =</span><span class="w"> </span><span class="s">b</span><span class="w"> </span><span class="err">-</span><span class="w"> </span><span class="err">a</span>

<span class="w">    </span><span class="err">def</span><span class="w"> </span><span class="err">__call__(self,</span><span class="w"> </span><span class="err">t:</span><span class="w"> </span><span class="err">Union[float,</span><span class="w"> </span><span class="err">npt.ArrayLike])</span><span class="w"> </span><span class="err">-</span><span class="nt">&gt;</span><span class="w"> </span>np.ndarray:

<span class="w">        </span>&quot;&quot;&quot;Evaluates<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>(a<span class="w"> </span>sum<span class="w"> </span>of<span class="w"> </span>Bernstein<span class="w"> </span>polynomials)<span class="w"> </span>at<span class="w"> </span>specified<span class="w"> </span>points

<span class="w">        </span>Args:

<span class="w">            </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>points<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">        </span>Returns:

<span class="w">            </span>np.ndarray:<span class="w"> </span>Points<span class="w"> </span>along<span class="w"> </span>the<span class="w"> </span>curve,<span class="w"> </span>shape<span class="w"> </span>(n_pts,<span class="w"> </span>dimension)

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>c<span class="w"> </span>=<span class="w"> </span>np.array([self._bernstein(t,<span class="w"> </span>n)<span class="w"> </span>for<span class="w"> </span>n<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1)])

<span class="w">        </span>return<span class="w"> </span>c.T<span class="w"> </span>@<span class="w"> </span>self.points

<span class="w">    </span>def<span class="w"> </span>_bernstein(self,<span class="w"> </span>t:<span class="w"> </span>Union[float,<span class="w"> </span>npt.ArrayLike],<span class="w"> </span>n:<span class="w"> </span>int)<span class="w"> </span>-&gt;<span class="w"> </span>npt.ArrayLike:

<span class="w">        </span>&quot;&quot;&quot;Wrapper<span class="w"> </span>around<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial<span class="w"> </span>function,<span class="w"> </span>using<span class="w"> </span>attributes<span class="w"> </span>of<span class="w"> </span>self@BezierCurve

<span class="w">        </span>Args:

<span class="w">            </span>t<span class="w"> </span>(Union[float,<span class="w"> </span>npt.ArrayLike]):<span class="w"> </span>Evaluation<span class="w"> </span>point(s)<span class="w"> </span>(for<span class="w"> </span>instance,<span class="w"> </span>trajectory<span class="w"> </span>times)

<span class="w">            </span>n<span class="w"> </span>(int):<span class="w"> </span>Index<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bernstein<span class="w"> </span>polynomial

<span class="w">        </span>Returns:

<span class="w">            </span>npt.ArrayLike:<span class="w"> </span>Evaluation(s)<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>bernstein<span class="w"> </span>polynomial<span class="w"> </span>at<span class="w"> </span>point(s)<span class="w"> </span>t.<span class="w"> </span>Returns<span class="w"> </span>a<span class="w"> </span>float<span class="w"> </span>if<span class="w"> </span>t<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>float,

<span class="w">                </span>otherwise<span class="w"> </span>will<span class="w"> </span>return<span class="w"> </span>an<span class="w"> </span>array<span class="w"> </span>of<span class="w"> </span>evaluations

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>bernstein(self.h,<span class="w"> </span>n,<span class="w"> </span>self.a,<span class="w"> </span>self.b,<span class="w"> </span>t)

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>start_point(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[np.ndarray,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Starting<span class="w"> </span>control<span class="w"> </span>point<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>self.points[0]

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>end_point(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[np.ndarray,<span class="w"> </span>cp.Variable,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Ending<span class="w"> </span>control<span class="w"> </span>point<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>return<span class="w"> </span>self.points[-1]

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>derivative(self)<span class="w"> </span>-&gt;<span class="w"> </span>&quot;BezierCurve&quot;:

<span class="w">        </span>&quot;&quot;&quot;Derivative<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>(A<span class="w"> </span>Bezier<span class="w"> </span>curve<span class="w"> </span>of<span class="w"> </span>degree<span class="w"> </span>h-1)&quot;&quot;&quot;

<span class="w">        </span>if<span class="w"> </span>isinstance(self.duration,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>points<span class="w"> </span>=<span class="w"> </span>(

<span class="w">                </span>(self.points[1:]<span class="w"> </span>-<span class="w"> </span>self.points[:-1])

<span class="w">                </span>*<span class="w"> </span>self.h

<span class="w">                </span>*<span class="w"> </span>cp.inv_pos(self.duration)

<span class="w">            </span>)

<span class="w">        </span>else:

<span class="w">            </span>points<span class="w"> </span>=<span class="w"> </span>(self.points[1:]<span class="w"> </span>-<span class="w"> </span>self.points[:-1])<span class="w"> </span>*<span class="w"> </span>(self.h<span class="w"> </span>/<span class="w"> </span>self.duration)

<span class="w">        </span>return<span class="w"> </span>BezierCurve(points,<span class="w"> </span>self.a,<span class="w"> </span>self.b)

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>l2_squared(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[float,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Squared<span class="w"> </span>L2<span class="w"> </span>norm<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve&quot;&quot;&quot;

<span class="w">        </span>A<span class="w"> </span>=<span class="w"> </span>np.zeros((self.h<span class="w"> </span>+<span class="w"> </span>1,<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1))

<span class="w">        </span>for<span class="w"> </span>m<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1):

<span class="w">            </span>for<span class="w"> </span>n<span class="w"> </span>in<span class="w"> </span>range(self.h<span class="w"> </span>+<span class="w"> </span>1):

<span class="w">                </span>A[m,<span class="w"> </span>n]<span class="w"> </span>=<span class="w"> </span>binom(self.h,<span class="w"> </span>m)<span class="w"> </span>*<span class="w"> </span>binom(self.h,<span class="w"> </span>n)<span class="w"> </span>/<span class="w"> </span>binom(2<span class="w"> </span>*<span class="w"> </span>self.h,<span class="w"> </span>m<span class="w"> </span>+<span class="w"> </span>n)

<span class="w">        </span>if<span class="w"> </span>isinstance(self.duration,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>cp.multiply(A,<span class="w"> </span>self.duration<span class="w"> </span>/<span class="w"> </span>(2<span class="w"> </span>*<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1))

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>cp.kron(A,<span class="w"> </span>np.eye(self.d))

<span class="w">        </span>else:

<span class="w">            </span>A<span class="w"> </span>*=<span class="w"> </span>self.duration<span class="w"> </span>/<span class="w"> </span>(2<span class="w"> </span>*<span class="w"> </span>self.h<span class="w"> </span>+<span class="w"> </span>1)

<span class="w">            </span>A<span class="w"> </span>=<span class="w"> </span>np.kron(A,<span class="w"> </span>np.eye(self.d))

<span class="w">        </span>if<span class="w"> </span>isinstance(self.points,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>#<span class="w"> </span>Note:<span class="w"> </span>CVXPY<span class="w"> </span>flattens<span class="w"> </span>matrices<span class="w"> </span>by<span class="w"> </span>columns<span class="w"> </span>rather<span class="w"> </span>than<span class="w"> </span>rows<span class="w"> </span>(opposite<span class="w"> </span>of<span class="w"> </span>numpy)

<span class="w">            </span>#<span class="w"> </span>So,<span class="w"> </span>flatten<span class="w"> </span>based<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>transpose<span class="w"> </span>to<span class="w"> </span>make<span class="w"> </span>the<span class="w"> </span>math<span class="w"> </span>consistent

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.T.flatten()

<span class="w">            </span>return<span class="w"> </span>cp.quad_form(p,<span class="w"> </span>cp.psd_wrap(A))

<span class="w">        </span>elif<span class="w"> </span>isinstance(A,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.flatten()

<span class="w">            </span>return<span class="w"> </span>cp.quad_form(p,<span class="w"> </span>cp.psd_wrap(A))

<span class="w">        </span>else:<span class="w">  </span>#<span class="w"> </span>Numpy

<span class="w">            </span>p<span class="w"> </span>=<span class="w"> </span>self.points.flatten()

<span class="w">            </span>return<span class="w"> </span>p.dot(A.dot(p))

<span class="w">    </span>@property

<span class="w">    </span>def<span class="w"> </span>control_points_pathlength(self)<span class="w"> </span>-&gt;<span class="w"> </span>Union[float,<span class="w"> </span>cp.Expression]:

<span class="w">        </span>&quot;&quot;&quot;Sum<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>distances<span class="w"> </span>between<span class="w"> </span>consecutive<span class="w"> </span>control<span class="w"> </span>points

<span class="w">        </span>This<span class="w"> </span>is<span class="w"> </span>an<span class="w"> </span>upper<span class="w"> </span>bound<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>length<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>curve<span class="w"> </span>itself,<span class="w"> </span>so<span class="w"> </span>we<span class="w"> </span>can<span class="w"> </span>use<span class="w"> </span>this<span class="w"> </span>in<span class="w"> </span>a<span class="w"> </span>cost<span class="w"> </span>function

<span class="w">        </span>if<span class="w"> </span>we<span class="w"> </span>are<span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>minimize<span class="w"> </span>the<span class="w"> </span>pathlength<span class="w"> </span>of<span class="w"> </span>a<span class="w"> </span>trajectory

<span class="w">        </span>Returns:

<span class="w">            </span>Union[float,<span class="w"> </span>cp.Expression]:<span class="w"> </span>Float<span class="w"> </span>if<span class="w"> </span>the<span class="w"> </span>points<span class="w"> </span>are<span class="w"> </span>a<span class="w"> </span>numpy<span class="w"> </span>array,<span class="w"> </span>otherwise<span class="w"> </span>yields

<span class="w">                </span>a<span class="w"> </span>(convex,<span class="w"> </span>nonnegative)<span class="w"> </span>expression<span class="w"> </span>for<span class="w"> </span>this<span class="w"> </span>length

<span class="w">        </span>&quot;&quot;&quot;

<span class="w">        </span>if<span class="w"> </span>isinstance(self.points,<span class="w"> </span>(cp.Variable,<span class="w"> </span>cp.Expression)):

<span class="w">            </span>length<span class="w"> </span>=<span class="w"> </span>0

<span class="w">            </span>for<span class="w"> </span>i<span class="w"> </span>in<span class="w"> </span>range(self.h):

<span class="w">                </span>length<span class="w"> </span>+=<span class="w"> </span>cp.norm2(self.points[i<span class="w"> </span>+<span class="w"> </span>1]<span class="w"> </span>-<span class="w"> </span>self.points[i])

<span class="w">            </span>return<span class="w"> </span>length

<span class="w">        </span>else:

<span class="w">            </span>return<span class="w"> </span>np.sum(np.linalg.norm(np.gradient(self.points,<span class="w"> </span>axis=0),<span class="w"> </span>axis=1))
</code></pre></div>

</details>
<hr />
<h4 id="instance-variables">Instance variables</h4>
<div class="codehilite"><pre><span></span><code><span class="n">control_points_pathlength</span>
</code></pre></div>

<p>Sum of the distances between consecutive control points</p>
<p>This is an upper bound on the length of the curve itself, so we can use this in a cost function
if we are trying to minimize the pathlength of a trajectory</p>
<div class="codehilite"><pre><span></span><code><span class="n">derivative</span>
</code></pre></div>

<p>Derivative of the Bezier curve (A Bezier curve of degree h-1)</p>
<div class="codehilite"><pre><span></span><code><span class="n">end_point</span>
</code></pre></div>

<p>Ending control point of the Bezier curve</p>
<div class="codehilite"><pre><span></span><code><span class="n">l2_squared</span>
</code></pre></div>

<p>Squared L2 norm of the curve</p>
<div class="codehilite"><pre><span></span><code><span class="n">start_point</span>
</code></pre></div>

<p>Starting control point of the Bezier curve</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        
<footer class="md-footer">
    
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../arm_planner/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Arm Planner" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Previous
                </span>
                Arm Planner
              </div>
            </div>
          </a>
        
        
          
          <a href="../bezier_slerp/" class="md-footer__link md-footer__link--next" aria-label="Next: Bezier Slerp" rel="next">
            <div class="md-footer__title">
              <div class="md-ellipsis">
                <span class="md-footer__direction">
                  Next
                </span>
                Bezier Slerp
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
            
            Powered by
            <a href="http://timothycrosley.github.io/portray">portray.</a>
            You too can
            <a href="http://timothycrosley.github.io/portray">
              portray</a>
            your Python project well using automatic documentation.
          </div>
        
      </div>
    </div>
  </footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": [], "search": "../../../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>